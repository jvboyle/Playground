<?xml version="1.0" encoding="UTF-8"?>
<cdf:Benchmark xmlns:scm="?" xmlns:cdf="http://checklists.nist.gov/xccdf/1.0" id="UNIX-Linux-ITSSCSD-5.0">
<cdf:status date="Mon Apr 29 12:48:26 GMT 2019"/>
<cdf:descriptionMatrixInfo></cdf:descriptionMatrixInfo>
<cdf:title>UNIX-Linux-ITSSCSD-5.0C</cdf:title>
<cdf:techSpec type="ITSSCSD" version="5.0C"/>
<cdf:platform osId="Linux" family="UNIX">
<cdf:supportedplatform id="Red Hat Enterprise Linux/Server" versionId="7"/>
<cdf:supportedplatform id="Red Hat Enterprise Linux/Server" versionId="6"/>
<cdf:supportedplatform id="SuSE SLES" versionId="12"/>
<cdf:supportedplatform id="SuSE SLES" versionId="11"/>
<cdf:supportedplatform id="CentOS"/>
<cdf:supportedplatform id="zLinux"/>
<cdf:supportedplatform id="Ubuntu 14.04 LTS - same controls as for debian 7 (debian not supported)"/>
<cdf:supportedplatform id="Ubuntu 16.04 LTS - same controls as for debian 7 (debian not supported)"/>
</cdf:platform>
<cdf:remediation script="Linux_Remediation_itsscsd.sh"></cdf:remediation>
<cdf:description>GCM Single Instance Tech Spec v5.0C Linux Policy</cdf:description>
<cdf:version></cdf:version>
<cdf:Profile>
<cdf:Value id="$(Password MAX Age shadow Customer Accounts)" scm:type="integer">
<cdf:description>Password MAX AGE setting.  Required for only customer accounts when UIDLabelling parameter is set to 1.  Applied to all accounts when UIDLabelling parameter is set to 0.</cdf:description>
<cdf:default>90</cdf:default>
</cdf:Value>
<cdf:Value id="$(General Users)" scm:type="string_list">
<cdf:description>Default groups for general users.</cdf:description>
<cdf:default>'users'</cdf:default>
</cdf:Value>
<cdf:Value id="$(Prohibited RPC Process Names)" scm:type="string_list">
<cdf:description>Enter list of prohibited RPC process names.</cdf:description>
<cdf:default>'rusersd','cmsd','sprayd','pcnfsd','rexd','rwalld','tftpd','rsystat','rstatd','dtspcd','rwho','ttdbserver','rpc.ttdbserver'</cdf:default>
</cdf:Value>
<cdf:Value id="$(Prohibited UDP Ports)" scm:type="string_list">
<cdf:description>Enter list of prohibited UDP ports numbers.</cdf:description>
<cdf:default>'513','67','19','13','9','7','11','69'</cdf:default>
</cdf:Value>
<cdf:Value id="$(Account Labelling Excluded Accounts)" scm:type="string_list">
<cdf:description>Customer accounts excluded from Account Labelling requirement.  These accounts will be considered Customer Accounts when Account Labelling is required.</cdf:description>
<cdf:default>':none:'</cdf:default>
</cdf:Value>
<cdf:Value id="$(OSR Excluded Users)" scm:type="string_list">
<cdf:description>OSR excluded users</cdf:description>
<cdf:default>':none:'</cdf:default>
</cdf:Value>
<cdf:Value id="$(OSR Excluded Groups)" scm:type="string_list">
<cdf:description>OSR excluded groups</cdf:description>
<cdf:default>':none:'</cdf:default>
</cdf:Value>
<cdf:Value id="$(UIDLabelling)" scm:type="integer">
<cdf:description>1 = UserID Labelling is required for this policy, 0 = UserID Labelling is not required for this policy.
UID Labelling Standard Reference:
http://w3.tap.ibm.com/w3ki03/display/IAMSL/Labelling</cdf:description>
<cdf:default>0</cdf:default>
</cdf:Value>
<cdf:Value id="$(Prohibited Process Names)" scm:type="string_list">
<cdf:description>Enter list of prohibited process names.</cdf:description>
<cdf:default>'who','systat','bootps','chargen','daytime','netstat','ttdbserver','cmsd','dtspcd','rexd','npop','pcnfsd','rstatd','ruserd','rwalld','sprayd','tftpd','rwho','ftp','ftpd','telnet','telnetd','discard','echo','finger'</cdf:default>
</cdf:Value>
<cdf:Value id="$(Password MIN Age logindefs)" scm:type="integer">
<cdf:description>Enter required login.defs file Password Minimum Age setting in number days. </cdf:description>
<cdf:default>1</cdf:default>
</cdf:Value>
<cdf:Value id="$(Password MAX Age logindefs)" scm:type="integer">
<cdf:description>Enter required Password Maximum Age setting in number days.</cdf:description>
<cdf:default>90</cdf:default>
</cdf:Value>
<cdf:Value id="$(TFTP Startup Options)" scm:type="string">
<cdf:description>Enter the required TFTP daemon startup options. Seperate multiple options with % character. Use % character to specify a wildcard for multiple characters. Use _ character to specify a wildcard for single character. ( Example: -s%-u )</cdf:description>
<cdf:default>-s</cdf:default>
</cdf:Value>
<cdf:Value id="$(Password MIN Length)" scm:type="integer">
<cdf:description>Enter required Password Minimum Length setting.</cdf:description>
<cdf:default>15</cdf:default>
</cdf:Value>
<cdf:Value id="$(Login Shell)" scm:type="string">
<cdf:description>null</cdf:description>
<cdf:default>null</cdf:default>
</cdf:Value>
<cdf:Value id="$(UserIDs Excluded Password)" scm:type="string_list">
<cdf:description>Enter List of non-password UserIDs</cdf:description>
<cdf:default>'rpc','avahi-autoipd','vcsa','rtkit','saslauth','postfix','bin','adm','lp','sync','shutdown','halt','mail','uucp','operator','games','gopher','ftp','nobody','dbus','usbmuxd','daemon','avahi','ntp','apache','radvd','rpcuser','nfsnobody','qemu','haldaemon','nm-openconnect','pulse','gsanslcd','gdm','sshd','tcpdump'</cdf:default>
</cdf:Value>
<cdf:Value id="$(FTP Daemon Options)" scm:type="string">
<cdf:description>Enter required FTP daemon options. Seperate multiple options with % character. Use % character to specify a wildcard for multiple characters. Use _ character to specify a wildcard for single character. ( Example: -u 027%-s )</cdf:description>
<cdf:default>-u 027</cdf:default>
</cdf:Value>
<cdf:Value id="$(Prohibited TCP Ports)" scm:type="string_list">
<cdf:description>Enter list of prohibited TCP ports numbers.</cdf:description>
<cdf:default>'21','11','23','67','79','69','19','13','9','7','15'</cdf:default>
</cdf:Value>
<cdf:Value id="$(Alternate PAM Service File)" scm:type="string">
<cdf:description>Enter alternate PAM service file; such as common-password</cdf:description>
<cdf:default>system-auth</cdf:default>
</cdf:Value>
<cdf:Value id="$(Default Umask)" scm:type="integer">
<cdf:description>Enter required UMASK setting, only include integers required.</cdf:description>
<cdf:default>077</cdf:default>
</cdf:Value>
<cdf:Value id="$(Prohibited INETD Process Names)" scm:type="string_list">
<cdf:description>Enter list of prohibited process names in /etc/inetd.conf file.</cdf:description>
<cdf:default>'netstat','talk','time','discard','echo','finger','sysstat','who','npop','rexd','mountd','bootps','chargen','daytime'</cdf:default>
</cdf:Value>
<cdf:Value id="$(Password MIN Age shadow Customer Accounts)" scm:type="integer">
<cdf:description>Enter required shadow file Password Minimum Age setting in number days. Required for only customer accounts when UIDLabelling parameter is set to 1.  Applied to all accounts when UIDLabelling parameter is set to 0.</cdf:description>
<cdf:default>1</cdf:default>
</cdf:Value>
<cdf:Value id="$(Account Login Retries)" scm:type="integer">
<cdf:description>Enter required Login Retries setting</cdf:description>
<cdf:default>5</cdf:default>
</cdf:Value>
<cdf:Value id="$(Password History)" scm:type="integer">
<cdf:description>Enter required number of Passwords remembered</cdf:description>
<cdf:default>8</cdf:default>
</cdf:Value>
<cdf:Value id="$(Password MAX Age shadow IBM Accounts)" scm:type="integer">
<cdf:description>Password MAX AGE setting required for IBM accounts when UIDLabelling parameter is set to 1.</cdf:description>
<cdf:default>90</cdf:default>
</cdf:Value>
<cdf:Value id="$(Business Use Notice Text)" scm:type="string">
<cdf:description>Enter required Business Use Notice text in lower case.  Replace all spaces and special characters with % character.</cdf:description>
<cdf:default>%this%system%should%be%used%for%conducting%ibm%business%or%for%purposes%authorized%by%ibm%management%it%is%mandatory%to%comply%with%all%the%requirements%listed%in%the%applicable%security%policy%and%only%process%or%store%the%data%classes%approved%for%this%asset%type%use%is%subject%to%audit%at%any%time%by%ibm%management%</cdf:default>
</cdf:Value>
<cdf:Value id="$(Password MIN Age shadow IBM Accounts)" scm:type="integer">
<cdf:description>Enter required shadow file Password Minimum Age setting in number days. Required for IBM accounts when UIDLabelling parameter is set to 1.</cdf:description>
<cdf:default>1</cdf:default>
</cdf:Value>
<cdf:Value id="$(Password History 2)" scm:type="integer">
<cdf:description>Enter required password remember setting minus 1.  When setting password remember setting in pam_unix.so, pam_unix2.so, or pam_unix_passwd.so; the current password is added to the remember= value; causing the real setting to be 1 greater than remember= setting.</cdf:description>
<cdf:default>7</cdf:default>
</cdf:Value>
<cdf:Value id="$(Prohibited XINETD Process Names)" scm:type="string_list">
<cdf:description>Enter list of prohibited process names in /etc/inetd.conf file.</cdf:description>
<cdf:default>'finger','systat','who','rexd','bootps','chargen','daytime','discard','echo','npop','netstat','ttdbserver','dtspcd','cmsd','pcnfsd','rstatd','ruserd','rwalld','sprayd','tftpd','rwho','ftp','ftpd','telnet','telnetd'</cdf:default>
</cdf:Value>
<cdf:Value id="$(Policy Version)" scm:type="string">
<cdf:description>Enter the standard version.</cdf:description>
<cdf:default>v5.0C</cdf:default>
</cdf:Value>
<cdf:Value id="$(Date of Policy Modification)" scm:type="string">
<cdf:description>Enter policy release date.</cdf:description>
<cdf:default>20192703</cdf:default>
</cdf:Value>
<cdf:Value id="$(Chrony user)" scm:type="string">
<cdf:description>Enter chronyd process id</cdf:description>
<cdf:default>chrony</cdf:default>
</cdf:Value>
<cdf:Value id="$(SELinux allowed modes)" scm:type="string_list">
<cdf:description>Enter list of SELinux allowed modes</cdf:description>
<cdf:default>'enforcing','permissive'</cdf:default>
</cdf:Value>
<cdf:Value id="$(AppArmor allowed profiles modes)" scm:type="string_list">
<cdf:description>Enter list of AppArmor allowed profile modes</cdf:description>
<cdf:default>'enforcing','complain'</cdf:default>
</cdf:Value>
</cdf:Profile>
<cdf:Group>
<cdf:Rule id="1">
<cdf:TechSpecsEntriesRef id="15"/>
<cdf:requires idref="UsersV3">
</cdf:requires>
<cdf:requires idref="ShadowV2">
</cdf:requires>
<cdf:title>Password Requirements/Access via Password must be blocked</cdf:title>
<cdf:ruleName>Access_via_Password_must_be_blocked</cdf:ruleName>
<cdf:description>System ID's:
bin, daemon, adm, lp, sync, shutdown, halt, mail, uucp, operator, games, gopher, ftp, nobody, dbus, usbmuxd, rpc, avahi-autoipd, vcsa, rtkit, saslauth, postfix, avahi, ntp, apache, radvd, rpcuser, nfsnobody, qemu, haldaemon, nm-openconnect, pulse, gsanslcd, gdm, sshd, tcpdump password must not be assigned.</cdf:description>
<scm:violationMessage>Password must not be assigned to UserIDs {1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT distinct a.cli_id, a.username
FROM	jac_data.unix_users_v3 a
inner join	jac_data.unix_shadow_v2 b on a.cli_id = b.cli_id and a.username = b.username
WHERE	a.username in ($(UserIDs Excluded Password))
and ((a.is_passwd_empty=0
or (a.is_passwd_empty != 1 and a.is_md5 =0 and a.is_blowfish=0 and a.is_des=0 and a.is_sunmd5=0))
or (b.is_passwd_empty=0
or (b.is_passwd_empty != 1 and b.is_md5 =0 and b.is_blowfish=0 and b.is_des=0 and b.is_sunmd5=0)))
</scm:sql>
</cdf:check>
<cdf:remediation parameters="$(UserIDs Excluded Password)" disable="false">
<cdf:description>
Remediation blocks passwords for given list of users.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="2">
<cdf:TechSpecsEntriesRef id="18"/>
<cdf:requires idref="GroupsV2">
</cdf:requires>
<cdf:title>Password Requirements/Duplicate GIDs Forbidden</cdf:title>
<cdf:ruleName>Duplicate_GIDs_Forbidden</cdf:ruleName>
<cdf:description>Each GID must only be used once</cdf:description>
<scm:violationMessage>Duplicate GID for Group: {1}, GID: {2}. Each GID must only be used once.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a.group_name, a.gid
FROM
JAC_DATA.UNIX_groups_V2 a
WHERE
exists (
SELECT z.cli_id, z.gid
FROM JAC_DATA.UNIX_groups_V2 z
WHERE
a.cli_id = z.cli_id
and a.gid = z.gid
group by z.cli_id, z.gid having count(distinct  z.group_name) &gt; 1	)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>Each GID must only be used once in /etc/group file. If GID is not unique then assign next available sequential GID.</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="3">
<cdf:TechSpecsEntriesRef id="17"/>
<cdf:requires idref="UsersV3">
</cdf:requires>
<cdf:title>Password Requirements/Duplicate UIDs Forbidden</cdf:title>
<cdf:ruleName>Duplicate_UIDs_Forbidden</cdf:ruleName>
<cdf:description>Each UID must only be used once</cdf:description>
<scm:violationMessage>Duplicate UID for Account: {1}, UID: {2}. Each UID must only be used once.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a.username, a.uid
FROM
JAC_DATA.UNIX_USERS_V3 A
WHERE
exists (
SELECT
z.cli_id, z.uid
FROM
jac_data.unix_users_v3 z
WHERE
a.cli_id = z.cli_id
and  a.uid =  z.uid
and z.username not like '+@%'
group by z.cli_id, z.uid having count(distinct z.username) &gt; 1)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>Each UID must only be used once in /etc/group file. If UID is not unique then assign next available sequential UID.</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="5">
<cdf:TechSpecsEntriesRef id="11"/>
<cdf:requires idref="PlatformInfoV2">
</cdf:requires>
<cdf:requires idref="PamV1">
</cdf:requires>
<cdf:requires idref="FileSearchv1"></cdf:requires>
<cdf:title>Password Requirements/Login Retries REDHAT 5+</cdf:title>
<cdf:ruleName>Login_Retries_REDHAT_5_plus</cdf:ruleName>
<cdf:description>If /etc/pam.d/system-auth exist, it must include this setting:
Red Hat 5:
auth required pam_tally.so deny=5
account required pam_tally.so
Red Hat 6 or above:
auth required pam_tally2.so deny=5
account required pam_tally2.so
Note: On Red Hat v6 and later if the system-auth file is in use, this control must additionally be applied to the /etc/pam.d/password-auth file</cdf:description>
<scm:violationMessage>Incorrect Threshold for consecutive failed login attempts on {1}. {2} For more informations see coverage matrix document.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>SELECT
distinct e.cli_id, p.version, 'If /etc/pam.d/system-auth exist, need to set threshold using pam_tally.so pam module on Red Hat 5 or pam_tally2.so on Red Hat 6 or above.'
FROM
jac_data.unix_pam_v1 e
inner join jac_data.sec_platform_infov2 p on e.cli_id = p.cli_id and (lower(p.version) like '%red%hat%' or lower(p.version) like '%centos%')
WHERE
lower(e.service) = '/etc/pam.d/system-auth'
and (
e.cli_id not in(
select u.cli_id
from jac_data.unix_pam_v1 u
inner join jac_data.sec_platform_infov2 pp on pp.cli_id = u.cli_id
where
u.cli_id = e.cli_id
and u.service = e.service
and u.is_auth = 1
and u.is_required = 1
and lower(u.module_arguments) like '%deny=$(Account Login Retries)%'
and (
-- Red Hat 5:
-- auth required pam_tally.so deny=5
((lower(pp.version) like '%red%hat% 5%' or lower(pp.version) like '%centos% 5%')
and lower(u.module_path) like '%pam_tally.so%')
-- Red Hat 6 or above:
-- auth required pam_tally2.so deny=5
or
((lower(pp.version) like '%red%hat% 6%' or lower(pp.version) like '%centos% 6%'
or lower(pp.version) like '%red%hat% 7%' or lower(pp.version) like '%centos% 7%')
and lower(u.module_path) like '%pam_tally2.so%')
)
-- Must precede any lines of same module-type with a control-flag of sufficient with the exception of pam_deny.so
and u.cli_id not in(
select r.cli_id
from jac_data.unix_pam_v1 r
where
r.cli_id = u.cli_id
and r.service = u.service
and r.is_auth = 1
and r.is_sufficient = 1
and lower(r.module_path) not like '%pam_deny.so'
and u.row_number &gt; r.row_number)
)
or
e.cli_id not in(
select u.cli_id
from jac_data.unix_pam_v1 u
inner join jac_data.sec_platform_infov2 pp on pp.cli_id = u.cli_id
where
u.cli_id = e.cli_id
and u.is_account = 1
and u.is_required = 1
and (
-- Red Hat 5:
-- account required pam_tally.so
((lower(pp.version) like '%red%hat% 5%' or lower(pp.version) like '%centos% 5%')
and lower(u.module_path) like '%pam_tally.so%')
-- Red Hat 6 or above:
-- account required pam_tally2.so
or
((lower(pp.version) like '%red%hat% 6%' or lower(pp.version) like '%centos% 6%'
or lower(pp.version) like '%red%hat% 7%' or lower(pp.version) like '%centos% 7%')
and lower(u.module_path) like '%pam_tally2.so%')
)
-- Must precede any lines of same module-type with a control-flag of sufficient with the exception of pam_deny.so
and u.cli_id not in(
select r.cli_id
from jac_data.unix_pam_v1 r
where
r.cli_id = u.cli_id
and r.service = u.service
and r.is_account = 1
and r.is_sufficient = 1
and lower(r.module_path) not like '%pam_deny.so'
and u.row_number &gt; r.row_number)
)
)
UNION
SELECT
distinct e.cli_id, p.version, 'If /etc/pam.d/system-auth exist on Red Hat 6 or above, need additionally set threshold in /etc/pam.d/password-auth using pam_tally2.so pam module.'
FROM
jac_data.unix_pam_v1 e
inner join jac_data.sec_platform_infov2 p on p.cli_id = e.cli_id
and (
lower(p.version) like '%red%hat% 6%'
or lower(p.version) like '%centos% 6%'
or lower(p.version) like '%red%hat% 7%'
or lower(p.version) like '%centos% 7%')
WHERE
-- If /etc/pam.d/system-auth is in use, on RH6 we should additionally check /etc/pam.d/password-auth
e.cli_id in(
select distinct d.cli_id
from jac_data.unix_file_search_v1 d
where
d.filename = '/etc/pam.d/system-auth' and d.line is not null
)
-- check /etc/pam.d/password-auth
and (
e.cli_id not in(
select u.cli_id
from jac_data.unix_pam_v1 u
inner join jac_data.sec_platform_infov2 pp on pp.cli_id = u.cli_id
where
u.cli_id = e.cli_id
and lower(u.service) = '/etc/pam.d/password-auth'
and u.is_auth = 1
and u.is_required = 1
and lower(u.module_arguments) like '%deny=$(Account Login Retries)%'
-- Red Hat 6 or above:
-- auth required pam_tally2.so deny=5
and lower(u.module_path) like '%pam_tally2.so%'
-- Must precede any lines of same module-type with a control-flag of sufficient with the exception of pam_deny.so
and u.cli_id not in(
select r.cli_id
from jac_data.unix_pam_v1 r
where
r.cli_id = u.cli_id
and r.service = '/etc/pam.d/password-auth'
and r.is_auth = 1
and r.is_sufficient = 1
and lower(r.module_path) not like '%pam_deny.so'
and u.row_number &gt; r.row_number)
)
or
e.cli_id not in(
select u.cli_id
from jac_data.unix_pam_v1 u
inner join jac_data.sec_platform_infov2 pp on pp.cli_id = u.cli_id
where
u.cli_id = e.cli_id
and lower(u.service) = '/etc/pam.d/password-auth'
and u.is_account = 1
and u.is_required = 1
-- Red Hat 6 or above:
-- account required pam_tally2.so
and lower(u.module_path) like '%pam_tally2.so%'
-- Must precede any lines of same module-type with a control-flag of sufficient with the exception of pam_deny.so
and u.cli_id not in(
select r.cli_id
from jac_data.unix_pam_v1 r
where
r.cli_id = u.cli_id
and r.service = '/etc/pam.d/password-auth'
and r.is_account = 1
and r.is_sufficient = 1
and lower(r.module_path) not like '%pam_deny.so'
and u.row_number &gt; r.row_number)
)
)</scm:sql>
</cdf:check>
<cdf:remediation parameters="$(Account Login Retries)" disable="false">
<cdf:description>
Remediation on the basis of the requirement: Limit consecutive invalid login attempts to 5.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="6">
<cdf:TechSpecsEntriesRef id="12"/>
<cdf:requires idref="PlatformInfoV2">
</cdf:requires>
<cdf:requires idref="PamV1">
</cdf:requires>
<cdf:title>Password Requirements/Login Retries SLES 10+ and Debian</cdf:title>
<cdf:ruleName>Login_Retries_SLES_10_plus_and_Debian</cdf:ruleName>
<cdf:description>Threshold for consecutive failed login attempts. For Debian and SLES 10 and later: "auth required pam_tally.so deny=5 onerr=fail per_user no_lock_time" in /etc/pam.d/common-auth. And "account required pam_tally.so" in /etc/pam.d/common-account. pam_tally2.so may be used in place of pam_tally.so on any level of Linux which supports pam_tally2.so. Note: Must precede any lines of same module-type with a control-flag of sufficient with the exception of pam_deny.so</cdf:description>
<scm:violationMessage>Invalid or Missing Login Retries required setting. For more information see checks description.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>SELECT
distinct e.cli_id, p.version
FROM
jac_data.unix_pam_v1 e
inner join jac_data.sec_platform_infov2 p on e.cli_id = p.cli_id
WHERE
(lower(p.version) like '%debian%'
or lower(p.version) like '%ubuntu%'
or lower(p.version) like '%suse%10%'
or lower(p.version) like '%suse%11%'
or lower(p.version) like '%suse%12%')
and (e.cli_id not in(
select u.cli_id
from jac_data.unix_pam_v1 u
where
(u.module_path like '%pam_tally2.so'
or u.module_path like '%pam_tally.so')
and ( lower(u.service) = '/etc/pam.d/common-auth'
or exists (
select
y.cli_id --, '/etc/pam.d/' || y.module_path
from
jac_data.unix_pam_v1 y
where
y.is_include = 1
and y.service = '/etc/pam.d/common-auth'
and u.cli_id = y.cli_id
and	u.service = '/etc/pam.d/' || y.module_path
)
)
and u.is_required=1
and u.is_auth=1
and u.is_account=0
and lower(u.module_arguments) like '%deny=$(Account Login Retries)%'
and lower(u.module_arguments) like '%per_user%'
and lower(u.module_arguments) like '%onerr=fail%'
and lower(u.module_arguments) like '%no_lock_time%'
and u.cli_id not in (
select r.cli_id
from jac_data.unix_pam_v1 r
where
u.cli_id = r.cli_id
and u.service = r.service
and u.file_number = r.file_number
and r.is_auth=1
and r.is_sufficient=1
and r.module_path not like '%pam_deny.so'
and u.row_number &gt; r.row_number
)
)
or e.cli_id not in (
select u.cli_id
from jac_data.unix_pam_v1 u
where
(u.module_path like '%pam_tally2.so'
or u.module_path like '%pam_tally.so')
-- /etc/pam.d/common-account
and ( lower(u.service) = '/etc/pam.d/common-account'
or exists (
select
y.cli_id -- , '/etc/pam.d/' || y.module_path
from
jac_data.unix_pam_v1 y
where
y.is_include = 1
and y.service = '/etc/pam.d/common-account'
and u.cli_id = y.cli_id
and	u.service = '/etc/pam.d/' || y.module_path
)
)
-- account required
and u.is_required=1
and u.is_auth=0
and u.is_account=1
and u.cli_id not in (
select r.cli_id
from jac_data.unix_pam_v1 r
where
u.cli_id = r.cli_id
and u.service = r.service
and u.file_number = r.file_number
and r.is_account=1
and r.is_sufficient=1
and r.module_path not like '%pam_deny.so'
and u.row_number &gt; r.row_number
)
)
)</scm:sql>
</cdf:check>
<cdf:remediation parameters="$(Account Login Retries)" disable="false">
<cdf:description>
Remediation on the basis of the requirement: Limit consecutive invalid login attempts to 5.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="7">
<cdf:TechSpecsEntriesRef id="1"/>
<cdf:requires idref="LoginDefsV1">
</cdf:requires>
<cdf:title>Password Requirements/Password MAX Age \etc\login.defs</cdf:title>
<cdf:ruleName>Password_MAX_Age_etc_login_defs</cdf:ruleName>
<cdf:description>Maximum Password Age Requirement. /etc/login.defs must include this line:
PASS_MAX_DAYS 90. More stringent value can be set.</cdf:description>
<scm:violationMessage>Incorrect System Default maximum password age in login.defs: {1}, should be set to {2} days. More stringent value can be set.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a.pass_max_days as "MAX Age", '$(Password MAX Age logindefs)'
FROM
jac_data.linux_login_defs_v1 a
WHERE
(
a.pass_max_days is null
or (
$(Password MAX Age logindefs) &gt; 0
and (a.pass_max_days &lt;= 0 or a.pass_max_days &gt; $(Password MAX Age logindefs))
))
</scm:sql>
</cdf:check>
<cdf:remediation parameters="$(Password MAX Age logindefs)" disable="false">
<cdf:description>
Remediation on the basis of the requirement: Maximum Password Age Requirement = 90 in /etc/login.defs
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="8">
<cdf:TechSpecsEntriesRef id="2,19,20,22,23,25,27,29,30,31,32,33"/>
<cdf:requires idref="NetstatV1">
</cdf:requires>
<cdf:requires idref="UsersV3">
</cdf:requires>
<cdf:requires idref="PAMDisabledUsersV1">
</cdf:requires>
<cdf:requires idref="FtpUsersV1">
</cdf:requires>
<cdf:requires idref="ShadowV2">
</cdf:requires>
<cdf:requires idref="FileSearchv1">
</cdf:requires>
<cdf:requires idref="OpenSSHV5">
</cdf:requires>
<cdf:requires idref="GroupsV2">
</cdf:requires>
<cdf:requires idref="PlatformInfoV2">
</cdf:requires>
<cdf:title>Password Requirements/Password MAX Age \etc\shadow</cdf:title>
<cdf:ruleName>Password_MAX_Age_shadow</cdf:ruleName>
<cdf:description>Maximum password age requirement: Field 5 of /etc/shadow must be 90. More stringent value can be set. Privileged users can not have a non-expiring passwords.</cdf:description>
<scm:violationMessage>Account {1} has invalid Password Max Age setting of {2}, should be set to {3}.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a.username, a.maxage,
-- UIDLabelling disabled
CASE WHEN $(UIDLabelling) = 0 THEN 'Customer Required Setting: $(Password MAX Age shadow Customer Accounts). More secure value can be set. Account Type: (UID Labeling not enabled)' ELSE
-- UIDLabelling enabled
CASE WHEN zz.account_type = 'customer' THEN 'Customer Required Setting: $(Password MAX Age shadow Customer Accounts). More secure value can be set. Account Type: customer' ELSE
CASE WHEN zz.account_type IN ('ibm','orphan') THEN
CASE WHEN ($(Password MAX Age shadow IBM Accounts) &lt; $(Password MAX Age shadow Customer Accounts)
OR $(Password MAX Age shadow Customer Accounts) &lt;= 0)
-- IBM max age requirement more strict
THEN 'IBM Required Setting: $(Password MAX Age shadow IBM Accounts). More secure value can be set. Account Type: ' || zz.account_type
-- Customner requirement more strict
ELSE 'Customer Required Setting: $(Password MAX Age shadow Customer Accounts). More secure value can be set. Account Type: ' || zz.account_type END
END END END
FROM
jac_data.unix_shadow_v2 a
LEFT JOIN (
-- list of privileged users
SELECT
distinct a.CLI_ID, a.USERNAME
FROM
jac_data.unix_shadow_v2 a
INNER JOIN jac_data.sec_platform_infoV2 f on a.cli_id = f.cli_id
INNER JOIN jac_data.unix_group_members_v2 e on a.cli_id = e.cli_id and a.username=e.user_name
and (
e.gid &lt;= 99
or (e.gid &gt;=101 and e.gid &lt;= 199 and
lower(f.version) like '%debian%5%')
or (e.gid &gt;=101 and e.gid &lt;= 499 and (
lower(f.version) like '%red%hat%5%' or
lower(f.version) like '%red%hat%6%' or
lower(f.version) like '%centos%5%' or
lower(f.version) like '%centos%6%'))
or (e.gid &gt;=101 and e.gid &lt;= 499 and (
lower(f.version) like 'suse linux enterprise server 9%' or
lower(f.version) like 'suse linux enterprise server 10%' or
lower(f.version) like 'suse linux enterprise server 11%'))
or (e.gid &gt;=101 and e.gid &lt;= 999 and (
lower(f.version) like '%red hat%release 7%' or
lower(f.version) like '%centos%release 7%'))
or (e.gid &gt;=101 and e.gid &lt;= 999 and (
lower(f.version) like '%debian%6%' or
lower(f.version) like '%debian%7%'
or lower(f.version) like 'ubuntu%'))
)
) aa (cli_id, username) ON a.CLI_ID = aa.cli_id AND a.USERNAME = aa.username
LEFT JOIN jac_data.unix_users_v3 z on a.cli_id = z.cli_id and a.username = z.username AND z.shell in ('/bin/false','/sbin/nologin')
LEFT JOIN jac_data.unix_netstat_v1 s ON a.CLI_ID = s.CLI_ID AND s.local_port = '21' and s.state = 'LISTEN'
LEFT JOIN jac_data.unix_ftpusers_v1 d ON a.CLI_ID = d.CLI_ID AND a.USERNAME = d.USER_NAME
LEFT JOIN jac_data.unix_file_search_v1 c ON a.CLI_ID = c.CLI_ID AND c.FILENAME IN ( '/etc/vsftpd.ftpusers',  '/etc/vsftpd/ftpusers') AND a.USERNAME = c.LINE
LEFT JOIN jac_data.unix_pam_disabled_users_v1 l ON a.CLI_ID = l.CLI_ID AND l."USER" = a.USERNAME
LEFT JOIN jac_data.unix_pam_service_file_v1 m ON l.CLI_ID = m.CLI_ID AND m.RULE_BEFORE = 1 AND m.file LIKE '/etc/security/%'
LEFT JOIN jac_data.openssh_params_v5 x ON a.CLI_ID = x.CLI_ID AND x.use_pam = 1
LEFT JOIN (
SELECT a.USERNAME,
CASE WHEN (upper(a.gecos) like '%/C/%/%'
or upper(a.gecos) like '%/V/%/%'
or upper(a.gecos) like '%/T/%/%'
or a.username in ($(Account Labelling Excluded Accounts))) THEN 'customer' ELSE
CASE WHEN (upper(a.gecos) like '%/I/%/%'
or upper(a.gecos) like '%/N/%/%'
or upper(a.gecos) like '%/E/%/%'
or upper(a.gecos) like '%/F/%/%'
or upper(a.gecos) like '%/S/%/%')
and a.username not in ($(Account Labelling Excluded Accounts)) THEN 'ibm' ELSE
CASE WHEN a.username not in ($(Account Labelling Excluded Accounts)) THEN 'orphan' END END END
FROM JAC_DATA.UNIX_USERS_V3 a) zz (username, account_type) ON a.USERNAME = zz.USERNAME
WHERE
((
-- UIDlabling is disabled or enabled and user type is 'customer'
(
$(UIDLabelling) = 0
OR ($(UIDLabelling) = 1 AND zz.account_type = 'customer'))
AND $(Password MAX Age shadow Customer Accounts) &gt; 0
AND (
a.MAXAGE IS NULL
OR a.maxage &lt;= 0
OR a.maxage &gt; $(Password MAX Age shadow Customer Accounts)
)
)
OR
(
-- UIDlabling is enabled and user type is ibm or orphan
($(UIDLabelling) = 1 AND zz.account_type IN ('ibm','orphan'))
AND $(Password MAX Age shadow IBM Accounts) &gt; 0
AND
(
a.MAXAGE IS NULL
OR a.MAXAGE &lt;= 0
OR
(
-- IBM max age setting more strict
(
$(Password MAX Age shadow IBM Accounts) &lt; $(Password MAX Age shadow Customer Accounts)
OR $(Password MAX Age shadow Customer Accounts) &lt;= 0
)
AND a.maxage &gt; $(Password MAX Age shadow IBM Accounts)
)
OR
(
-- Customer max age setting more strict or equal to IBM setting
(
$(Password MAX Age shadow Customer Accounts) &lt;= $(Password MAX Age shadow IBM Accounts)
AND $(Password MAX Age shadow Customer Accounts) &gt; 0
)
AND a.maxage &gt; $(Password MAX Age shadow Customer Accounts)
)
)
))
and int(a.is_account_active) = 1
and a.is_passwd_empty &lt;&gt; 1
AND
(
-- for privileged users only options B and C allowed as exception to password rules.
-- It is already checked in 'int(a.is_account_active) = 1'
aa.CLI_ID IS NOT NULL
OR
(
-- for non privileged users additional options A and D can be applyed.
-- option A
(z.CLI_ID IS NULL OR (s.CLI_ID IS NULL OR (d.CLI_ID IS NULL and c.CLI_ID IS NULL)))
-- option D
AND (m.CLI_ID IS NULL OR x.CLI_ID IS NULL OR (s.CLI_ID IS NULL OR (d.CLI_ID IS NULL and c.CLI_ID IS NULL)))
)
)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="$(Password MAX Age shadow Customer Accounts)" disable="false">
<cdf:description>
For all users with a password assigned in /etc/shadow, enforce that the password max age (field 5) should be set to the specified value (normally 90)
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="9">
<cdf:TechSpecsEntriesRef id="5"/>
<cdf:requires idref="ShadowV2">
</cdf:requires>
<cdf:requires idref="UsersV3">
</cdf:requires>
<cdf:title>Password Requirements/Password MIN Age Shadow</cdf:title>
<cdf:ruleName>Password_MIN_Age_Shadow</cdf:ruleName>
<cdf:description>Minimum Password Age Requirement = 1 in /etc/shadow. When policy parameter 'UIDLabelling' is enabled; Policy Parameters allow Customer and IBM account password requirements to be set separately.  The strictest setting is applied to non-customer accounts.  The following Account types are applied: Customer, IBM, or Orphan (No UserID Label).</cdf:description>
<scm:violationMessage>Account {1} has invalid Password Min Age setting of {4}, should be set to {5}. {2}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
---- Customer UserIDs
SELECT
distinct a.cli_id, a.username as USER_NAME,  RTRIM('Account Type: Customer') as ACCOUNT_TYPE, b.gecos as USER_GECOS, a.minage as CURRENT_SETTING, 'Customer Required Setting: $(Password MIN Age shadow Customer Accounts)' as REQUIRED_SETTING
FROM
jac_data.unix_shadow_v2 a
left outer join jac_data.unix_users_v3 b on a.cli_id = b.cli_id and a.username = b.username
WHERE
a.is_account_active = 1
and ( a.is_passwd_empty = 0  or a.is_md5 =0 and a.is_blowfish=0 and a.is_des=0 and a.is_sunmd5=0)
and $(Password MIN Age shadow Customer Accounts) &gt; 0
and (
a.minage is NULL
or int(a.minage) &lt; $(Password MIN Age shadow Customer Accounts)
)
and ( upper(b.gecos) like '%/C/%/%'
or upper(b.gecos) like '%/V/%/%'
or upper(b.gecos) like '%/T/%/%'
or a.username in ($(Account Labelling Excluded Accounts) )
)
and $(UIDLabelling) = 1
UNION
---- IBM UserIDs - IBM requirement more strict
SELECT
distinct a.cli_id, a.username as USER_NAME,  RTRIM('Account Type: IBM (Stricted Setting Validated)') as ACCOUNT_TYPE, b.gecos as USER_GECOS, a.minage as CURRENT_SETTING, 'IBM Required Setting: $(Password MIN Age shadow IBM Accounts)' as REQUIRED_SETTING
FROM
jac_data.unix_shadow_v2 a
left outer join jac_data.unix_users_v3 b on a.cli_id = b.cli_id and a.username = b.username
WHERE
a.is_account_active = 1
and ( a.is_passwd_empty = 0  or a.is_md5 =0 and a.is_blowfish=0 and a.is_des=0 and a.is_sunmd5=0)
and $(Password MIN Age shadow IBM Accounts) &gt; 0
and $(Password MIN Age shadow IBM Accounts) &gt;= $(Password MIN Age shadow Customer Accounts)
and (
a.minage is NULL
or int(a.minage) &lt; $(Password MIN Age shadow IBM Accounts)
)
and a.username not in ( $(Account Labelling Excluded Accounts) )
and ( upper(b.gecos) like '%/I/%/%'
or upper(b.gecos) like '%/N/%/%'
or upper(b.gecos) like '%/E/%/%'
or upper(b.gecos) like '%/F/%/%'
or upper(b.gecos) like '%/S/%/%' )
and $(UIDLabelling) = 1
UNION
---- IBM UserIDs - Customer requirement more strict
SELECT
distinct a.cli_id, a.username as USER_NAME,  RTRIM('Account Type: IBM (Stricted Setting Validated)') as ACCOUNT_TYPE, b.gecos as USER_GECOS, a.minage as CURRENT_SETTING, 'Customer Required Setting: $(Password MIN Age shadow Customer Accounts)' as REQUIRED_SETTING
FROM
jac_data.unix_shadow_v2 a
left outer join jac_data.unix_users_v3 b on a.cli_id = b.cli_id and a.username = b.username
WHERE
a.is_account_active = 1
and ( a.is_passwd_empty = 0  or a.is_md5 =0 and a.is_blowfish=0 and a.is_des=0 and a.is_sunmd5=0)
and $(Password MIN Age shadow IBM Accounts) &gt; 0
and $(Password MIN Age shadow Customer Accounts) &gt; $(Password MIN Age shadow IBM Accounts)
and (
a.minage is NULL
or int(a.minage) &lt; $(Password MIN Age shadow Customer Accounts)
)
and a.username not in ( $(Account Labelling Excluded Accounts) )
and ( upper(b.gecos) like '%/I/%/%'
or upper(b.gecos) like '%/N/%/%'
or upper(b.gecos) like '%/E/%/%'
or upper(b.gecos) like '%/F/%/%'
or upper(b.gecos) like '%/S/%/%' )
and $(UIDLabelling) = 1
UNION
---- Orphan UserIDs - IBM requirement more strict
SELECT
distinct a.cli_id, a.username as USER_NAME,  RTRIM('Account Type: Orphan (Stricted Setting Validated)') as ACCOUNT_TYPE, b.gecos as USER_GECOS, a.minage as CURRENT_SETTING, 'IBM Required Setting: $(Password MIN Age shadow IBM Accounts)' as REQUIRED_SETTING
FROM
jac_data.unix_shadow_v2 a
left outer join jac_data.unix_users_v3 b on a.cli_id = b.cli_id and a.username = b.username
WHERE
a.is_account_active = 1
and ( a.is_passwd_empty = 0  or a.is_md5 =0 and a.is_blowfish=0 and a.is_des=0 and a.is_sunmd5=0)
and $(Password MIN Age shadow IBM Accounts) &gt; 0
and $(Password MIN Age shadow IBM Accounts) &gt;= $(Password MIN Age shadow Customer Accounts)
and (
a.minage is NULL
or int(a.minage) &lt; $(Password MIN Age shadow IBM Accounts)
)
and a.username not in ( $(Account Labelling Excluded Accounts) )
and upper(b.gecos) not like '%/C/%/%'
and upper(b.gecos) not like '%/V/%/%'
and upper(b.gecos) not like '%/T/%/%'
and upper(b.gecos) not like '%/I/%/%'
and upper(b.gecos) not like '%/N/%/%'
and upper(b.gecos) not like '%/E/%/%'
and upper(b.gecos) not like '%/F/%/%'
and upper(b.gecos) not like '%/S/%/%'
and $(UIDLabelling) = 1
UNION
---- Orphan UserIDs - customer requirement more strict
SELECT
distinct a.cli_id, a.username as USER_NAME,  RTRIM('Account Type: Orphan (Stricted Setting Validated)') as ACCOUNT_TYPE, b.gecos as USER_GECOS, a.minage as CURRENT_SETTING, 'Customer Required Setting: $(Password MIN Age shadow Customer Accounts)' as REQUIRED_SETTING
FROM
jac_data.unix_shadow_v2 a
left outer join jac_data.unix_users_v3 b on a.cli_id = b.cli_id and a.username = b.username
WHERE
a.is_account_active = 1
and ( a.is_passwd_empty = 0  or a.is_md5 =0 and a.is_blowfish=0 and a.is_des=0 and a.is_sunmd5=0)
and $(Password MIN Age shadow IBM Accounts) &gt; 0
and $(Password MIN Age shadow Customer Accounts) &gt; $(Password MIN Age shadow IBM Accounts)
and (
a.minage is NULL
or int(a.minage) &lt; $(Password MIN Age shadow Customer Accounts)
)
and a.username not in ( $(Account Labelling Excluded Accounts) )
and upper(b.gecos) not like '%/C/%/%'
and upper(b.gecos) not like '%/V/%/%'
and upper(b.gecos) not like '%/T/%/%'
and upper(b.gecos) not like '%/I/%/%'
and upper(b.gecos) not like '%/N/%/%'
and upper(b.gecos) not like '%/E/%/%'
and upper(b.gecos) not like '%/F/%/%'
and upper(b.gecos) not like '%/S/%/%'
and $(UIDLabelling) = 1
UNION
---- UserID Labeling Not Implemented
SELECT
distinct a.cli_id, a.username as USER_NAME,  RTRIM('Account Type: (UID Labelling not enabled)') as ACCOUNT_TYPE, b.gecos as USER_GECOS, a.minage as CURRENT_SETTING, 'Customer Required Setting: $(Password MIN Age shadow Customer Accounts)' as REQUIRED_SETTING
FROM
jac_data.unix_shadow_v2 a
left outer join jac_data.unix_users_v3 b on a.cli_id = b.cli_id and a.username = b.username
WHERE
a.is_account_active = 1
and ( a.is_passwd_empty = 0  or a.is_md5 =0 and a.is_blowfish=0 and a.is_des=0 and a.is_sunmd5=0)
and $(Password MIN Age shadow Customer Accounts) &gt; 0
and (
a.minage is NULL
or int(a.minage) &lt; $(Password MIN Age shadow Customer Accounts)
)
and $(UIDLabelling) = 0
</scm:sql>
</cdf:check>
<cdf:remediation parameters="$(Password MIN Age shadow Customer Accounts)" disable="false">
<cdf:description>
Remediation on the basis of the requirement: Minimum Password Age Requirement = 1 in /etc/shadow.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="10">
<cdf:TechSpecsEntriesRef id="4"/>
<cdf:requires idref="LoginDefsV1">
</cdf:requires>
<cdf:title>Password Requirements/Password MIN Age login.defs</cdf:title>
<cdf:ruleName>Password_MIN_Age_login_defs</cdf:ruleName>
<cdf:description>Minimum Password Age Requirement = 1 in /etc/login.defs</cdf:description>
<scm:violationMessage>Incorrect System Default minimum password age in login.defs: {1}, should be set to {2} days</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a.pass_min_days, '$(Password MIN Age logindefs)'
FROM
jac_data.linux_login_defs_v1 a
WHERE
$(Password MIN Age logindefs) &gt; 0
and (
a.pass_min_days is null
or a.pass_min_days &lt; $(Password MIN Age logindefs)
)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="$(Password MIN Age logindefs)" disable="false">
<cdf:description>
Remediation on the basis of the requirement: Minimum Password Age Requirement = 1 in /etc/login.defs
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="11">
<cdf:TechSpecsEntriesRef id="3"/>
<cdf:requires idref="LoginDefsV1">
</cdf:requires>
<cdf:requires idref="PlatformInfoV2">
</cdf:requires>
<cdf:requires idref="FileSearchv1">
</cdf:requires>
<cdf:requires idref="PamV1">
</cdf:requires>
<cdf:title>Password Requirements/Password MIN Length and complexity</cdf:title>
<cdf:ruleName>Password_MIN_Length_and_complexity</cdf:ruleName>
<cdf:description>Minimum password length and password complexity rules should be set through one of this PAM modules: pam_cracklib.so, pam_pwquality.so in /etc/pam.d/$PAMFILE for "password $CONTROL... stanza" , using mandatory set of parameters for used module. For more information see matrix coverage document. $PAMFILE will be 'commonpassword' for SLES and Debian, other distributions:'systemauth' and 'passwordauth'. $CONTROL must be one of "requisite" or "required".</cdf:description>
<scm:violationMessage>Incorrect System Default minimum password length or password complexity rules. {1}. For more information about password length or password complexity rules see matrix coverage document.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT a.cli_id, 'Minimum password length should be set to $(Password MIN Length) or more secure, in file /etc/pam.d/common-password. It should be set through pam_cracklib.so or pam_pwquality.so'
FROM JAC_DATA.UNIX_PAM_V1 a
LEFT JOIN (SELECT DISTINCT a.CLI_ID FROM JAC_DATA.UNIX_PAM_V1 a
WHERE a.SERVICE = '/etc/pam.d/common-password') aa ON a.CLI_ID = aa.CLI_ID
LEFT JOIN JAC_DATA.SEC_PLATFORM_INFOV2 p ON a.CLI_ID = p.CLI_ID
WHERE
(lower(p.version) like '%debian%'
or lower(p.version) like '%suse%'
or lower(p.version) like '%ubuntu%')
AND $(Password MIN Length) &gt; 0
and(
aa.CLI_ID IS NULL
OR (
lower(a.SERVICE) ='/etc/pam.d/common-password' AND
a.CLI_ID NOT IN
(
SELECT u.CLI_ID FROM
JAC_DATA.UNIX_PAM_V1 u
LEFT JOIN JAC_DATA.UNIX_PAM_CRACKLIB_V1 b ON b.CLI_ID = u.cli_id AND b.FILE_NUMBER = u.FILE_NUMBER AND b."ROW_NUMBER" = u."ROW_NUMBER"
LEFT JOIN JAC_DATA.UNIX_PAM_PWQUALITY_V1 d ON d.CLI_ID = u.cli_id AND d.FILE_NUMBER = u.FILE_NUMBER AND d."ROW_NUMBER" = u."ROW_NUMBER"
WHERE
u.IS_PASSWORD = 1
AND (u.IS_REQUIRED = 1 OR u.IS_REQUISITE = 1)
AND (lower(u.service) = '/etc/pam.d/common-password' OR exists (
SELECT
y.cli_id
FROM
jac_data.unix_pam_v1 y
where
y.is_include = 1
and (y.service = '/etc/pam.d/common-password')
and u.cli_id = y.cli_id
and	u.service = '/etc/pam.d/' || y.module_path
))
AND
(
--cracklib args
(b.CLI_ID IS NOT NULL AND b.MINLEN &gt;= $(Password MIN Length) AND b.DCREDIT = -1 AND b.UCREDIT = 0 AND b.LCREDIT = -1 AND b.OCREDIT = 0 AND b.REJECT_USERNAME = 1)
OR
--pwquality args
(d.CLI_ID IS NOT NULL AND d.MINLEN &gt;= $(Password MIN Length) AND d.DCREDIT = -1 AND d.UCREDIT = 0 AND d.LCREDIT = -1 AND d.OCREDIT = 0 ))
))
)
UNION
-- for RHEL all versions system-auth
SELECT DISTINCT a.cli_id, 'Minimum password length should be set to $(Password MIN Length) or more secure, in file /etc/pam.d/system-auth. It should be set through pam_cracklib.so or pam_pwquality.so'
FROM JAC_DATA.UNIX_PAM_V1 a
LEFT JOIN (SELECT DISTINCT a.CLI_ID FROM JAC_DATA.UNIX_PAM_V1 a
WHERE a.SERVICE = '/etc/pam.d/system-auth') aa ON a.CLI_ID = aa.CLI_ID
LEFT JOIN JAC_DATA.SEC_PLATFORM_INFOV2 p ON a.CLI_ID = p.CLI_ID
WHERE
(lower(p.version) like '%red%hat%' OR lower(p.version) like '%centos%')
AND
$(Password MIN Length) &gt; 0
AND (
aa.CLI_ID IS NULL OR (
lower(a.SERVICE) = '/etc/pam.d/system-auth'
AND
a.CLI_ID NOT IN
(
SELECT u.CLI_ID FROM
JAC_DATA.UNIX_PAM_V1 u
LEFT JOIN JAC_DATA.UNIX_PAM_CRACKLIB_V1 b ON b.CLI_ID = u.cli_id AND b.FILE_NUMBER = u.FILE_NUMBER AND b."ROW_NUMBER" = u."ROW_NUMBER"
LEFT JOIN JAC_DATA.UNIX_PAM_PWQUALITY_V1 d ON d.CLI_ID = u.cli_id AND d.FILE_NUMBER = u.FILE_NUMBER AND d."ROW_NUMBER" = u."ROW_NUMBER"
WHERE
u.IS_PASSWORD = 1
AND (u.IS_REQUIRED = 1 OR u.IS_REQUISITE = 1)
AND (lower(u.service) = '/etc/pam.d/system-auth' OR exists (
SELECT
y.cli_id
FROM
jac_data.unix_pam_v1 y
where
y.is_include = 1
and (y.service = '/etc/pam.d/system-auth')
and u.cli_id = y.cli_id
and	u.service = '/etc/pam.d/' || y.module_path
))
AND
(
--cracklib args
(b.CLI_ID IS NOT NULL AND b.MINLEN &gt;= $(Password MIN Length) AND b.DCREDIT = -1 AND b.UCREDIT = 0 AND b.LCREDIT = -1 AND b.OCREDIT = 0 AND b.REJECT_USERNAME = 1)
OR
--pwquality args
(d.CLI_ID IS NOT NULL AND d.MINLEN &gt;= $(Password MIN Length) AND d.DCREDIT = -1 AND d.UCREDIT = 0 AND d.LCREDIT = -1 AND d.OCREDIT = 0 ))
)))
UNION
-- for RHEL all versions password-auth
SELECT DISTINCT a.cli_id, 'Minimum password length should be set to $(Password MIN Length) or more secure, in file /etc/pam.d/password-auth. It should be set through pam_cracklib.so or pam_pwquality.so'
FROM JAC_DATA.UNIX_PAM_V1 a
LEFT JOIN (SELECT DISTINCT a.CLI_ID FROM JAC_DATA.UNIX_PAM_V1 a
WHERE a.SERVICE = '/etc/pam.d/password-auth') aa ON a.CLI_ID = aa.CLI_ID
LEFT JOIN JAC_DATA.SEC_PLATFORM_INFOV2 p ON a.CLI_ID = p.CLI_ID
WHERE
(lower(p.version) like '%red%hat%' OR lower(p.version) like '%centos%')
AND $(Password MIN Length) &gt; 0
AND (
aa.CLI_ID IS NULL
OR (
lower(a.SERVICE) = '/etc/pam.d/password-auth'
AND
a.CLI_ID NOT IN
(
SELECT u.CLI_ID FROM
JAC_DATA.UNIX_PAM_V1 u
LEFT JOIN JAC_DATA.UNIX_PAM_CRACKLIB_V1 b ON b.CLI_ID = u.cli_id AND b.FILE_NUMBER = u.FILE_NUMBER AND b."ROW_NUMBER" = u."ROW_NUMBER"
LEFT JOIN JAC_DATA.UNIX_PAM_PWQUALITY_V1 d ON d.CLI_ID = u.cli_id AND d.FILE_NUMBER = u.FILE_NUMBER AND d."ROW_NUMBER" = u."ROW_NUMBER"
WHERE
u.IS_PASSWORD = 1
AND (u.IS_REQUIRED = 1 OR u.IS_REQUISITE = 1)
AND (lower(u.service) = '/etc/pam.d/password-auth' OR exists (
SELECT
y.cli_id
FROM
jac_data.unix_pam_v1 y
where
y.is_include = 1
and (y.service = '/etc/pam.d/password-auth')
and u.cli_id = y.cli_id
and	u.service = '/etc/pam.d/' || y.module_path
))
AND
(
--cracklib args
(b.CLI_ID IS NOT NULL AND b.MINLEN &gt;= $(Password MIN Length) AND b.DCREDIT = -1 AND b.UCREDIT = 0 AND b.LCREDIT = -1 AND b.OCREDIT = 0 AND b.REJECT_USERNAME = 1)
OR
--pwquality args
(d.CLI_ID IS NOT NULL AND d.MINLEN &gt;= $(Password MIN Length) AND d.DCREDIT = -1 AND d.UCREDIT = 0 AND d.LCREDIT = -1 AND d.OCREDIT = 0 ))
)))
</scm:sql>
</cdf:check>
<cdf:remediation parameters="$(Password MIN Length)" disable="false">
<cdf:description>
The script looks in /etc/pam.d/system-auth (for RedHat; for SuSe it is /etc/pam.d/common-password) and check for the existence of any of the stanzas specified in the policy,  i.e. "password required pam_cracklib.so" stanza and "password required pam_passwdqc.so" stanza and "password required pam_pwquality.so" stanza:
- parameters of "retry=3 minlen=15 dcredit=-1 ucredit=0 lcredit=-1 ocredit=0 type= reject_username" in /etc/pam.d/system-auth to the "password required pam_cracklib.so ..." stanza
- parameters of "retry=3 minlen=15 dcredit=-1 ucredit=0 lcredit=-1 ocredit=0 type= reject_username" in /etc/pam.d/system-auth to the "password required pam_passwdqc.so" stanza.
- parameters of "retry=3 minlen=15 dcredit=-1 ucredit=0 lcredit=-1 ocredit=0 type= reject_username" in /etc/pam.d/system-auth to the "password required pam_pwquality.so" stanza.
For any stanza found, replace its line with the values specified in the policy, except that the password min length value is taken from the parameter passed to this rule.
If none of the stanza lines is found, append the new line of stanza 1 to the file.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="127">
<cdf:TechSpecsEntriesRef id="219"/>
<cdf:requires idref="ShadowV2">
</cdf:requires>
<cdf:title>Password Requirements/Password shadow specification</cdf:title>
<cdf:ruleName>Password_shadow_specification</cdf:ruleName>
<cdf:description>In /etc/shadow, password (second field) cannot be assigned the null value (::) as this would allow the id to be accessed without entering a password or
using the 'empty' (null) password.</cdf:description>
<scm:violationMessage>Account: {1} have "empty" (null) password. In /etc/shadow, password (second field) cannot be assigned the null value.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a.username
FROM
jac_data.unix_shadow_v2 a
WHERE
a.is_passwd_empty = 1
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
If password field is null in /etc/shadow file,then it will be replaced by !!(Double exclamation) which indicates user account is disabled or password not set.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="13">
<cdf:TechSpecsEntriesRef id="6"/>
<cdf:requires idref="PlatformInfoV2">
</cdf:requires>
<cdf:requires idref="PamV1">
</cdf:requires>
<cdf:title>Password Requirements/RedHat Password History</cdf:title>
<cdf:ruleName>RedHat_Password_History</cdf:ruleName>
<cdf:description>Prevent reuse of passwords on REDHAT - password sufficient pam_unix.so remember=7 use_authtok sha512 shadow.  If /etc/pam.d/system-auth exists, this is the control file. Otherwise, it must appear in /etc/pam.d/passwd, /etc/pam.d/login, /etc/pam.d/sshd and /etc/pam.d/su. For Red Hat Enterprise Linux V6 and later controls must ADDITIONALLY be applied to the /etc/pam.d/password-auth file</cdf:description>
<scm:violationMessage>PAM settings must contain "password sufficient remember={1} use_authtok sha512 shadow" for pam_unix.so module</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, '$(Password History 2)'
FROM
jac_data.unix_pam_v1 a
WHERE
a.cli_id  not in (
SELECT
distinct x.cli_id
FROM
jac_data.unix_pam_v1 x
WHERE
a.cli_id = x.cli_id
and ( lower(x.service) = '/etc/pam.d/system-auth'
or exists (
SELECT
'/etc/pam.d/' || y.module_path
FROM
jac_data.unix_pam_v1 y
where
y.is_include = 1
and y.service = '/etc/pam.d/system-auth'
and x.cli_id = y.cli_id
and x.service = '/etc/pam.d/' || y.module_path
)
)
and x.is_password = 1
and x.is_sufficient = 1
and lower(x.module_path) like '%pam_unix.so'
and lower(x.module_arguments) like '%remember=$(Password History 2)%'
and lower(x.module_arguments) like '%use_authtok%'
and lower(x.module_arguments) like '%sha512%'
and lower(x.module_arguments) like '%shadow%'
)
and a.cli_id not in(
SELECT
u.cli_id
FROM
jac_data.unix_pam_v1 u
WHERE
a.cli_id = u.cli_id
and ( lower(u.service) = '/etc/pam.d/password-auth'
or exists (
SELECT
'/etc/pam.d/' || y.module_path
FROM
jac_data.unix_pam_v1 y
where
y.is_include = 1
and y.service = '/etc/pam.d/password-auth'
and u.cli_id = y.cli_id
and u.service = '/etc/pam.d/' || y.module_path
)
)
and u.is_password = 1
and u.is_sufficient = 1
and lower(u.module_path) like '%pam_unix.so'
and lower(u.module_arguments) like  '%remember=$(Password History 2)%'
and lower(u.module_arguments) like '%use_authtok%'
and lower(u.module_arguments) like '%sha512%'
and lower(u.module_arguments) like '%shadow%'
and u.cli_id in(
select p.cli_id
from jac_data.sec_platform_infov2 p
where
lower(p.version) like '%red%hat%6.%' or
lower(p.version)  like '%centos%6.%' or
lower(p.version)  like '%red%hat%7.%' or
lower(p.version)  like '%centos%7.%'
)
)
and  ( a.cli_id  not in (
SELECT
distinct y.cli_id
FROM
jac_data.unix_pam_v1 y
WHERE
a.cli_id = y.cli_id
and ( lower(y.service) = '/etc/pam.d/passwd'
or exists (
SELECT
'/etc/pam.d/' || yy.module_path
FROM
jac_data.unix_pam_v1 yy
where
yy.is_include = 1
and yy.service = '/etc/pam.d/passwd'
and y.cli_id = yy.cli_id
and y.service = '/etc/pam.d/' || yy.module_path
)
)
and y.is_password = 1
and y.is_sufficient = 1
and lower(y.module_path) like '%pam_unix.so'
and lower(y.module_arguments) like '%remember=$(Password History 2)%'
and lower(y.module_arguments) like '%use_authtok%'
and lower(y.module_arguments) like '%sha512%'
and lower(y.module_arguments) like '%shadow%'
)
or a.cli_id  not in (
SELECT
distinct z.cli_id
FROM
jac_data.unix_pam_v1 z
WHERE
a.cli_id = z.cli_id
and ( lower(z.service) = '/etc/pam.d/login'
or exists (
SELECT
'/etc/pam.d/' || y.module_path
FROM
jac_data.unix_pam_v1 y
where
y.is_include = 1
and y.service = '/etc/pam.d/login'
and z.cli_id = y.cli_id
and z.service = '/etc/pam.d/' || y.module_path
)
)
and z.is_password = 1
and z.is_sufficient = 1
and lower(z.module_path) like '%pam_unix.so'
and lower(z.module_arguments) like '%remember=$(Password History 2)%'
and lower(z.module_arguments) like '%use_authtok%'
and lower(z.module_arguments) like '%sha512%'
and lower(z.module_arguments) like '%shadow%'
)
or a.cli_id not in (
SELECT
distinct d.cli_id
FROM
jac_data.unix_pam_v1 d
WHERE
a.cli_id = d.cli_id
and ( lower(d.service) = '/etc/pam.d/sshd'
or exists (
SELECT
'/etc/pam.d/' || y.module_path
FROM
jac_data.unix_pam_v1 y
where
y.is_include = 1
and y.service = '/etc/pam.d/sshd'
and d.cli_id = y.cli_id
and d.service = '/etc/pam.d/' || y.module_path
)
)
and d.is_password = 1
and d.is_sufficient = 1
and lower(d.module_path) like '%pam_unix.so'
and lower(d.module_arguments) like '%remember=$(Password History 2)%'
and lower(d.module_arguments) like '%use_authtok%'
and lower(d.module_arguments) like '%sha512%'
and lower(d.module_arguments) like '%shadow%'
)
or a.cli_id not in (
SELECT
distinct e.cli_id
FROM
jac_data.unix_pam_v1 e
WHERE
a.cli_id = e.cli_id
and ( lower(e.service) = '/etc/pam.d/su'
or exists (
SELECT
'/etc/pam.d/' || y.module_path
FROM
jac_data.unix_pam_v1 y
where
y.is_include = 1
and y.service = '/etc/pam.d/su'
and e.cli_id = y.cli_id
and e.service = '/etc/pam.d/' || y.module_path
)
)
and e.is_password = 1
and e.is_sufficient = 1
and lower(e.module_path) like '%pam_unix.so'
and lower(e.module_arguments) like '%remember=$(Password History 2)%'
and lower(e.module_arguments) like '%use_authtok%'
and lower(e.module_arguments) like '%sha512%'
and lower(e.module_arguments) like '%shadow%'
)
)
and a.cli_id in (
select p.cli_id
from jac_data.sec_platform_infov2 p
where lower(p.version) like 'red hat%' or lower(p.version) like '%centos%'
)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="$(Password History 2)" disable="false">
<cdf:description>
Remediation on the basis of the requirement: Prevent reuse of passwords on REDHAT
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="14">
<cdf:TechSpecsEntriesRef id="13"/>
<cdf:requires idref="ShadowV2">
</cdf:requires>
<cdf:title>Password Requirements/Root Password Required</cdf:title>
<cdf:ruleName>Root_Password_Required</cdf:ruleName>
<cdf:description>Root account must have password assigned</cdf:description>
<scm:violationMessage>Account: {1} is missing password</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a.username, a.is_passwd_empty
FROM
jac_data.unix_shadow_v2 a
WHERE
a.username = 'root'
and a.is_passwd_empty = 1
</scm:sql>
</cdf:check>
<cdf:remediation parameters="Root account must have password assigned" disable="true">
<cdf:description>
Remediation automation not possible.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="15">
<cdf:TechSpecsEntriesRef id="14"/>
<cdf:requires idref="OpenSSHV5">
</cdf:requires>
<cdf:title>Password Requirements/SSH PermitRootLogin Restriction</cdf:title>
<cdf:ruleName>SSH_PermitRootLogin_Restriction</cdf:ruleName>
<cdf:description>PermitRootLogin - Permits the root user to login remotely. Value must be set to NO or without-password.  Unless mechanisms are in place to determine the identity of the individual accessing the system, in sshd_config</cdf:description>
<scm:violationMessage>Invalid setting (value: {2}) for sshd (processPID: {1}) in parameter 'PermitRootLogin': must be set to 'no'  or 'without-password'.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT
a.cli_id, a.process_pid as "PID", a.permit_root_login
FROM
jac_data.openssh_params_v5 a
WHERE
UPPER(a.permit_root_login) NOT IN ('NO', 'WITHOUT-PASSWORD', 'NOPWD', 'FORCED-COMMANDS-ONLY' )
and a.process_pid is not null
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation on the basis of the requirement: PermitRootLogin - Permits the root user to login remotely. Value must be set to NO or without-password.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="18">
<cdf:TechSpecsEntriesRef id="14"/>
<cdf:requires idref="SecureTtyV1">
</cdf:requires>
<cdf:title>Password Requirements/Telnet Remote Root Login Restricted</cdf:title>
<cdf:ruleName>Telnet_Remote_Root_Login_Restricted</cdf:ruleName>
<cdf:description>Root access must be restricted to the physical console, or to a method that provides accountability to an individual. Root access via telnet is controlled via the tty settings in the /etc/securetty file.</cdf:description>
<scm:violationMessage>Restrict Telnet Root login: {1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, RTRIM('/etc/securetty does not exist or is empty, create one and put only local tty names in it')
FROM
jac_data.unix_securetty_v1 a
WHERE
(a.tty_name is null)
UNION
SELECT
a.cli_id, RTRIM('/etc/securetty contains non-local tty: ' || a.tty_name || ', remove that entry')
FROM
jac_data.unix_securetty_v1 a
WHERE
a.tty_name not like 'console'
and a.tty_name not like 'vc/_'
and a.tty_name not like 'vc/__'
and a.tty_name not like 'tty_'
and a.tty_name not like 'tty__'
and a.tty_name not like 'ttyS0'
and a.tty_name not like 'ttysclp0'
and a.tty_name not like 'sclp\_line0' escape '\'
and a.tty_name not like '3270/tty1'
and a.tty_name not like 'hvc_'
and a.tty_name not like 'hvsi_'
and a.tty_name not like 'xvc0'
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
If file "/etc/securetty" does not exist or is empty, create it and put only local tty names in it. If file exists then remove all non-local tty entries from it.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="20">
<cdf:TechSpecsEntriesRef id="119,120,121,122,123,127,128,129,130,131,132,221,222"/>
<cdf:requires idref="PlatformInfoV2">
</cdf:requires>
<cdf:requires idref="GroupsV2">
</cdf:requires>
<cdf:requires idref="FilePermsV2-perms">
</cdf:requires>
<cdf:requires idref="PamV1"></cdf:requires>
<cdf:requires idref="UsersV3"></cdf:requires>
<cdf:requires idref="LoginDefsV1"></cdf:requires>
<cdf:title>Protecting Resources-OSRs/Log File Restrictions</cdf:title>
<cdf:ruleName>Log_File_Restrictions</cdf:ruleName>
<cdf:description>File permissions must be set:
/var/log/wtmp: 755
pam_tally2.so in use: /var/log/tallylog: 600
pam_tally2.so NOT in use: /var/log/faillog: 600
Debian systems: /var/log/syslog: 755, /var/log/auth.log: 750
Non Debian systems: /var/log/messages: 755, /var/log/secure: 750
Note: For all files permissions can be more restrictive. Read Write access for group is allowed if conditions are met: The associated group is identified as having a privileged GID number per section 5.0.2 in coverage document.
Note: Must be owned by privileged ID and Group according to AD.1.8.1.2 and AD.1.8.1.3</cdf:description>
<scm:violationMessage>Invalid Permissions or Ownership for log file: {1};   {2};  owner:  {3};   group:  {4}. For more information see rule description.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>select
distinct a.cli_id, a.file, a.text_permissions, a.owner, a."GROUP"
from
(
select * from jac_data.unix_file_perms_v2 where
(file = '/var/log/wtmp'
or file = '/var/log/syslog'
or file = '/var/log/messages'
or file = '/var/log/tallylog'
or file = '/var/log/faillog'
or file = '/var/log/auth.log'
or file = '/var/log/secure')
and text_permissions like '-%'
) a
left join jac_data.unix_groups_v2 b on a.cli_id = b.cli_id and a."GROUP" = b.group_name
left join jac_data.unix_users_v3 c on a.cli_id = c.cli_id and a.owner = c.username
left join jac_data.sec_platform_infov2 f on a.cli_id = f.cli_id
left join jac_data.linux_login_defs_v1 d on a.cli_id = d.cli_id and (
(d.sys_uid_max is not null and c.uid &gt; d.sys_uid_max)
or
(d.sys_uid_max is null and d.uid_min is not null and c.uid &gt;= d.uid_min)
)
and a.owner not in ($(OSR Excluded Users))
and a.owner not in (
select u.username
from jac_data.unix_users_v3 u
left join jac_data.unix_groups_v2 g on u.cli_id = g.cli_id	and u.gid = g.gid
left join jac_data.unix_group_members_v2 gm on u.cli_id = gm.cli_id	and u.gid = gm.gid
where g.group_name in ($(OSR Excluded Groups)))
left join jac_data.linux_login_defs_v1 dd on a.cli_id = dd.cli_id and (
(dd.sys_gid_max is not null and b.gid &gt; dd.sys_gid_max)
or
(dd.sys_gid_max is null and dd.gid_min is not null and b.gid &gt;= dd.gid_min)
or b.gid = 100
) and a."GROUP" not in ($(OSR Excluded Groups))
left join jac_data.unix_groups_v2 e on a.cli_id = e.cli_id and a."GROUP" = e.group_name
and  (e.gid &lt;= 99
or e.gid &gt;=101 and e.gid &lt;= 199 and lower(f.version) like '%debian%5%'
or e.gid &gt;=101 and e.gid &lt;= 499 and (
lower(f.version) like '%red hat%release 5%' or
lower(f.version) like '%red hat%release 6%' or
lower(f.version) like '%centos%release 5%' or
lower(f.version) like '%centos%release 6%')
or e.gid &gt;=101 and e.gid &lt;= 499 and (
lower(f.version) like 'suse linux enterprise server 10%'
or lower(f.version) like 'suse linux enterprise server 11%'
or lower(f.version) like 'suse linux enterprise server 12%')
or e.gid &gt;=101 and e.gid &lt;= 999 and (
lower(f.version) like '%red hat%release 7%'
or lower(f.version) like '%centos%release 7%')
or e.gid &gt;=101 and e.gid &lt;= 999 and (
lower(f.version) like '%debian%6%'
or lower(f.version) like '%debian%7%'
or lower(f.version) like '%ubuntu%')
)
where
(
(a.file = '/var/log/wtmp'
or (a.file = '/var/log/syslog' and (lower(f.version) like '%debian%' or lower(f.version) like '%ubuntu%'))
or (a.file = '/var/log/messages' and (lower(f.version) not like '%debian%' and lower(f.version) not like '%ubuntu%')))
and (
a.text_permissions not like '________-_%'
or (a.text_permissions not like '_____-____%' and e.cli_id is null)
or d.cli_id is not null or dd.cli_id is not null)
)
or
(
((a.file = '/var/log/tallylog'
and a.cli_id in (select b.cli_id from jac_data.unix_pam_v1 b where b.module_path like '%pam_tally2.so'))
or
(a.file = '/var/log/faillog'
and a.cli_id not in (select b.cli_id from jac_data.unix_pam_v1 b where b.module_path like '%pam_tally2.so')))
and (
a.text_permissions not like '___-__----%'
or (a.text_permissions not like '____--____%' and e.cli_id is null)
or d.cli_id is not null or dd.cli_id is not null)
)
or
(
((a.file = '/var/log/auth.log' and (lower(f.version) like '%debian%' or lower(f.version) like '%ubuntu%'))
or
(a.file = '/var/log/secure' and (lower(f.version) not like '%debian%' and lower(f.version) not like '%ubuntu%')))
and (
a.text_permissions not like '_______---%'
or (a.text_permissions not like '_____-____%' and e.cli_id is null)
or d.cli_id is not null or dd.cli_id is not null)
)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Permissions of log files are checked else set to the required permissions.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="21">
<cdf:TechSpecsEntriesRef id="39,40,44,41,42,43"/>
<cdf:requires idref="PlatformInfoV2"></cdf:requires>
<cdf:requires idref="PamV1"></cdf:requires>
<cdf:requires idref="FilePermsV2-perms"></cdf:requires>
<cdf:title>Logging/Log Files Required</cdf:title>
<cdf:ruleName>Log_Files_Required</cdf:ruleName>
<cdf:description>Reports missing log files: /var/log/wtmp, /var/log/tallylog if pam_tally2.so is in use, /var/log/faillog if pam_tally2.so is NOT in use, /var/log/syslog and /var/log/auth.log only for Debian systems, /var/log/messages and /var/log/secure only for non Debian systems.</cdf:description>
<scm:violationMessage>Required log file missing: {1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>SELECT
distinct a.cli_id, a.file
FROM
jac_data.unix_file_perms_v2 a
left join jac_data.sec_platform_infov2 p on a.cli_id = p.cli_id
WHERE
(a.file_exist = 0 or a.text_permissions is null)
and (
a.file = '/var/log/wtmp'
-- must exist if pam_tally2.so is in use
or (a.file = '/var/log/tallylog'
and a.cli_id in (
select b.cli_id from jac_data.unix_pam_v1 b
where  b.module_path like '%pam_tally2.so'))
-- must exist if pam_tally2.so is NOT in use
or (a.file = '/var/log/faillog'
and a.cli_id not in (
select b.cli_id from jac_data.unix_pam_v1 b
where  b.module_path like '%pam_tally2.so'))
-- Debian and Ubuntu log files
or ((lower(p.version) like '%debian%' or lower(p.version) like '%ubuntu%')
and (a.file = '/var/log/syslog' or a.file = '/var/log/auth.log'))
-- Non Debian log files
or ((lower(p.version) not like '%debian%' and lower(p.version) not like '%ubuntu%')
and (a.file = '/var/log/messages' or a.file = '/var/log/secure'))
)</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
For remediation files are checked whether they are exist or not , if doesnt exist files are created.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="22">
<cdf:TechSpecsEntriesRef id="36,37,38"/>
<cdf:requires idref="RSyslogV1">
</cdf:requires>
<cdf:requires idref="PlatformInfoV2"></cdf:requires>
<cdf:title>Logging/Login Success or Failure in rsyslog.conf</cdf:title>
<cdf:ruleName>Login_Success_or_Failure_in_rsyslog_conf</cdf:ruleName>
<cdf:description>Login Success or Failure Logging Requirements for rsyslog.conf</cdf:description>
<scm:violationMessage>{1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>SELECT DISTINCT z.CLI_ID, RTRIM(INVALID_SETTING)
FROM
(
select distinct a.cli_id, RTRIM('Setting *.info or *.debug missing or invalid for /var/log/messages on Red Hat or SLES') as INVALID_SETTING
from jac_data.unix_rsyslog_v1 a
inner join jac_data.sec_platform_infov2 p on a.cli_id = p.cli_id
where
lower(p.version) not like '%debian%' and lower(p.version) not like '%ubuntu%'
and a.cli_id not in (
select b.cli_id from jac_data.unix_rsyslog_v1 b
where
b.cli_id = a.cli_id
and b.facility = '*'
and (b.priority = 'info' or b.priority = 'debug' or b.except_str like '%*.info%')
and (b.destination = '/var/log/messages' or b.destination = '-/var/log/messages')
)
UNION
select distinct a.cli_id, RTRIM('Setting authpriv.* missing or invalid for /var/log/secure on Red Hat or SLES, or for /var/log/auth.log on Debian') as INVALID_SETTING
from jac_data.unix_rsyslog_v1 a
where
a.cli_id not in (
select b.cli_id from jac_data.unix_rsyslog_v1 b
inner join jac_data.sec_platform_infov2 p on b.cli_id = p.cli_id
where
(( b.facility = 'authpriv' and b.priority = '*' ) or b.except_str like '%authpriv.*%' )
and (
(lower(p.version) not like '%debian%' and lower(p.version) not like '%ubuntu%'
and (b.destination = '/var/log/secure' or b.destination = '-/var/log/secure'))
or
((lower(p.version) like '%debian%' or lower(p.version) like '%ubuntu%')
and (b.destination = '/var/log/auth.log' or b.destination = '-/var/log/auth.log'))
)
)
UNION
select distinct a.cli_id, RTRIM('Setting auth.* missing or invalid for /var/log/auth.log on Debian') as INVALID_SETTING
from jac_data.unix_rsyslog_v1 a
inner join jac_data.sec_platform_infov2 p on a.cli_id = p.cli_id
where
(lower(p.version) like '%debian%' or lower(p.version) like '%ubuntu%')
and a.cli_id not in (
select b.cli_id from jac_data.unix_rsyslog_v1 b
where
b.cli_id = a.cli_id
and (( b.facility = 'auth' and b.priority = '*' ) or b.except_str like '%auth.*%' )
and (b.destination = '/var/log/auth.log' or b.destination = '-/var/log/auth.log')
)
UNION
select distinct a.cli_id, RTRIM('Setting *.* missing or invalid for /var/log/syslog on Debian') as INVALID_SETTING
from jac_data.unix_rsyslog_v1 a
inner join jac_data.sec_platform_infov2 p on a.cli_id = p.cli_id
where
(lower(p.version) like '%debian%' or lower(p.version) like '%ubuntu%')
and a.cli_id not in (
select b.cli_id from jac_data.unix_rsyslog_v1 b
where
b.cli_id = a.cli_id
and (( b.facility = '*' and b.priority = '*' ) or b.except_str like '%*.*%' )
and (b.destination = '/var/log/syslog' or b.destination = '-/var/log/syslog')
)
UNION
select distinct a.cli_id, RTRIM('Setting *.=info;*.=notice;*.=warning; missing or invalid for /var/log/messages on Debian') as INVALID_SETTING
from jac_data.unix_rsyslog_v1 a
inner join jac_data.sec_platform_infov2 p on a.cli_id = p.cli_id
where
(lower(p.version) like '%debian%' or lower(p.version) like '%ubuntu%')
and(
not exists(
select b.cli_id from jac_data.unix_rsyslog_v1 b
where
b.cli_id = a.cli_id
and (( b.facility = '*' and b.priority = '=info' ) or b.except_str like '%*.=info%' )
and (b.destination = '/var/log/messages' or b.destination = '-/var/log/messages')
)
or not exists(
select b.cli_id from jac_data.unix_rsyslog_v1 b
where
b.cli_id = a.cli_id
and (( b.facility = '*' and b.priority = '=notice' ) or b.except_str like '%*.=notice%' )
and (b.destination = '/var/log/messages' or b.destination = '-/var/log/messages')
)
or not exists(
select b.cli_id from jac_data.unix_rsyslog_v1 b
where
b.cli_id = a.cli_id
and (( b.facility = '*' and b.priority = '=warning' ) or b.except_str like '%*.=warning%' )
and (b.destination = '/var/log/messages' or b.destination = '-/var/log/messages')
))
) AS INVALID_CONFIG
INNER JOIN jac_data.unix_rsyslog_v1 z
ON INVALID_CONFIG.CLI_ID=z.CLI_ID
WHERE
z.cli_id in (
select m.cli_id
from jac_data.unix_rsyslog_info_v1 m
where m.running = 1
)</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation on the basis of the requirement: Login Success or Failure Logging Requirements for rsyslog.conf.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="23">
<cdf:TechSpecsEntriesRef id="35"/>
<cdf:requires idref="SyslogngConfV1">
</cdf:requires>
<cdf:requires idref="RSyslogV1">
</cdf:requires>
<cdf:title>Logging/Login Success or Failure in syslog-ng.conf</cdf:title>
<cdf:ruleName>Login_Success_or_Failure_in_syslog_ng_conf</cdf:ruleName>
<cdf:description>Requirements for systems that use syslog-ng: auth and authpriv should be logged to /var/log/secure. See coverage matrix document for more details.</cdf:description>
<scm:violationMessage>{1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, 'Incorrect syslog-ng.conf setting for auth facility. For more information see coverage matrix document.'
FROM
jac_data.unix_syslogng_conf_logs_v1 a
WHERE
a.path is not null
and a.cli_id not in(
select
distinct a.cli_id
from
jac_data.unix_syslogng_conf_logs_v1 a
inner join jac_data.unix_syslogng_conf_src_v1 b on a.cli_id = b.cli_id and a.source = b.name
inner join jac_data.unix_syslogng_conf_dest_v1 c on a.cli_id = c.cli_id and a.destination = c.name
where
a.source = 'src'
and a.filters = 'f_authpriv'
and a.destination = 'authpriv'
and a.facility = 'auth'
and c.parameters = '/var/log/secure')
and a.cli_id not in (
select m.cli_id
from jac_data.unix_rsyslog_info_v1 m
where m.running = 1
)

UNION
SELECT
distinct a.cli_id, 'Incorrect syslog-ng.conf setting for authpriv facility. For more information see coverage matrix document.'
FROM
jac_data.unix_syslogng_conf_logs_v1 a
WHERE
a.path is not null
and a.cli_id not in(
select
distinct a.cli_id
from
jac_data.unix_syslogng_conf_logs_v1 a
inner join jac_data.unix_syslogng_conf_src_v1 b on a.cli_id = b.cli_id and a.source = b.name
inner join jac_data.unix_syslogng_conf_dest_v1 c on a.cli_id = c.cli_id and a.destination = c.name
where
a.source = 'src'
and a.filters = 'f_authpriv'
and a.destination = 'authpriv'
and a.facility = 'authpriv'
and c.parameters = '/var/log/secure')
and a.cli_id not in (
select m.cli_id
from jac_data.unix_rsyslog_info_v1 m
where m.running = 1
)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="true">
<cdf:description>
Remediation marked as NOT TODO.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="24">
<cdf:TechSpecsEntriesRef id="34"/>
<cdf:requires idref="SyslogngConfV1">
</cdf:requires>
<cdf:requires idref="FileSearchv1">
</cdf:requires>
<cdf:requires idref="RSyslogV1">
</cdf:requires>
<cdf:title>Logging/Login Success or Failure in syslog.conf</cdf:title>
<cdf:ruleName>Login_Success_or_Failure_in_syslog_conf</cdf:ruleName>
<cdf:description>Login Success or Failure Logging Requirements for syslog.conf</cdf:description>
<scm:violationMessage>{1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT z.CLI_ID, RTRIM(INVALID_SETTING )
FROM
(
select distinct a.cli_id, RTRIM('/etc/syslog.conf setting *.info or *.debug missing or invalid for /var/log/messages') as INVALID_SETTING
from jac_data.unix_syslogd_conf_v1 a
where a.cli_id not in (
select b.cli_id from jac_data.unix_syslogd_conf_v1 b
where b.facility = '*'
and (b.priority = 'info' or b.priority = 'debug')
and (b.destination_name = '/var/log/messages' or b.destination_name = '-/var/log/messages')
)
UNION
select distinct a.cli_id, RTRIM('/etc/syslog.conf setting mail.none missing or invalid for /var/log/messages') as INVALID_SETTING
from jac_data.unix_syslogd_conf_v1 a
where a.cli_id not in (
select b.cli_id from jac_data.unix_syslogd_conf_v1 b
where b.facility = 'mail'
and b.priority = 'none'
and (b.destination_name = '/var/log/messages' or b.destination_name = '-/var/log/messages')
)
UNION
select distinct a.cli_id, RTRIM('/etc/syslog.conf setting authpriv.none missing or invalid for /var/log/messages') as INVALID_SETTING
from jac_data.unix_syslogd_conf_v1 a
where a.cli_id not in (
select b.cli_id from jac_data.unix_syslogd_conf_v1 b
where b.facility = 'authpriv'
and b.priority = 'none'
and (b.destination_name = '/var/log/messages' or b.destination_name = '-/var/log/messages')
)
UNION
select distinct a.cli_id, RTRIM('/etc/syslog.conf setting cron.none missing or invalid for /var/log/messages') as INVALID_SETTING
from jac_data.unix_syslogd_conf_v1 a
where a.cli_id not in (
select b.cli_id from jac_data.unix_syslogd_conf_v1 b
where b.facility = 'cron'
and b.priority = 'none'
and (b.destination_name = '/var/log/messages' or b.destination_name = '-/var/log/messages')
)
UNION
select distinct a.cli_id, RTRIM('/etc/syslog.conf setting authpriv.* missing or invalid for /var/log/secure') as INVALID_SETTING
from jac_data.unix_syslogd_conf_v1 a
where a.cli_id not in (
select b.cli_id from jac_data.unix_syslogd_conf_v1 b
where b.facility = 'authpriv'
and b.priority = '*'
and (b.destination_name = '/var/log/secure' or b.destination_name = '-/var/log/secure')
)
) AS INVALID_CONFIG
INNER JOIN jac_data.unix_syslogd_conf_v1 z
ON INVALID_CONFIG.CLI_ID=z.CLI_ID
WHERE
z.cli_id not in (
SELECT
e.cli_id
FROM
jac_data.unix_syslogng_conf_logs_v1 e
WHERE
( e.destination is not null
or e.destination &lt;&gt; '' )
and z.cli_id = e.cli_id
)
and z.cli_id not in (
select m.cli_id
from jac_data.unix_file_search_v1 m
where 	m.line like '%destination%secure%file%/var/log/secure%'
and m.filename = '/etc/syslog-ng/syslog-ng.conf'
)
and z.cli_id not in (
select m.cli_id
from jac_data.unix_rsyslog_info_v1 m
where m.running = 1
)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation on the basis of the requirement: Login Success or Failure Logging Requirements for syslog.conf
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="27">
<cdf:TechSpecsEntriesRef id="49"/>
<cdf:requires idref="UsersV3">
</cdf:requires>
<cdf:title>System Settings/Password File Restrictions</cdf:title>
<cdf:ruleName>Password_File_Restrictions</cdf:ruleName>
<cdf:description>UNIX - Protection of password files: /etc/passwd must not contain passwords</cdf:description>
<scm:violationMessage>{1} {2}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, case
when a.is_account_active = 1 then 'Password defined in /etc/passwd'
when (a.is_passwd_empty = 0 or a.is_md5 =0 and a.is_blowfish=0 and a.is_des=0 and a.is_sunmd5=0) then 'Password defined in /etc/passwd'
end,  ' for UserID: ' || a.username
FROM
jac_data.unix_users_v3 a
WHERE
(
a.is_account_active = 1
and (a.is_passwd_empty = 0 or a.is_md5 =0 and a.is_blowfish=0 and a.is_des=0 and a.is_sunmd5=0)
)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="true">
<cdf:description>
Remediation function not implemented yet.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="28">
<cdf:TechSpecsEntriesRef id="48"/>
<cdf:requires idref="FileSearchv1">
</cdf:requires>
<cdf:requires idref="ProcessesV1">
</cdf:requires>
<cdf:requires idref="FtpUsersV1">
</cdf:requires>
<cdf:title>System Settings/Root FTP Access Restriction</cdf:title>
<cdf:ruleName>Root_FTP_Access_Restriction</cdf:ruleName>
<cdf:description>Root Id must exist in file /ETC/FTPUSERS or /etc/vsftpd.ftpusers or /etc/vsftpd/ftpusers to restrict FTP access</cdf:description>
<scm:violationMessage>Root ID must exist in /ETC/FTPUSERS or /ETC/VSFTPD.FTPUSERS or /etc/vsftpd/ftpusers to restrict FTP access</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, 'Root ID not in /ETC/FTPUSERS or /ETC/VSFTPD.FTPUSERS' as "Root Required"
FROM
jac_data.unix_processes_v1 a
inner join jac_data.unix_ftpusers_v1 b on a.cli_id=b.cli_id
WHERE
(( lower(a.command) like '%/ftpd%'
or lower(a.command) like 'ftpd%' )
and a.cli_id not in (
SELECT
z.cli_id
FROM
jac_data.unix_ftpusers_v1 z
WHERE
z.user_name = 'root'
))
or	(( lower(a.command) like '%/vsftpd%'
or lower(a.command) like 'vsftpd%' )
and a.cli_id not in (
SELECT
x.cli_id
FROM
jac_data.unix_file_search_v1 x
WHERE
(x.filename = '/etc/vsftpd.ftpusers' or x.filename = '/etc/vsftpd/ftpusers')
and x.line like '%root%'
))
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation on the basis of the requirement: Root Id must exist in file /ETC/FTPUSERS or /etc/vsftpd.ftpusers to restrict FTP access
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="29">
<cdf:TechSpecsEntriesRef id="47"/>
<cdf:requires idref="PamV1">
</cdf:requires>
<cdf:title>System Settings/\ETC\PAM.D\OTHER Restrictions</cdf:title>
<cdf:ruleName>ETC_PAM_D_OTHER_Restrictions</cdf:ruleName>
<cdf:description>/etc/pam.d/other required parameters: auth required /lib/security/pam_deny.so; account required /lib/security/pam_deny.so</cdf:description>
<scm:violationMessage>Incorrect PAM setting for /etc/pam.d/other required /lib/security/pam_deny.so or /lib/security/$isa/pam_deny.so</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, ' Incorrect PAM setting for /etc/pam.d/other required /lib/security/pam_deny.so or /lib/security/$isa/pam_deny.so' as "INCORRECT PAM SETTING"
FROM
jac_data.unix_pam_v1 a
WHERE
a.cli_id not in (
SELECT
x.cli_id
FROM
jac_data.unix_pam_v1 x
WHERE
( x.service='/etc/pam.d/other'
or exists(
SELECT
'/etc/pam.d/' || y.module_path
FROM
jac_data.unix_pam_v1 y
where
y.is_include = 1
and y.service = '/etc/pam.d/other'
and x.cli_id = y.cli_id
and x.service = '/etc/pam.d/' || y.module_path
)
)
and a.cli_id = x.cli_id
and x.is_auth=1
and x.is_required=1
and x.module_path like '%pam_deny.so'
)
or a.cli_id not in (
SELECT
z.cli_id
FROM
jac_data.unix_pam_v1 z
WHERE
( z.service='/etc/pam.d/other'
or exists (
SELECT
'/etc/pam.d/' || y.module_path
FROM
jac_data.unix_pam_v1 y
where
y.is_include = 1
and y.service = '/etc/pam.d/other'
and z.cli_id = y.cli_id
and z.service = '/etc/pam.d/' || y.module_path
)
)
and a.cli_id = z.cli_id
and z.is_account=1
and z.is_required=1
and z.module_path like '%pam_deny.so'
)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation on the basis of the requirement: /etc/pam.d/other required parameters: auth required /lib/security/pam_deny.so; account required /lib/security/pam_deny.so
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="30">
<cdf:TechSpecsEntriesRef id="116"/>
<cdf:requires idref="FilePermsV2-perms">
</cdf:requires>
<cdf:requires idref="GroupsV2">
</cdf:requires>
<cdf:requires idref="PlatformInfoV2">
</cdf:requires>
<cdf:title>Protecting Resources-OSRs/\ETC\SHADOW Restrictions</cdf:title>
<cdf:ruleName>ETC_SHADOW_Restrictions</cdf:ruleName>
<cdf:description>/etc/shadow fIle File permissions must be set: rw- --- --- (or more restrictive)</cdf:description>
<scm:violationMessage>Invalid permissions for {1}, Owner: {2}, Group: {3}, Permissions: {4}, should be rw- --- --- </scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>SELECT
distinct a.cli_id, a.file as "File", a.owner as "User", a."GROUP" as "Group", a.octal_permissions
FROM
jac_data.unix_file_perms_v2 a
WHERE
a.file like '/etc/shadow'
and a.text_permissions not like '-__-------%'
</scm:sql>
</cdf:check>
<cdf:remediation parameters="0600" disable="false">
<cdf:description>
Remediation on the basis of the requirement: /etc/shadow file contains encrypted passwords and has permission bits set to 0600 or more restrictive.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="34">
<cdf:TechSpecsEntriesRef id="59"/>
<cdf:requires idref="NetstatV1">
</cdf:requires>
<cdf:requires idref="AnonFtpFilePermsV1">
</cdf:requires>
<cdf:title>Network Settings/Access Permissions for Directories Accessible via Anonymous FTP</cdf:title>
<cdf:ruleName>Access_Permissions_for_Directories_Accessible_via_Anonymous_FTP</cdf:ruleName>
<cdf:description>Access permissions for directories accessible via Anonymous FTP. Each directory may allow read access or write access to anonymous users, but not both.</cdf:description>
<scm:violationMessage>Invalid Anon FTP Home Directory Permissions for File : {1}, Owner: {2}, Text Permission: {3}, Octal Permission: {4}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a.file, a.owner, a.text_permissions, a.octal_permissions
FROM
jac_data.unix_anon_ftp_file_perms_v1 a
join jac_data.unix_netstat_v1 b on a.cli_id = b.cli_id
WHERE
b.local_port = '21'
and a.file not in ('/bin', '/lib', '/etc', '/ftp')
and a.text_permissions like 'd%'
and a.text_permissions like '_______rw_%'
and a.text_permissions not like 'l%'
-- addition against multi instance
and a.is_system_file &lt;&gt; 1
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation on the basis of the requirement: Access permissions for directories accessible via Anonymous FTP.
Each directory may allow read access or write access to anonymous users, but not both.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="36">
<cdf:TechSpecsEntriesRef id="54"/>
<cdf:requires idref="UsersV3">
</cdf:requires>
<cdf:requires idref="AnonFtpFilePermsV1">
</cdf:requires>
<cdf:requires idref="NetstatV1">
</cdf:requires>
<cdf:title>Network Settings/Configuration of the BIN Subdirectory of the FTP Account Home Directory</cdf:title>
<cdf:ruleName>Configuration_of_the_BIN_Subdirectory_of_the_FTP_Account_Home_Directory</cdf:ruleName>
<cdf:description>Configuration of the bin subdirectory of the ftp account home directory. Must be owned by root and grant write access only to the owner. Files contained in this directory must have a mode of 0111. More stringent value can be set.</cdf:description>
<scm:violationMessage>Invalid Anon FTP Home Directory Permissions for File : {1}, Owner: {2}, Text Permission: {3}, Octal Permission: {4}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a.file, a.owner, a.text_permissions, a.octal_permissions
FROM
jac_data.unix_anon_ftp_file_perms_v1 a
join jac_data.unix_netstat_v1 b on a.cli_id = b.cli_id
join jac_data.unix_users_v3 u on a.cli_id = u.cli_id
WHERE
(b.local_port = '21'
and a.file = u.home || '/bin'
and a.text_permissions like 'd%'
and (a.text_permissions like '____%w%'
or a.owner not like 'root')
or b.local_port = '21'
and a.file like '%/bin/%'
and a.text_permissions not like 'd%'
and a.text_permissions not like 'l%'
and a.text_permissions not like '---_--_--_%')
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation on the basis of the requirement: Configuration of the bin subdirectory of the ftp account home directory.
Must be owned by root and grant write access only to the owner. Files contained in this directory must have a mode of 0111.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="37">
<cdf:TechSpecsEntriesRef id="56"/>
<cdf:requires idref="UsersV3">
</cdf:requires>
<cdf:requires idref="NetstatV1">
</cdf:requires>
<cdf:requires idref="AnonFtpFilePermsV1">
</cdf:requires>
<cdf:title>Network Settings/Configuration of the ETC Subdirectory of the FTP Account Home Directory</cdf:title>
<cdf:ruleName>Configuration_of_the_ETC_Subdirectory_of_the_FTP_Account_Home_Directory</cdf:ruleName>
<cdf:description>Configuration of the etc subdirectory of the ftp account home directory. Must be owned by root and grant write access only to the owner.</cdf:description>
<scm:violationMessage>Invalid Anon FTP Home Directory Permissions for File : {1}, Owner: {2}, Text Permission: {3}, Octal Permission: {4}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a.file, a.owner, a.text_permissions, a.octal_permissions
FROM
jac_data.unix_anon_ftp_file_perms_v1 a
join jac_data.unix_netstat_v1 b on a.cli_id = b.cli_id
join jac_data.unix_users_v3 u on a.cli_id = u.cli_id
WHERE
(b.local_port = '21'
and a.file = u.home || '/etc'
and a.text_permissions like 'd%'
and (a.text_permissions like '____%w%'
or a.owner not like 'root'))
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation on the basis of the requirement: Configuration of the etc subdirectory of the ftp account home directory. Must be owned by root and grant write access only to the owner.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="38">
<cdf:TechSpecsEntriesRef id="53"/>
<cdf:requires idref="UsersV3">
</cdf:requires>
<cdf:requires idref="AnonFtpFilePermsV1">
</cdf:requires>
<cdf:requires idref="NetstatV1">
</cdf:requires>
<cdf:title>Network Settings/Configuration of the FTP Account Home Directory</cdf:title>
<cdf:ruleName>Configuration_of_the_FTP_Account_Home_Directory</cdf:ruleName>
<cdf:description>Configuration of the ftp account home directory. Must be owned by root and grant write access only to the owner</cdf:description>
<scm:violationMessage>Invalid Anon FTP Home Directory Permissions for File : {1}, Owner: {2}, Text Permission: {3}, Octal Permission: {4}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a.file, a.owner, a.text_permissions, a.octal_permissions
FROM
jac_data.unix_anon_ftp_file_perms_v1 a
join jac_data.unix_netstat_v1 b on a.cli_id = b.cli_id
join jac_data.unix_users_v3 u on a.cli_id = u.cli_id
WHERE
(b.local_port = '21'
and a.file = u.home
and a.text_permissions like 'd%'
and (a.text_permissions like '____%w%'
or a.owner not like 'root'))
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation on the basis of the requirement: Configuration of the ftp account home directory. Must be owned by root and grant write access only to the owner
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="39">
<cdf:TechSpecsEntriesRef id="55"/>
<cdf:requires idref="AnonFtpFilePermsV1">
</cdf:requires>
<cdf:requires idref="NetstatV1">
</cdf:requires>
<cdf:requires idref="UsersV3">
</cdf:requires>
<cdf:title>Network Settings/Configuration of the LIB Subdirectory of the FTP Account Home Directory</cdf:title>
<cdf:ruleName>Configuration_of_the_LIB_Subdirectory_of_the_FTP_Account_Home_Directory</cdf:ruleName>
<cdf:description>Configuration of the lib subdirectory of the ftp account home directory. Must be owned by root and grant write access only to the owner. Files contained in this directory must have a mode of 0555. More stringent value can be set.</cdf:description>
<scm:violationMessage>Invalid Anon FTP Home Directory Permissions for File : {1}, Owner: {2}, Text Permission: {3}, Octal Permission: {4}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a.file, a.owner, a.text_permissions, a.octal_permissions
FROM
jac_data.unix_anon_ftp_file_perms_v1 a
join jac_data.unix_netstat_v1 b on a.cli_id = b.cli_id
join jac_data.unix_users_v3 u on a.cli_id = u.cli_id
WHERE
(b.local_port = '21'
and a.file = u.home || '/lib'
and a.text_permissions like 'd%'
and (a.text_permissions like '____%w%'
or a.owner not like 'root')
or  b.local_port = '21'
and a.file like '%/lib/%'
and a.text_permissions not like 'd%'
and a.text_permissions not like 'l%'
and a.text_permissions not like '-_-__-__-_%')
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation on the basis of the requirement: Configuration of the lib subdirectory of the ftp account home directory.
Must be owned by root and grant write access only to the owner. Files contained in this directory must have a mode of 0555.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="40">
<cdf:TechSpecsEntriesRef id="57"/>
<cdf:requires idref="NetstatV1">
</cdf:requires>
<cdf:requires idref="AnonFtpFilePermsV1">
</cdf:requires>
<cdf:requires idref="GroupsV2">
</cdf:requires>
<cdf:requires idref="UsersV3">
</cdf:requires>
<cdf:title>Network Settings/Configuration of the OTHER Subdirectories of the FTP Account Home Directory</cdf:title>
<cdf:ruleName>Configuration_of_the_OTHER_Subdirectories_of_the_FTP_Account_Home_Directory</cdf:ruleName>
<cdf:description>Configuration of other subdirectories of the ftp account home directory. Must not be owned by a general user account. If write access is granted to the group owner of the file, membership in the group is a security administrative authority. Files and directories must allow only read/execute, write/execute, execute (directories only), or no access for other.</cdf:description>
<scm:violationMessage>Invalid Anon FTP Home Directory Permissions for File : {1}, Owner: {2}, Text Permission: {3}, Octal Permission: {4}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a.file, a.owner, a.text_permissions, a.octal_permissions
FROM
jac_data.unix_anon_ftp_file_perms_v1 a
join jac_data.unix_netstat_v1 b on a.cli_id = b.cli_id
join jac_data.unix_users_v3 u on a.cli_id = u.cli_id
WHERE
-- if anonymous ftp is enabled
b.local_port = '21'
AND u.username = 'ftp'
and a.text_permissions not like 'l%'
-- other files and subdirectories within the ftp account home directory
and a.file not in (u.home || '/bin', u.home || '/lib', u.home || '/etc')
and substr(a.file, 1, length(u.home) + 5) not in (u.home || '/bin/', u.home || '/lib/', u.home || '/etc/')
and a.file &lt;&gt; u.home
-- must not be owned by a general user account
AND
(a.owner IN (
SELECT  e.user_name
FROM jac_data.unix_groups_v2 d
left outer join  jac_data.unix_group_members_v2 e on d.cli_id= e.cli_id and d.gid =e.gid
WHERE  d.group_name in ('users')
and a.cli_id = d.cli_id
)
or  a.text_permissions like '_______rw%' or a.text_permissions like '_______r--%' or a.text_permissions like '_______-w-%')
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
for each directory other than /bin,/etc,/lib:
1) if directory owner is other than 'ftp', then it is changed to 'ftp'
2) write access is checked for group permission of the file, and log message is raised accordingly
3) permission r-x, -wx, --x or --- is acceptable for directories for others(minimum permission i.e ---, is applied if not present)
for each file in ftp_home directory:
3) permission r-x,-wx or --- is acceptable for files for others(minimum permission i.e ---, is applied if not present)
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="42">
<cdf:TechSpecsEntriesRef id="52"/>
<cdf:requires idref="AnonFtpFilePermsV1">
</cdf:requires>
<cdf:requires idref="ProcessesV1">
</cdf:requires>
<cdf:requires idref="NetstatV1">
</cdf:requires>
<cdf:requires idref="InetdV1">
</cdf:requires>
<cdf:requires idref="XinetdV1">
</cdf:requires>
<cdf:title>Network Settings/FTP Deamon Options</cdf:title>
<cdf:ruleName>FTP_Deamon_Options</cdf:ruleName>
<cdf:description>UNIX ftpd daemon options: If any directories will be made writable, the -u option must be used</cdf:description>
<scm:violationMessage>{1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT z.CLI_ID,INVALID1,INVALID2, INVALID_SETTING
FROM
(
SELECT
distinct a.cli_id,'INETD Service: 'as INVALID1,rtrim(b.service) as INVALID2, rtrim(' is missing UMASK setting of -u 027.  Invalid World-Writable Directory/File: ' || c.file || ' Permissions: ' || c.text_permissions ) as INVALID_SETTING
FROM
jac_data.unix_netstat_v1 a
join jac_data.unix_inetd_v1 b on a.cli_id=b.cli_id
inner join jac_data.unix_anon_ftp_file_perms_v1 c on a.cli_id=c.cli_id
WHERE
a.local_port = '21'
and c.text_permissions like '%________w%'
and c.text_permissions not like 'l%'
and lower(b.service) like '%wu-ftpd%'
and b.serverargs not like '%-u 027%'
UNION
SELECT
distinct a.cli_id,'XINETD Service: ' as INVALID1,rtrim(b.service) as INVALID2,rtrim(' is missing UMASK setting of -u 027.  Invalid World-Writable Directory/File: ' || c.file || ' Permissions: ' || c.text_permissions ) as INVALID_SETTING
FROM
jac_data.unix_netstat_v1 a
join jac_data.unix_xinetd_service_v1 b on a.cli_id=b.cli_id
inner join jac_data.unix_anon_ftp_file_perms_v1 c on a.cli_id=c.cli_id
WHERE
a.local_port = '21'
and c.text_permissions like '%________w%'
and c.text_permissions not like 'l%'
and lower(b.service) like '%wu-ftpd%'
and b.attribute = 'SERVER_ARGS'
and b.value not like '%-u 027%'
and c.is_system_file = 1
UNION
SELECT
distinct a.cli_id,'Process Command: ' as INVALID1,rtrim(b.command) as INVALID2,rtrim(' is missing UMASK setting of -u 027.  Invalid World-Writable Directory/File: ' || c.file || ' Permissions: ' || c.text_permissions ) as INVALID_SETTING
FROM
jac_data.unix_netstat_v1 a
join jac_data.unix_processes_v1 b on a.cli_id = b.cli_id
inner join jac_data.unix_anon_ftp_file_perms_v1 c on a.cli_id=c.cli_id
WHERE
a.local_port = '21'
and c.text_permissions like '%________w%'
and c.text_permissions not like 'l%'
and lower(b.command) like '%wu-ftpd%'
and b.command not like '%-u 027%'
and c.is_system_file = 1
) AS INVALID_CONFIG
INNER JOIN jac_data.unix_netstat_v1 z
ON INVALID_CONFIG.CLI_ID=z.CLI_ID
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Following changes are made:
1)Checked all the directories in ftp_home directory for write permission for group and other.
2)If write permission found, ftpd umask is set to 022 using command 'ftpd -u 022'
Violation: "If any directories will be made writable, ftpd daemon options -u must be used"
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="43">
<cdf:TechSpecsEntriesRef id="56"/>
<cdf:requires idref="AnonFtpPasswdV2">
</cdf:requires>
<cdf:title>Network Settings/FTP PASSWD File Restrictions</cdf:title>
<cdf:ruleName>FTP_PASSWD_File_Restrictions</cdf:ruleName>
<cdf:description>If etc subdirectory of the ftp account home directory exists and anonymous ftp is enabled, must be owned by root and grant write access only to the owner. If the directory contains a passwd file, the password fields (field 2) must be empty.</cdf:description>
<scm:violationMessage>User: {1} does not have empty passsword in ~ftp/etc/passwd file.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
a.cli_id, a.user_name
FROM
jac_data.unix_anonftp_pass_v2 a
WHERE
a.is_passwd_empty = 0
or (a.is_md5 =0 and a.is_blowfish=0 and a.is_des=0 and a.is_sunmd5=0)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Changes are made as follows:
1. ftp user home directory extracted from /etc/passwd file, verified users in /ftp_home/etc/passwd file for empty password.
2. If password for any user is empty(or :x:) then no action, else making passwd empty(set to :x:)
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="46">
<cdf:TechSpecsEntriesRef id="62"/>
<cdf:requires idref="FilePermsV2-perms">
</cdf:requires>
<cdf:requires idref="ProcessesV1">
</cdf:requires>
<cdf:title>Network Settings/NFS \ETC\EXPORTS Restrictions_exists</cdf:title>
<cdf:ruleName>NFS_ETC_EXPORTS_Restrictions_exists</cdf:ruleName>
<cdf:description>If NFS server is installed and running, /etc/exports must exist.</cdf:description>
<scm:violationMessage>/etc/exports {1} and NFS is running: {2}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, 'does not exist', a.command
FROM
jac_data.unix_processes_v1 a
WHERE
exists (
SELECT
b.cli_id
from jac_data.unix_file_perms_v2 b
WHERE
file='/etc/exports' and file_exist &lt;&gt; 1
and b.cli_id=a.cli_id )
and a.command like '%nfsd%'
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation done to create the /etc/exports file if NFS server si running
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="47">
<cdf:TechSpecsEntriesRef id="62"/>
<cdf:requires idref="ProcessesV1">
</cdf:requires>
<cdf:requires idref="FilePermsV2-perms">
</cdf:requires>
<cdf:title>Network Settings/NFS \ETC\EXPORTS Restrictions_owner</cdf:title>
<cdf:ruleName>NFS_ETC_EXPORTS_Restrictions_owner</cdf:ruleName>
<cdf:description>If NFS server is installed and running, /etc/exports must be owned by root.</cdf:description>
<scm:violationMessage>/etc/exports has wrong owner: {1} should be root, and NFS is running: {2}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, b.owner, a.command
FROM
jac_data.unix_processes_v1 a
INNER JOIN jac_data.unix_file_perms_v2 b on a.cli_id = b.cli_id
WHERE
b.file='/etc/exports' and (b.owner &lt;&gt; 'root' or b.owner is null)
and a.command like '%nfsd%'
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation done to change the owner of /etc/exports file to root if NFS server is running
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="48">
<cdf:TechSpecsEntriesRef id="62"/>
<cdf:requires idref="FilePermsV2-perms">
</cdf:requires>
<cdf:requires idref="ProcessesV1">
</cdf:requires>
<cdf:title>Network Settings/NFS \ETC\EXPORTS Restrictions_perms</cdf:title>
<cdf:ruleName>NFS_ETC_EXPORTS_Restrictions_perms</cdf:ruleName>
<cdf:description>If NFS server is installed and running, /etc/exports must have 0644 permissions. More stringent value can be set.</cdf:description>
<scm:violationMessage>/etc/exports has wrong permissions: {1} should be 0644, and NFS is running: {2}. More stringent value can be set.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, b.octal_permissions, a.command
FROM
jac_data.unix_processes_v1 a
INNER JOIN jac_data.unix_file_perms_v2 b on a.cli_id = b.cli_id
WHERE
b.file='/etc/exports' and (b.text_permissions not like '-__-_--_--%' or b.text_permissions is null)
and a.command like '%nfsd%'
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation done to change the permissions of file if NFS server is running
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="49">
<cdf:TechSpecsEntriesRef id="102,103"/>
<cdf:requires idref="NisMapsV1">
</cdf:requires>
<cdf:requires idref="FileSearchv1">
</cdf:requires>
<cdf:title>Network Settings/NIS Maps Prohibited</cdf:title>
<cdf:ruleName>NIS_Maps_Prohibited</cdf:ruleName>
<cdf:description>UNIX - NIS maps must not be used to store IBM Confidential data, including user passwords or other authentication credentials in any form. If the NIS passwd maps are used, all encrypted user passwords must be removed from the source file before the maps are generated.</cdf:description>
<scm:violationMessage>NIS Password Maps are Forbidden and are Enabled</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, ' NIS Maps Forbidden: Enabled ' as "NIS Status"
FROM
jac_data.unix_nis_maps_v1 a
WHERE
int(a.is_nis_enabled) = 1
and a.cli_id in (
SELECT
z.cli_id
FROM
jac_data.unix_file_search_v1 z
WHERE
z.filename = '/etc/nsswitch.conf'
and( lower(z.line) like 'password%nis%'
or lower(z.line) like 'shadow%nis%' )
and a.cli_id = z.cli_id
)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
NIS entries having password and shadow are commented to remediate.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="53">
<cdf:TechSpecsEntriesRef id="101"/>
<cdf:requires idref="NisMapsV1">
</cdf:requires>
<cdf:requires idref="ProcessesV1">
</cdf:requires>
<cdf:title>Network Settings/Prohibit NIS YPASSWD</cdf:title>
<cdf:ruleName>Prohibit_NIS_YPASSWD</cdf:ruleName>
<cdf:description>UNIX - Network Information Services (NIS) System Settings (including NIS+ in NIS compatibility mode). If NIS is enabled, yppasswd daemon must be disabled</cdf:description>
<scm:violationMessage>NIS is enabled and yppasswd daemon is running; yppasswd must be disabled when using NIS.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, 'NIS status=' || char(a.is_nis_enabled) as "Exists", ' yppasswd not disabled' as "Enabled"
FROM
jac_data.unix_nis_maps_v1 a
inner join jac_data.unix_processes_v1 b on a.cli_id=b.cli_id
WHERE
int(a.is_nis_enabled) &lt;&gt; 0
and b.command like '%yppasswd%'
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
If NIS(ypbind) service is running then yppasswdd daemon must be disabled
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="54">
<cdf:TechSpecsEntriesRef id="66,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,99,100"/>
<cdf:requires idref="XinetdV1">
</cdf:requires>
<cdf:requires idref="RpcV1">
</cdf:requires>
<cdf:requires idref="ProcessesV1">
</cdf:requires>
<cdf:requires idref="NetstatV1">
</cdf:requires>
<cdf:title>Network Settings/Prohibited Processes</cdf:title>
<cdf:ruleName>Prohibited_Processes</cdf:ruleName>
<cdf:description>Lists clients using prohibited process names or ports.</cdf:description>
<scm:violationMessage>{1} prohibited if not required to support application</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT z.CLI_ID, RTRIM(INVALID_SETTING )
FROM
(
SELECT
distinct a.cli_id, RTRIM('UDP Port ' || a.local_port) as INVALID_SETTING
FROM
jac_data.unix_netstat_v1 a
WHERE
a.local_port in ( $(Prohibited UDP Ports) )
and a.protocol='udp'
UNION
SELECT
distinct a.cli_id, RTRIM('TCP Port ' || a.local_port) as INVALID_SETTING
FROM
jac_data.unix_netstat_v1 a
WHERE
a.local_port in ( $(Prohibited TCP Ports) )
and a.protocol='tcp'
UNION
SELECT
a.cli_id, RTRIM('Process ' || a.command) as INVALID_SETTING
FROM
jac_data.unix_processes_v1 a
WHERE
a.name in ( $(Prohibited Process Names) )
UNION
SELECT
a.cli_id, RTRIM('XINETD Process ' || a.service) as INVALID_SETTING
FROM
jac_data.unix_xinetd_service_v1 a
WHERE
a.service in ( $(Prohibited XINETD Process Names) )
and lower(a.attribute) = 'disable' and lower(a.value) = 'no'
UNION
SELECT
distinct b.cli_id, RTRIM('RPC Process ' || c.service) as INVALID_SETTING
FROM
jac_data.unix_rpc_process_v1 b
inner join jac_data.unix_rpc_alias_v1 c on b.cli_id=c.cli_id
WHERE
b.program_number=c.program_number
and ( c.service in ( $(Prohibited RPC Process Names) )
or c.alias in ( $(Prohibited RPC Process Names) ) )
) AS INVALID_CONFIG
INNER JOIN jac_data.unix_netstat_v1 z
ON INVALID_CONFIG.CLI_ID=z.CLI_ID
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="true">
<cdf:description>
Remediation marked as NOT TODO.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="55">
<cdf:TechSpecsEntriesRef id="94,95"/>
<cdf:requires idref="InetdV1">
</cdf:requires>
<cdf:requires idref="XinetdV1">
</cdf:requires>
<cdf:requires idref="SnmpdV1">
</cdf:requires>
<cdf:requires idref="NetstatV1">
</cdf:requires>
<cdf:title>Network Settings/Prohibited SNMP Community Names</cdf:title>
<cdf:ruleName>Prohibited_SNMP_Community_Names</cdf:ruleName>
<cdf:description>UNIX SNMP community names public and private must not exist</cdf:description>
<scm:violationMessage>SNMP community name {1} prohibited in {2}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT distinct a.cli_id, a.name as "SNMP Name", a.snmp_file
FROM jac_data.unix_snmpd_v1 a
WHERE lower(a.name) in ('public', 'private')
and
( a.cli_id
in ( SELECT distinct b.cli_id
FROM jac_data.unix_inetd_v1 b
WHERE b.service ='snmpd'
and a.cli_id = b.cli_id  )
or a.cli_id
in ( SELECT distinct c.cli_id
FROM jac_data.unix_xinetd_service_v1 c
WHERE c.service ='snmpd'
and a.cli_id = c.cli_id  )
or a.cli_id
in ( SELECT distinct d.cli_id
FROM jac_data.unix_netstat_v1 d
WHERE d.local_port='161' and d.protocol='udp'
and a.cli_id = d.cli_id  )
)
and a.cli_id not in (
select z.cli_id
from
jac_data.unix_xinetd_service_v1 z
where
lower (z.service) like 'snmpd'
and lower(z.attribute) like 'disable'
and lower(z.value) like 'yes'
)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Active SNMP community name lines ending with public or private in file /etc/snmp/snmpd.conf will be commented if not commented already
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="58">
<cdf:TechSpecsEntriesRef id="96,97,98"/>
<cdf:requires idref="SysctlV2">
</cdf:requires>
<cdf:title>Network Settings/TCP Configuration Files Restrictions</cdf:title>
<cdf:ruleName>TCP_Configuration_Files_Restrictions</cdf:ruleName>
<cdf:description>/etc/sysctl.conf file or proc files must contain the following settings: Net.ipv4.tcp_syncookies =1, net.ipv4.icmp_echo_ignore_broadcasts = 1, net.ipv4.conf.all.accept_redirects = 0.  The sysctl -p /etc/sysctl.conf command or reboot is required to apply changes to the file.</cdf:description>
<scm:violationMessage>Incorrect /etc/sysctl.conf or proc files setting for {1}: {2} should be {3}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
a.cli_id, a.attribute, a.numericvalue,
(CASE
WHEN a.attribute='net.ipv4.tcp_syncookies' THEN '1'
WHEN a.attribute='net.ipv4.icmp_echo_ignore_broadcasts' THEN '1'
WHEN a.attribute='net.ipv4.conf.all.accept_redirects' THEN '0'
END)
FROM
jac_data.linux_sysctl_v2 a
WHERE
(a.attribute='net.ipv4.tcp_syncookies' and a.numericvalue &lt;&gt; 1 )
or (a.attribute='net.ipv4.icmp_echo_ignore_broadcasts'and a.numericvalue &lt;&gt; 1 )
or (a.attribute='net.ipv4.conf.all.accept_redirects' and a.numericvalue &lt;&gt; 0 )
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation on the basis of the requirement: /etc/sysctl.conf file or proc files must contain the following settings:
Net.ipv4.tcp_syncookies =1, net.ipv4.icmp_echo_ignore_broadcasts = 1, net.ipv4.conf.all.accept_redirects = 0.
The sysctl -p /etc/sysctl.conf command or reboot is required to apply changes to the file.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="59">
<cdf:TechSpecsEntriesRef id="60"/>
<cdf:requires idref="InetdV1">
</cdf:requires>
<cdf:title>Network Settings/TFTP Required Startup Options_inetd</cdf:title>
<cdf:ruleName>TFTP_Required_Startup_Options_inetd</cdf:ruleName>
<cdf:description>TFTP Required Startup Options: The permitted directory must be specified with the -s parameter to server_args</cdf:description>
<scm:violationMessage>TFTP setup: the permitted directory must be specified with the "-s" parameter in the inetd configuration</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT b.cli_id, b.service
FROM jac_data.unix_inetd_v1 b
WHERE
b.service = 'tftp'
and b.serverargs not like '%' || $(TFTP Startup Options) || '%'
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
For remediation server tags arguments with -s is added in file
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="60">
<cdf:TechSpecsEntriesRef id="60"/>
<cdf:requires idref="XinetdV1">
</cdf:requires>
<cdf:title>Network Settings/TFTP Required Startup Options_xinetd</cdf:title>
<cdf:ruleName>TFTP_Required_Startup_Options_xinetd</cdf:ruleName>
<cdf:description>TFTP Required Startup Options: The permitted directory must be specified with the -s parameter to server_args</cdf:description>
<scm:violationMessage>TFTP setup: the permitted directory must be specified with the "-s" parameter in the xinetd configuration</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
x.cli_id, x.service, x."VALUE", y."VALUE"
FROM
jac_data.unix_xinetd_service_v1 x
inner join jac_data.unix_xinetd_service_v1 y on x.cli_id=y.cli_id
and x.service=y.service
and lower(x.attribute)='disable'
WHERE
lower(y.attribute)='server_args'
and lower(x.service)='tftp'
and lower(x."VALUE")='no'
and y."VALUE" not like '% s %'
and y."VALUE" not like 's %'
and y."VALUE" not like '%-s%'
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
For Remediation server_tags attribute with -s is added.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="62">
<cdf:TechSpecsEntriesRef id="68"/>
<cdf:requires idref="XserverAclV1">
</cdf:requires>
<cdf:title>Network Settings/Xserver Access Control</cdf:title>
<cdf:ruleName>Xserver_Access_Control</cdf:ruleName>
<cdf:description>Must not be disabled via xhost +.</cdf:description>
<scm:violationMessage>XServer is running and Xserver Access Control is disabled; Xserver Access Control must not be disabled</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, 'Invalid XServer ACL Status: Disabled ' as "XServer ACL Status"
FROM
jac_data.unix_xserver_acl_v1 a
WHERE
int(a.x_server_running) = 1
and int(a.acl_enabled) = 0
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="true">
<cdf:description>
Remediation marked as NOT TODO.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="63">
<cdf:TechSpecsEntriesRef id="64"/>
<cdf:requires idref="HostsEquivV1">
</cdf:requires>
<cdf:title>Network Settings/\ETC\HOSTS.EQUIV Prohibited</cdf:title>
<cdf:ruleName>ETC_HOSTS_EQUIV_Prohibited</cdf:ruleName>
<cdf:description>hosts.equiv lists trusted hosts for the programs rlogin, rsh, rcp and the library routine rcmd(). Since it allows any user from a trusted host to login without a password, it should not be used as an access control mechanism.</cdf:description>
<scm:violationMessage>/ETC/HOSTS.EQUIV must not be used as an access control mechanism</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, '/ETC/HOSTS.EQUIV must not be used as an access control mechanism'
FROM
jac_data.unix_hosts_equiv_v1 a
WHERE
a.host is not null
or a."USER" is not null
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
As file /etc/hosts.equiv is used for access control mechanism, there should not be any content in the file. Also file should have 600 permisions by default.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="64">
<cdf:TechSpecsEntriesRef id="65"/>
<cdf:requires idref="PamV1">
</cdf:requires>
<cdf:title>Network Settings/\ETC\PAM.D\RLOGIN Restrictions</cdf:title>
<cdf:ruleName>ETC_PAM_D_RLOGIN_Restrictions</cdf:ruleName>
<cdf:description>If the file /etc/pam.d/rlogin exists and there is a /lib/security/pam_rhosts_auth.so stanza present, the no_hosts_equiv parameter must be present.</cdf:description>
<scm:violationMessage>/etc/pam.d/rlogin must contain a no_hosts_equiv parameter in auth stanza for pam_rhosts_auth.so</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, '/etc/pam.d/rlogin must contain an auth stanza for pam_rhosts_auth.so with a no_hosts_equiv parameter'
FROM
jac_data.unix_pam_v1 a
WHERE
(
a.service = '/etc/pam.d/rlogin'
and a.cli_id not in (
SELECT
z.cli_id
FROM
jac_data.unix_pam_v1 z
WHERE
a.cli_id=z.cli_id
and z.service='/etc/pam.d/rlogin'
and z.is_auth=1
and z.module_path like '%pam\_rhosts\_auth.so' escape '\'
and z.module_arguments like '%no\_hosts\_equiv%' escape '\'
)
and a.cli_id in (
SELECT
x.cli_id
FROM
jac_data.unix_pam_v1 x
WHERE
a.cli_id = x.cli_id
and x.service='/etc/pam.d/rlogin'
and x.module_path like '%pam\_rhosts\_auth.so' escape '\'
)
)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
If /etc/pam.d/rlogin file exists and there is a /lib/security/pam_rhosts_auth.so stanza present, the no_hosts_equiv parameter must be present.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="65">
<cdf:TechSpecsEntriesRef id="65"/>
<cdf:requires idref="PamV1">
</cdf:requires>
<cdf:title>Network Settings/\ETC\PAM.D\RSH Restrictions</cdf:title>
<cdf:ruleName>ETC_PAM_D_RSH_Restrictions</cdf:ruleName>
<cdf:description>If the file /etc/pam.d/rsh exists and there is a /lib/security/pam_rhosts_auth.so stanza present, the no_hosts_equiv parameter must be present.</cdf:description>
<scm:violationMessage>/etc/pam.d/rsh must contain a no_hosts_equiv parameter in auth stanza for pam_rhosts_auth.so</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, '/etc/pam.d/rsh must contain an auth stanza for pam_rhosts_auth.so with a no_hosts_equiv parameter'
FROM
jac_data.unix_pam_v1 a
WHERE
(
a.service = '/etc/pam.d/rsh'
and a.cli_id not in (
SELECT
z.cli_id
FROM
jac_data.unix_pam_v1 z
WHERE
a.cli_id = z.cli_id
and z.service='/etc/pam.d/rsh'
and z.is_auth=1
and z.module_path like '%pam\_rhosts\_auth.so' escape '\'
and z.module_arguments like '%no\_hosts\_equiv%' escape '\'
)
and a.cli_id in (
SELECT
x.cli_id
FROM
jac_data.unix_pam_v1 x
WHERE
x.service='/etc/pam.d/rsh'
and x. module_path like '%pam\_rhosts\_auth.so' escape '\'
)
)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
If /etc/pam.d/rsh file exists and there is a /lib/security/pam_rhosts_auth.so stanza present, the no_hosts_equiv parameter must be present.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="66">
<cdf:TechSpecsEntriesRef id="111"/>
<cdf:requires idref="HomeFsV2">
</cdf:requires>
<cdf:title>Protecting Resources-OSRs/.NETRC Restrictions</cdf:title>
<cdf:ruleName>NETRC_Restrictions</cdf:ruleName>
<cdf:description>.netrc files contain hostnames and (optionally) usernames and password used to access other machines. Subsequently, .netrc should be restricted to the following permissions: for all .netrc files: Read access only by owner, write access only by owner, for /.netrc: Read access only by root, write access only by root</cdf:description>
<scm:violationMessage>Invalid Permissions for File: {1}, Owner: {2}, Text Permissions: {3}, must only be readable or writeable by the owner</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a.file as "File", a.owner as "ACCOUNT", a.text_permissions as "PERMISSIONS"
FROM
jac_data.unix_home_fs_v2 a
WHERE
( a.file like '/.netrc'
or a.file like '/root/.netrc'
or a."USER" = 'root' and a.file like '%.netrc%')
and a.text_permissions not like 'd%'
and a.text_permissions not like 'l%'
and (a.text_permissions not like '____------%'
or  a.owner &lt;&gt; 'root' )
</scm:sql>
</cdf:check>
<cdf:remediation parameters="0600" disable="false">
<cdf:description>
Remediation on the basis of the requirement: .netrc should be restricted to the following permissions: for all .netrc files:
Read access only by owner, write access only by owner, for /.netrc: Read access only by root, write access only by root
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="67">
<cdf:TechSpecsEntriesRef id="110"/>
<cdf:requires idref="HomeFsV2">
</cdf:requires>
<cdf:title>Protecting Resources-OSRs/.RHOSTS Restrictions</cdf:title>
<cdf:ruleName>RHOSTS_Restrictions</cdf:ruleName>
<cdf:description>.rhosts is a file that specifies trusted hosts and users for the programs rlogin, rsh, rcp and the library routine rcmd(). rhosts should be restricted to the following permissions- for all .rhosts files: Read access only by owner, Write access only by owner, for /.rhosts: Read access only by root, Write access only by root</cdf:description>
<scm:violationMessage>Invalid Permissions for File: {1}, Owner: {2}, Text Permissions: {3}, must only be readable or writeable by the owner</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a.file as "File", a.owner as "ACCOUNT", a.text_permissions as "PERMISSIONS"
FROM
jac_data.unix_home_fs_v2 a
WHERE
( a.file like '/.rhosts'
or a.file like '/root/.rhosts'
or a."USER" = 'root' and a.file like '%.rhosts%')
and a.text_permissions not like 'd%'
and a.text_permissions not like 'l%'
and (a.text_permissions not like '____------%'
or  a.owner &lt;&gt; 'root' )
</scm:sql>
</cdf:check>
<cdf:remediation parameters="0600" disable="false">
<cdf:description>
Remediation on the basis of the requirement: rhosts should be restricted to the following permissions- for all
.rhosts files: Read access only by owner, Write access only by owner, for /.rhosts: Read access only by root, Write access only by root
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="68">
<cdf:TechSpecsEntriesRef id="142,145,155,158,223,222,221"/>
<cdf:requires idref="LoginDefsV1"></cdf:requires>
<cdf:requires idref="PlatformInfoV2"></cdf:requires>
<cdf:requires idref="UsersV3"></cdf:requires>
<cdf:requires idref="GroupsV2"></cdf:requires>
<cdf:requires idref="CrontabV2"></cdf:requires>
<cdf:title>Protecting Resources-OSRs/CRON Command Group Permissions</cdf:title>
<cdf:ruleName>CRON_Command_Group_Permissions</cdf:ruleName>
<cdf:description>CRON: /var/spool/cron/root, /var/spool/cron/tabs/root, /etc/crontab, /etc/cron.d/*. Each active entry's file/command/script executed, and all existing directories in its path must have settings for "group"  of r-x or more stringent, if owned by groups considered to be default groups for general users. (users). Active entries must be owned an id/group as identified in section 5.1 'The following system ids and group ids must own OSRs', or id which has Security &amp; System Administrative Authority.</cdf:description>
<scm:violationMessage>{1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>SELECT DISTINCT z.CLI_ID, RTRIM(INVALID_SETTING )
FROM
(
SELECT
distinct a.cli_id, RTRIM('Invalid CRON ACL for command: ' || a.file_path || ', Permissions: ' || a.permission || ', Permissions for Group must be set to r-x or more stringent if owned by group "users".') as INVALID_SETTING
FROM
jac_data.unix_wwep_crontab_v2 a
WHERE
a.permission like '-____w%'
and lower(a."GROUP") in ($(General Users))

UNION
SELECT
distinct x.cli_id, RTRIM('Invalid Group for CRON command: ' || x.file_path || ', Group: ' || bb.group_name || ', GID: ' || rtrim(char(bb.gid)) || ', It must belong to a Group that has SecurityorSystemadministrationauthority.') as INVALID_SETTING
FROM
jac_data.unix_wwep_crontab_v2 x
left join jac_data.unix_groups_v2 bb on x.cli_id = bb.cli_id and x."GROUP" = bb.group_name
-- Case 1: Get cron files with non privileged groups, using sets of privileged groups
left join jac_data.sec_platform_infoV2 f on bb.cli_id = f.cli_id
and bb.gid &gt; 99 and (
(bb.gid &gt; 199 and lower(f.version) like '%debian% 5%')
or
(bb.gid &gt; 499 and (
lower(f.version) like '%red hat%release 5%' or
lower(f.version) like '%red hat%release 6%' or
lower(f.version) like '%centos%release 5%' or
lower(f.version) like '%centos%release 6%'))
or
(bb.gid &gt; 499 and (
lower(f.version) like 'suse linux enterprise server 10%' or
lower(f.version) like 'suse linux enterprise server 11%' or
lower(f.version) like 'suse linux enterprise server 12%'))
or
(bb.gid &gt; 999 and (
lower(f.version) like '%red hat%release 7%' or
lower(f.version) like '%centos%release 7%'))
or
(bb.gid &gt; 999 and (
lower(f.version) like '%debian% 6%' or
lower(f.version) like '%debian% 7%' or
lower(f.version) like '%debian% 8%' or
lower(f.version) like '%ubuntu%'))
or bb.gid = 100
)
-- Case 2: Get cron files with not privileged groups, using SYS_GID_MAX in /etc/login.defs or GID_MIN if SYS_GID_MAX is not set.
left join jac_data.linux_login_defs_v1 e on x.cli_id = e.cli_id and (
(e.sys_gid_max is not null and bb.gid &gt; e.sys_gid_max)
or
(e.sys_gid_max is null and e.gid_min is not null and bb.gid &gt;= e.gid_min)
)
WHERE
(f.cli_id is not null or e.cli_id is not null) and x."GROUP" not in ($(OSR Excluded Groups))

UNION
SELECT
distinct ee.cli_id,  RTRIM('Invalid Owner for CRON command: ' || ee.file_path || ', Owner: ' || ee.owner || ', UID: ' || rtrim(char(cc.uid)) || ', It must belong to Owner that has SecurityorSystemadministrationauthority.') as INVALID_SETTING
FROM
jac_data.unix_wwep_crontab_v2 ee
left join jac_data.unix_users_v3 cc on ee.cli_id = cc.cli_id and ee.owner = cc.username
left join jac_data.linux_login_defs_v1 dd on ee.cli_id = dd.cli_id and (
(dd.sys_uid_max is not null and cc.uid &gt; dd.sys_uid_max)
or
(dd.sys_uid_max is null and dd.uid_min is not null and  cc.uid &gt;= dd.uid_min)
)
WHERE
dd.cli_id is not null
and ee.owner not in ($(OSR Excluded Users))
and ee.owner not in (
select u.username
from jac_data.unix_users_v3 u
left join jac_data.unix_groups_v2 g on u.cli_id = g.cli_id	and u.gid = g.gid
left join jac_data.unix_group_members_v2 gm on u.cli_id = gm.cli_id	and u.gid = gm.gid
where g.group_name in ($(OSR Excluded Groups)))

UNION
SELECT
distinct b.cli_id,  RTRIM('Invalid CRON ACL for command directory: ' ||  b.dir_path || ', Permissions: ' || b.permission || '. Permissions for GROUP must be set to r-x or more stringent if owned by group "users".') as INVALID_SETTING
FROM
jac_data.unix_wwep_crontab_dir_v2 b
WHERE
b.permission like  'd____w%'
and lower(b."GROUP") in ($(General Users))
) AS INVALID_CONFIG
INNER JOIN 	jac_data.unix_wwep_crontab_v2 z
ON INVALID_CONFIG.CLI_ID=z.CLI_ID
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
For all active entries in files /var/spool/cron/root, /var/spool/cron/tabs/root, /etc/crontab, /etc/cron.d/* must have privileged owner and group according to operating system. And group must have r-x or more stringent permissions, if owned by groups considered to be default group(users)
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="69">
<cdf:TechSpecsEntriesRef id="141,144,154,157"/>
<cdf:requires idref="CrontabV2">
</cdf:requires>
<cdf:title>Protecting Resources-OSRs/CRON Command WW Permissions</cdf:title>
<cdf:ruleName>CRON_Command_WW_Permissions</cdf:ruleName>
<cdf:description>CRON: /var/spool/cron/root, /var/spool/cron/tabs/root, /etc/crontab, /etc/cron.d/*. Each active entry's file/command/script to be executed, and all existing directories in its path, must have settings for "other"  of r-x or more stringent.</cdf:description>
<scm:violationMessage>{1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT z.CLI_ID, RTRIM(INVALID_SETTING )
FROM
(
SELECT
distinct a.cli_id, RTRIM('Invalid CRON ACL for command: ' || a.file_path || ', Permissions: ' || a.permission || ', Permissions for OTHER must be set to r-x or more stringent.' ) as INVALID_SETTING
FROM
jac_data.unix_wwep_crontab_v2 a
WHERE
a.permission like  '________w%'
and a.cron_user = 'root'
and a.permission not like 'd%'
and a.permission not like 'l%'
and a.permission not like 's%'
and a.permission not like 'p%'
and a.permission not like 'b%'
and a.permission not like 'c%'
UNION
SELECT
distinct b.cli_id,  RTRIM('Invalid CRON ACL for command directory: ' ||  b.dir_path || ', Permissions: ' || b.permission || '. Permissions for OTHER must be set to r-x or more stringent.') as INVALID_SETTING
FROM
jac_data.unix_wwep_crontab_dir_v2 b
WHERE
b.permission like  '________w%'
and b.cron_user = 'root'
and dir_path not like '/tmp'
and dir_path not like '/tmp/'
and dir_path not like '/var/tmp'
) AS INVALID_CONFIG
INNER JOIN	jac_data.unix_wwep_crontab_v2 z
ON INVALID_CONFIG.CLI_ID=z.CLI_ID
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation on the basis of the requirement: CRON: /var/spool/cron/root, /var/spool/cron/tabs/root, /etc/crontab, /etc/cron.d/*.
Each active entry's file/command/script to be executed, and all existing directories in its path, must have settings for "other"  of r-x or more stringent.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="70">
<cdf:TechSpecsEntriesRef id="140,143,153,156"/>
<cdf:requires idref="CrontabV2">
</cdf:requires>
<cdf:title>Protecting Resources-OSRs/CRON Full Path Restriction</cdf:title>
<cdf:ruleName>CRON_Full_Path_Restriction</cdf:ruleName>
<cdf:description>CRON: /var/spool/cron/root, /var/spool/cron/tabs/root, /etc/crontab, /etc/cron.d/*. Each active entry must specify full path of the file/command/script to be executed.</cdf:description>
<scm:violationMessage>Missing full path: {1}. Full path must be used for commands in CRON.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a.file_path
FROM
jac_data.UNIX_WWEP_CRONTAB_SKIPPED_V2 a
WHERE
a.path not like '/%'
and a.cron_user = 'root'
and (a.file_path is null
or
(a.file_path is not null
and (
(a.path not like 'run-parts')
or
(a.path like 'run-parts'
and a.file_path not like '/usr/bin/run-parts'
and a.file_path not like '/sbin/run-parts'
and a.file_path not like '/bin/run-parts'
and a.file_path not like '/usr/sbin/run-parts')
)))
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation on the basis of the requirement: CRON: /var/spool/cron/root, /var/spool/cron/tabs/root, /etc/crontab, /etc/cron.d/*.
Each active entry must specify full path of the file/command/script to be executed.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="74">
<cdf:TechSpecsEntriesRef id="133,134"/>
<cdf:requires idref="FilePermsV2-perms">
</cdf:requires>
<cdf:requires idref="GroupsV2">
</cdf:requires>
<cdf:requires idref="PlatformInfoV2">
</cdf:requires>
<cdf:title>Protecting Resources-OSRs/IBMsinit Permission Restriction</cdf:title>
<cdf:ruleName>IBMsinit_Permission_Restriction</cdf:ruleName>
<cdf:description>/etc/profile.d/IBMsinit.sh and /etc/profile.d/IBMsinit.csh must have settings for "other"  of r-x. must have settings for "group"  of r-x</cdf:description>
<scm:violationMessage>Invalid permissions for {1}, Owner: {2}, Group: {3}, Permissions: {4} should be for  "other"  of r-x, for "group"  of r-x</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a.file as "File", a.owner as "User", a."GROUP" as "Group", a.text_permissions as "Permissions"
FROM
jac_data.unix_file_perms_v2 a
WHEre
(a.file like '/etc/profile.d/IBMsinit.sh' or  a.file like '/etc/profile.d/IBMsinit.csh')
and a.text_permissions not like  '____r-xr-x%'
and (a.file) not in (
select c.file
from jac_data.unix_groups_v2 b
left outer join jac_data.unix_file_perms_v2 c on b.group_name=c."GROUP"
left outer join jac_data.sec_platform_infoV2 f on b.cli_id = f.cli_id
where ( b.gid &lt;= 99
or b.gid &gt;=101 and b.gid &lt;= 199 and lower(f.version) like '%debian%5%'
or b.gid &gt;=101 and b.gid &lt;= 499 and (
lower(f.version) like '%red hat%release 5%' or
lower(f.version) like '%red hat%release 6%' or
lower(f.version) like '%centos%release 5%' or
lower(f.version) like '%centos%release 6%')
or b.gid &gt;=101 and b.gid &lt;= 499 and(lower(f.version) like 'suse linux enterprise server 9%' or lower(f.version) like 'suse linux enterprise server 10%' or lower(f.version) like 'suse linux enterprise server 11%')
or b.gid &gt;=101 and b.gid &lt;= 999 and (
lower(f.version) like '%red hat%release 7%' or
lower(f.version) like '%centos%release 7%')
or b.gid &gt;=101 and b.gid &lt;= 999 and (lower(f.version) like '%debian%6%' or lower(f.version) like '%debian%7%'  or lower(f.version) like '%ubuntu%')
)
and c.text_permissions like '-___r_xr-x%' )
and
a.file_exist = 1
</scm:sql>
</cdf:check>
<cdf:remediation parameters="rx rx" disable="false">
<cdf:description>
Remediation on the basis of the requirement: /etc/profile.d/IBMsinit.sh and /etc/profile.d/IBMsinit.csh must have settings for "other"  of r-x. must have settings for "group"  of r-x
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="75">
<cdf:TechSpecsEntriesRef id="148,223,222,221"/>
<cdf:requires idref="XInetdV2">
</cdf:requires>
<cdf:requires idref="GroupsV2">
</cdf:requires>
<cdf:requires idref="PlatformInfoV2">
</cdf:requires>
<cdf:requires idref="UsersV3">
</cdf:requires>
<cdf:requires idref="LoginDefsV1">
</cdf:requires>
<cdf:title>Protecting Resources-OSRs/INETD-XINETD Command Group Permissions</cdf:title>
<cdf:ruleName>INETD_XINETD_Command_Group_Permissions</cdf:ruleName>
<cdf:description>/etc/inetd.conf and /etc/xinetd.conf: Each active entry's file/command/script executed, and all existing directories in its path must have settings for "group"  of r-x or more stringent, if owned by groups considered to be default groups for general users. (users). Active entries must be owned an id/group as identified in section 5.1 'The following system ids and group ids must own OSRs', or id which has Security &amp; System Administrative Authority.</cdf:description>
<scm:violationMessage>{1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT z.CLI_ID, RTRIM(INVALID_SETTING )
FROM
(
SELECT
distinct a.cli_id, RTRIM('Invalid XINETD ACL for command: ' || a.file_path || ', Permissions: ' || a.permission || ', Permissions for GROUP must be set to r-x or more stringent if owned by group "users".') as INVALID_SETTING
FROM
jac_data.unix_wwep_xinet_v2 a
WHERE
a.permission like  '-____w%'
and lower(a."GROUP") in ($(General Users))

UNION
SELECT
distinct x.cli_id, RTRIM('Invalid Group for XINETD command: ' || x.file_path || ', Group: ' || bb.group_name || ', GID: ' || rtrim(char(bb.gid)) || ', It must belong to a Group that has SecurityorSystemadministrationauthority.') as INVALID_SETTING
FROM
jac_data.unix_wwep_xinet_v2 x
left join jac_data.unix_groups_v2 bb on x.cli_id = bb.cli_id and x."GROUP" = bb.group_name
left join jac_data.sec_platform_infoV2 f on bb.cli_id = f.cli_id
and bb.gid &gt; 99 and (
(bb.gid &gt; 199 and lower(f.version) like '%debian% 5%')
or
(bb.gid &gt; 499 and (
lower(f.version) like '%red hat%release 5%' or
lower(f.version) like '%red hat%release 6%' or
lower(f.version) like '%centos%release 5%' or
lower(f.version) like '%centos%release 6%'))
or
(bb.gid &gt; 499 and (
lower(f.version) like 'suse linux enterprise server 10%' or
lower(f.version) like 'suse linux enterprise server 11%' or
lower(f.version) like 'suse linux enterprise server 12%'))
or
(bb.gid &gt; 999 and (
lower(f.version) like '%red hat%release 7%' or
lower(f.version) like '%centos%release 7%'))
or
(bb.gid &gt; 999 and (
lower(f.version) like '%debian% 6%' or
lower(f.version) like '%debian% 7%' or
lower(f.version) like '%debian% 8%' or
lower(f.version) like '%ubuntu%'))
or bb.gid = 100
)
left join jac_data.linux_login_defs_v1 e on x.cli_id = e.cli_id and (
(e.sys_gid_max is not null and bb.gid &gt; e.sys_gid_max)
or
(e.sys_gid_max is null and e.gid_min is not null and bb.gid &gt;= e.gid_min)
)
WHERE
(f.cli_id is not null or e.cli_id is not null) and x."GROUP" not in ($(OSR Excluded Groups))

UNION
SELECT
distinct ee.cli_id,  RTRIM('Invalid Owner for XINETD command: ' || ee.file_path || ', Owner: ' || ee.owner || ', UID: ' || rtrim(char(cc.uid)) || ', It must belong to Owner that has SecurityorSystemadministrationauthority.') as INVALID_SETTING
FROM
jac_data.unix_wwep_xinet_v2 ee
left join jac_data.unix_users_v3 cc on ee.cli_id = cc.cli_id and ee.owner = cc.username
left join jac_data.linux_login_defs_v1 dd on ee.cli_id = dd.cli_id and (
(dd.sys_uid_max is not null and cc.uid &gt; dd.sys_uid_max)
or
(dd.sys_uid_max is null and dd.uid_min is not null and  cc.uid &gt;= dd.uid_min)
)
WHERE
dd.cli_id is not null
and ee.owner not in ($(OSR Excluded Users))
and ee.owner not in (
select u.username
from jac_data.unix_users_v3 u
left join jac_data.unix_groups_v2 g on u.cli_id = g.cli_id	and u.gid = g.gid
left join jac_data.unix_group_members_v2 gm on u.cli_id = gm.cli_id	and u.gid = gm.gid
where g.group_name in ($(OSR Excluded Groups)))

UNION
SELECT
distinct b.cli_id,  RTRIM('Invalid XINETD ACL for command directory: ' ||  b.dir_path || ', Permissions: ' || b.permission || '. Permissions for GROUP must be set to r-x or more stringent if owned by group "users".') as INVALID_SETTING
FROM
jac_data.unix_wwep_xinet_dir_v2 b
WHERE
b.permission like  'd____w%'
and lower(b."GROUP") in ($(General Users))
) AS INVALID_CONFIG
INNER JOIN jac_data.unix_wwep_xinet_v2 z
ON INVALID_CONFIG.CLI_ID=z.CLI_ID
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
For all active entries in files /etc/inetd.conf, /etc/xinetd.conf must have privileged owner and group according to operating system. And group must have r-x or more stringent permissions, if owned by groups considered to be default group(users)
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="76">
<cdf:TechSpecsEntriesRef id="147"/>
<cdf:requires idref="XInetdV2">
</cdf:requires>
<cdf:title>Protecting Resources-OSRs/INETD-XINETD Command WW Permissions</cdf:title>
<cdf:ruleName>INETD_XINETD_Command_WW_Permissions</cdf:ruleName>
<cdf:description>/etc/inetd.conf and /etc/xinetd.conf: Each active entry's file/command/script to be executed, and all existing directories in its path, must have settings for "other"  of r-x or more stringent.</cdf:description>
<scm:violationMessage>{1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT z.CLI_ID, RTRIM(INVALID_SETTING )
FROM
(
SELECT
distinct a.cli_id, RTRIM('Invalid XINETD ACL for command: ' || a.file_path || ', Permissions: ' || a.permission || ', Permissions for OTHER must be set to r-x or more stringent.' ) as INVALID_SETTING
FROM
jac_data.unix_wwep_xinet_v2 a
WHERE
a.permission like  '________w%'
and a.permission not like 'd%'
and a.permission not like 'l%'
and a.permission not like 's%'
and a.permission not like 'p%'
and a.permission not like 'b%'
and a.permission not like 'c%'
UNION
SELECT
distinct b.cli_id,  RTRIM('Invalid XINETD ACL for command directory: ' ||  b.dir_path || ', Permissions: ' || b.permission || '. Permissions for OTHER must be set to r-x or more stringent.') as INVALID_SETTING
FROM
jac_data.unix_wwep_xinet_dir_v2 b
WHERE
b.permission like  '________w%'
and dir_path not like '/tmp'
and dir_path not like '/tmp/'
) AS INVALID_CONFIG
INNER JOIN jac_data.unix_wwep_xinet_v2 z
ON INVALID_CONFIG.CLI_ID=z.CLI_ID
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation on the basis of the requirement: /etc/inetd.conf and /etc/xinetd.conf:
Each active entry's file/command/script to be executed, and all existing directories in its path, must have settings for "other"  of r-x or more stringent.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="77">
<cdf:TechSpecsEntriesRef id="146"/>
<cdf:requires idref="XInetdV2">
</cdf:requires>
<cdf:title>Protecting Resources-OSRs/INETD-XINETD Full Path Restriction</cdf:title>
<cdf:ruleName>INETD_XINETD_Full_Path_Restriction</cdf:ruleName>
<cdf:description>/etc/inetd.conf and /etc/xinetd.conf: Each active entry must specify full path of the file/command/script to be executed. This requirement also applies for files in /etc/xinetd.d/ directory if it is set by 'includedir' attribute in main 'xinetd' configuration file.</cdf:description>
<scm:violationMessage>Missing full path: {1}. Full path must be used for commands in {2}.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct skip.cli_id, skip.path, skip.config_file_path
FROM
jac_data.unix_wwep_xinet_skipped_v2 skip
WHERE
skip.path not like '/%' and skip.path not like 'internal'
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation on the basis of the requirement: /etc/inetd.conf and /etc/xinetd.conf: Each active entry must specify full path of the file/command/script to be executed.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="80">
<cdf:TechSpecsEntriesRef id="150,152,223,222,221"/>
<cdf:requires idref="GroupsV2">
</cdf:requires>
<cdf:requires idref="InitdV2">
</cdf:requires>
<cdf:requires idref="UsersV3">
</cdf:requires>
<cdf:requires idref="PlatformInfoV2">
</cdf:requires>
<cdf:requires idref="LoginDefsV1">
</cdf:requires>
<cdf:title>Protecting Resources-OSRs/INITD Command Group Permissions</cdf:title>
<cdf:ruleName>INITD_Command_Group_Permissions</cdf:ruleName>
<cdf:description>/etc/init.d/ -or /etc/rc.d/ directory structure. Each active entry's file/command/script executed, and all existing directories in its path must have settings for "group"  of r-x or more stringent, if owned by groups considered to be default groups for general users. (users). Active entries must be owned an id/group as identified in section 5.1 'The following system ids and group ids must own OSRs', or id which has Security &amp; System Administrative Authority.</cdf:description>
<scm:violationMessage>{1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT z.CLI_ID, RTRIM(INVALID_SETTING )
FROM
(
SELECT
distinct a.cli_id, RTRIM('Invalid /etc/init.d Command ACL for command: ' || a.file_path  || ', Permissions: ' || a.permission || ', Permissions for GROUP must be set to r-x or more stringent if owned by group "users".' ) as INVALID_SETTING
FROM
jac_data.unix_wwep_init_file_perms_v2 a
WHERE
a.permission like  '-____w%'
and lower(a."GROUP") in ($(General Users))

UNION
SELECT
distinct x.cli_id, RTRIM('Invalid Group for /etc/init.d command: ' || x.file_path || ', Group: ' || bb.group_name || ', GID: ' || rtrim(char(bb.gid)) || ', It must belong to a Group that has SecurityorSystemadministrationauthority.') as INVALID_SETTING
FROM
jac_data.unix_wwep_init_file_perms_v2 x
left join jac_data.unix_groups_v2 bb on x.cli_id = bb.cli_id and x."GROUP" = bb.group_name
left join jac_data.sec_platform_infoV2 f on bb.cli_id = f.cli_id
and bb.gid &gt; 99 and (
(bb.gid &gt; 199 and lower(f.version) like '%debian% 5%')
or
(bb.gid &gt; 499 and (
lower(f.version) like '%red hat%release 5%' or
lower(f.version) like '%red hat%release 6%' or
lower(f.version) like '%centos%release 5%' or
lower(f.version) like '%centos%release 6%'))
or
(bb.gid &gt; 499 and (
lower(f.version) like 'suse linux enterprise server 10%' or
lower(f.version) like 'suse linux enterprise server 11%' or
lower(f.version) like 'suse linux enterprise server 12%'))
or
(bb.gid &gt; 999 and (
lower(f.version) like '%red hat%release 7%' or
lower(f.version) like '%centos%release 7%'))
or
(bb.gid &gt; 999 and (
lower(f.version) like '%debian% 6%' or
lower(f.version) like '%debian% 7%' or
lower(f.version) like '%debian% 8%' or
lower(f.version) like '%ubuntu%'))
or bb.gid = 100
)
left join jac_data.linux_login_defs_v1 e on x.cli_id = e.cli_id and (
(e.sys_gid_max is not null and bb.gid &gt; e.sys_gid_max)
or
(e.sys_gid_max is null and e.gid_min is not null and bb.gid &gt;= e.gid_min)
)
WHERE
(f.cli_id is not null or e.cli_id is not null) and x."GROUP" not in ($(OSR Excluded Groups))

UNION
SELECT
distinct ee.cli_id,  RTRIM('Invalid Owner for /etc/init.d command: ' || ee.file_path || ', Owner: ' || ee.owner || ', UID: ' || rtrim(char(cc.uid)) || ', It must belong to Owner that has SecurityorSystemadministrationauthority.') as INVALID_SETTING
FROM
jac_data.unix_wwep_init_file_perms_v2 ee
left join jac_data.unix_users_v3 cc on ee.cli_id = cc.cli_id and ee.owner = cc.username
left join jac_data.linux_login_defs_v1 dd on ee.cli_id = dd.cli_id and (
(dd.sys_uid_max is not null and cc.uid &gt; dd.sys_uid_max)
or
(dd.sys_uid_max is null and dd.uid_min is not null and  cc.uid &gt;= dd.uid_min)
)
WHERE
dd.cli_id is not null
and ee.owner not in ($(OSR Excluded Users))
and ee.owner not in (
select u.username
from jac_data.unix_users_v3 u
left join jac_data.unix_groups_v2 g on u.cli_id = g.cli_id	and u.gid = g.gid
left join jac_data.unix_group_members_v2 gm on u.cli_id = gm.cli_id	and u.gid = gm.gid
where g.group_name in ($(OSR Excluded Groups)))

UNION
SELECT
distinct b.cli_id,  RTRIM('Invalid /etc/init.d Command ACL for command directory: ' ||  b.dir_path || ', Permissions: ' || b.permission || ', Permissions for GROUP must be set to r-x or more stringent if owned by group "users".') as INVALID_SETTING
FROM
jac_data.unix_wwep_init_dir_v2 b
WHERE
b.permission like  'd____w%'
and lower(b."GROUP") in ($(General Users))
) AS INVALID_CONFIG
INNER JOIN jac_data.unix_wwep_init_file_perms_v2 z
ON INVALID_CONFIG.CLI_ID=z.CLI_ID
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
For all active entries in directories /etc/init.d /etc/rc.d must have privileged owner and group according to operating system. And group must have r-x or more stringent permissions, if owned by groups considered to be default group(users)
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="81">
<cdf:TechSpecsEntriesRef id="149,151"/>
<cdf:requires idref="InitdV2">
</cdf:requires>
<cdf:title>Protecting Resources-OSRs/INITD Command WW Permissions</cdf:title>
<cdf:ruleName>INITD_Command_WW_Permissions</cdf:ruleName>
<cdf:description>/etc/init.d/ -or /etc/rc.d/ directory structure. Each active entry's file/command/script to be executed, and all existing directories in its path, must have settings for "other"  of r-x or more stringent.</cdf:description>
<scm:violationMessage>{1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT z.CLI_ID, RTRIM(INVALID_SETTING )
FROM
(
SELECT
distinct a.cli_id, RTRIM('Invalid /etc/init.d Command ACL for command: ' || a.file_path  || ', Permissions: ' || a.permission || ', Permissions for OTHER must be set to r-x or more stringent.' ) as INVALID_SETTING
FROM
jac_data.unix_wwep_init_file_perms_v2 a
WHERE
a.permission like  '________w%'
and a.permission not like 'd%'
and a.permission not like 'l%'
and a.permission not like 's%'
and a.permission not like 'p%'
and a.permission not like 'b%'
and a.permission not like 'c%'
UNION
SELECT
distinct b.cli_id,  RTRIM('Invalid /etc/init.d Command ACL for command directory: ' ||  b.dir_path || ', Permissions: ' || b.permission || '. Permissions for OTHER must be set to r-x or more stringent.') as INVALID_SETTING
FROM
jac_data.unix_wwep_init_dir_v2 b
WHERE
b.permission like  '________w%'
and dir_path not like '/tmp'
and dir_path not like '/tmp/'
) AS INVALID_CONFIG
INNER JOIN jac_data.unix_wwep_init_file_perms_v2 z
ON INVALID_CONFIG.CLI_ID=z.CLI_ID
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation on the basis of the requirement: /etc/init.d/ -or /etc/rc.d/ directory structure.
Each active entry's file/command/script to be executed, and all existing directories in its path, must have settings for "other"  of r-x or more stringent.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="84">
<cdf:TechSpecsEntriesRef id="139,223,222,221"/>
<cdf:requires idref="GroupsV2">
</cdf:requires>
<cdf:requires idref="UsersV3">
</cdf:requires>
<cdf:requires idref="LoginDefsV1">
</cdf:requires>
<cdf:requires idref="InittabV2">
</cdf:requires>
<cdf:requires idref="PlatformInfoV2">
</cdf:requires>
<cdf:title>Protecting Resources-OSRs/INITTAB Command Group Permissions</cdf:title>
<cdf:ruleName>INITTAB_Command_Group_Permissions</cdf:ruleName>
<cdf:description>/etc/inittab: Each active entry's file/command/script executed, and all existing directories in its path must have settings for "group"  of r-x or more stringent, if owned by groups considered to be default groups for general users. (users). Active entries must be owned an id/group as identified in section 5.1 'The following system ids and group ids must own OSRs', or id which has Security &amp; System Administrative Authority.</cdf:description>
<scm:violationMessage>{1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT z.CLI_ID, RTRIM(INVALID_SETTING )
FROM
(
SELECT
distinct a.cli_id, RTRIM('Invalid INITTAB ACL for command: ' || a.file_path || ', Permissions: ' || a.permission || ', Permissions for GROUP must be set to r-x or more stringent if owned by group "users".') as INVALID_SETTING
FROM
jac_data.unix_wwep_inittab_v2 a
WHERE
a.permission like  '-____w%'
and lower(a."GROUP") in ($(General Users))

UNION
SELECT
distinct x.cli_id, RTRIM('Invalid Group for INITTAB command: ' || x.file_path || ', Group: ' || bb.group_name || ', GID: ' || rtrim(char(bb.gid)) || ', It must belong to a Group that has SecurityorSystemadministrationauthority.') as INVALID_SETTING
FROM
jac_data.unix_wwep_inittab_v2 x
left join jac_data.unix_groups_v2 bb on x.cli_id = bb.cli_id and x."GROUP" = bb.group_name
left join jac_data.sec_platform_infoV2 f on bb.cli_id = f.cli_id
and bb.gid &gt; 99 and (
(bb.gid &gt; 199 and lower(f.version) like '%debian% 5%')
or
(bb.gid &gt; 499 and (
lower(f.version) like '%red hat%release 5%' or
lower(f.version) like '%red hat%release 6%' or
lower(f.version) like '%centos%release 5%' or
lower(f.version) like '%centos%release 6%'))
or
(bb.gid &gt; 499 and (
lower(f.version) like 'suse linux enterprise server 10%' or
lower(f.version) like 'suse linux enterprise server 11%' or
lower(f.version) like 'suse linux enterprise server 12%'))
or
(bb.gid &gt; 999 and (
lower(f.version) like '%red hat%release 7%' or
lower(f.version) like '%centos%release 7%'))
or
(bb.gid &gt; 999 and (
lower(f.version) like '%debian% 6%' or
lower(f.version) like '%debian% 7%' or
lower(f.version) like '%debian% 8%' or
lower(f.version) like '%ubuntu%'))
or bb.gid = 100
)
left join jac_data.linux_login_defs_v1 e on x.cli_id = e.cli_id and (
(e.sys_gid_max is not null and bb.gid &gt; e.sys_gid_max)
or
(e.sys_gid_max is null and e.gid_min is not null and bb.gid &gt;= e.gid_min)
)
WHERE
(f.cli_id is not null or e.cli_id is not null) and x."GROUP" not in ($(OSR Excluded Groups))

UNION
SELECT
distinct ee.cli_id,  RTRIM('Invalid Owner for INITTAB command: ' || ee.file_path || ', Owner: ' || ee.owner || ', UID: ' || rtrim(char(cc.uid)) || ', It must belong to Owner that has SecurityorSystemadministrationauthority.') as INVALID_SETTING
FROM
jac_data.unix_wwep_inittab_v2 ee
left join jac_data.unix_users_v3 cc on ee.cli_id = cc.cli_id and ee.owner = cc.username
left join jac_data.linux_login_defs_v1 dd on ee.cli_id = dd.cli_id and (
(dd.sys_uid_max is not null and cc.uid &gt; dd.sys_uid_max)
or
(dd.sys_uid_max is null and dd.uid_min is not null and  cc.uid &gt;= dd.uid_min)
)
WHERE
dd.cli_id is not null
and ee.owner not in ($(OSR Excluded Users))
and ee.owner not in (
select u.username
from jac_data.unix_users_v3 u
left join jac_data.unix_groups_v2 g on u.cli_id = g.cli_id	and u.gid = g.gid
left join jac_data.unix_group_members_v2 gm on u.cli_id = gm.cli_id	and u.gid = gm.gid
where g.group_name in ($(OSR Excluded Groups)))

UNION
SELECT
distinct b.cli_id,  RTRIM('Invalid INITTAB ACL for command directory: ' ||  b.dir_path || ', Permissions: ' || b.permission || ', Permissions for GROUP must be set to r-x or more stringent if owned by group "users".') as INVALID_SETTING
FROM
jac_data.unix_wwep_inittab_dir_v2 b
WHERE
b.permission like  'd____w%'
and lower(b."GROUP") in ($(General Users))
) AS INVALID_CONFIG
INNER JOIN jac_data.unix_wwep_inittab_v2 z
ON INVALID_CONFIG.CLI_ID=z.CLI_ID
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
For all active entries in file /etc/inittab must have privileged owner and group according to operating system. And group must have r-x or more stringent permissions, if owned by groups considered to be default group(users)
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="85">
<cdf:TechSpecsEntriesRef id="138"/>
<cdf:requires idref="InittabV2">
</cdf:requires>
<cdf:title>Protecting Resources-OSRs/INITTAB Command WW Permissions</cdf:title>
<cdf:ruleName>INITTAB_Command_WW_Permissions</cdf:ruleName>
<cdf:description>/etc/inittab: Each active entry's file/command/script to be executed, and all existing directories in its path, must have settings for "other"  of r-x or more stringent.</cdf:description>
<scm:violationMessage>{1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT z.CLI_ID, RTRIM(INVALID_SETTING )
FROM
(
SELECT
distinct a.cli_id, RTRIM('Invalid INITTAB ACL for command: ' || a.file_path || ', Permissions: ' || a.permission || ', Permissions for OTHER must be set to r-x or more stringent.' ) as INVALID_SETTING
FROM
jac_data.unix_wwep_inittab_v2 a
WHERE
a.permission like  '________w%'
and a.permission not like 'd%'
and a.permission not like 'l%'
and a.permission not like 's%'
and a.permission not like 'p%'
and a.permission not like 'b%'
and a.permission not like 'c%'
UNION
SELECT
distinct b.cli_id,  RTRIM('Invalid INITTAB ACL for command directory: ' ||  b.dir_path || ', Permissions: ' || b.permission || '. Permissions for OTHER must be set to r-x or more stringent.') as INVALID_SETTING
FROM
jac_data.unix_wwep_inittab_dir_v2 b
WHERE
b.permission like  '________w%'
and dir_path not like '/tmp'
and dir_path not like '/tmp/'
) AS INVALID_CONFIG
INNER JOIN jac_data.unix_wwep_inittab_v2 z
ON INVALID_CONFIG.CLI_ID=z.CLI_ID
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation on the basis of the requirement: /etc/inittab: Each active entry's file/command/script to be executed,
and all existing directories in its path, must have settings for "other"  of r-x or more stringent.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="86">
<cdf:TechSpecsEntriesRef id="137"/>
<cdf:requires idref="InittabV2">
</cdf:requires>
<cdf:title>Protecting Resources-OSRs/INITTAB Full Path Restriction</cdf:title>
<cdf:ruleName>INITTAB_Full_Path_Restriction</cdf:ruleName>
<cdf:description>/etc/inittab: Each active entry must specify full path of the file/command/script to be executed.</cdf:description>
<scm:violationMessage>Missing full path: {1}. Full path must be used for commands in /etc/inittab.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a.file_path
FROM
jac_data.unix_wwep_inittab_v2 a
WHERE
a.file_path not like '/%'
UNION
SELECT
distinct skip.cli_id, skip.path
FROM
jac_data.unix_wwep_inittab_skipped_v2 skip
WHERE
skip.path not like '/%'
and skip.not_founded =1
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation on the basis of the requirement: /etc/inittab: Each active entry must specify full path of the file/command/script to be executed.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="89">
<cdf:TechSpecsEntriesRef id="112,117"/>
<cdf:requires idref="FilePermsV2-perms"></cdf:requires>
<cdf:requires idref="GroupsV2"></cdf:requires>
<cdf:requires idref="UsersV3"></cdf:requires>
<cdf:requires idref="LoginDefsV1"></cdf:requires>
<cdf:title>Protecting Resources-OSRs/OSR Directory Restrictions</cdf:title>
<cdf:ruleName>OSR_Directory_Restrictions</cdf:ruleName>
<cdf:description>UNIX OSR directory - Settings for other on this directory must be r-x or more stringent. /var, /.</cdf:description>
<scm:violationMessage>{1} {2}, Owner: {3}, Group: {4}, Permissions: {5}, Settings for other must be r-x or more stringent. Must be owned by privileged Owner and Group</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>SELECT
distinct a.cli_id,
case when d.cli_id is not null
then
case when a.text_permissions not like '________-_%'
then 'OSR Invalid Permissions and Invalid Owner or Group:'
else 'OSR Invalid Owner or Group:'
end
else 'OSR Invalid Permissions:'
end, a.file as "File", a.owner as "User", a."GROUP" as "Group", a.text_permissions as "Permissions"
FROM
jac_data.unix_file_perms_v2 a
left join jac_data.unix_groups_v2 b on a.cli_id = b.cli_id and a."GROUP" = b.group_name
left join jac_data.unix_users_v3 c on a.cli_id = c.cli_id and a.owner = c.username
left join jac_data.linux_login_defs_v1 d on a.cli_id = d.cli_id and (
(d.sys_uid_max is not null and c.uid &gt; d.sys_uid_max)
or
(d.sys_uid_max is null and d.uid_min is not null and c.uid &gt;= d.uid_min)
)
left join jac_data.linux_login_defs_v1 dd on a.cli_id = dd.cli_id and (
(dd.sys_gid_max is not null and b.gid &gt; dd.sys_gid_max)
or
(dd.sys_gid_max is null and dd.gid_min is not null and b.gid &gt;= dd.gid_min)
or b.gid = 100
)
WHERE
a.text_permissions is not null
and a.text_permissions not like 'l%'
and a.text_permissions not like 's%'
and a.text_permissions not like 'p%'
and a.text_permissions not like 'b%'
and a.text_permissions not like 'c%'
and (a.file = '/' or a.file = '/var')
and (
a.text_permissions not like '________-_%'
or
(dd.cli_id is not null and a."GROUP" not in ($(OSR Excluded Groups)))
or
(d.cli_id is not null
and a.owner not in ($(OSR Excluded Users))
and a.owner not in (
select u.username
from jac_data.unix_users_v3 u
left join jac_data.unix_groups_v2 g on u.cli_id = g.cli_id	and u.gid = g.gid
left join jac_data.unix_group_members_v2 gm on u.cli_id = gm.cli_id	and u.gid = gm.gid
where g.group_name in ($(OSR Excluded Groups))))
)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="rx /var /" disable="false">
<cdf:description>
Remediation on the basis of the requirement: UNIX OSR directory - Settings for other on this directory must be r-x or more stringent for /var, /.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="90">
<cdf:TechSpecsEntriesRef id="161"/>
<cdf:requires idref="FilePermsV2-dir_perms">
</cdf:requires>
<cdf:title>Protecting Resources-OSRs/OSR USR\LOCAL Files Restrictions</cdf:title>
<cdf:ruleName>OSR_USR_LOCAL_Files_Restrictions</cdf:ruleName>
<cdf:description>Files in /usr/local and its subdirectories may not have both the other-write and any execute permissions set. Note: directories (d), socket (s), named pipe (p), block special file (b), character special file (c), and symbolic link (l) files are excluded from this requirement.</cdf:description>
<scm:violationMessage>Invalid permissions for {1}, Octal permissions: {2}, Text Permissions: {3};  May not have execute permissions on any files and no write for others.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a.file as "File", a.octal_permissions as " Octal Permissions", a.text_permissions as "Text Permissions"
FROM
jac_data.unix_file_perms_v2 a
WHERE
a.file like '/usr/local/%'
and a.text_permissions not like 'd%'
and a.text_permissions not like 's%'
and a.text_permissions not like 'b%'
and a.text_permissions not like 'c%'
and a.text_permissions not like 'l%'
and a.text_permissions like '________w%'
and ( a.text_permissions like '%x%'
or a.text_permissions like '%s%'
or a.text_permissions like '%t' )
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation on the basis of the requirement: Files in /usr/local and its subdirectories may not have both the other-write and any execute permissions set.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="91">
<cdf:TechSpecsEntriesRef id="159"/>
<cdf:requires idref="FilePermsV2-dir_perms">
</cdf:requires>
<cdf:title>Protecting Resources-OSRs/OSR \OPT Files Restrictions</cdf:title>
<cdf:ruleName>OSR_OPT_Files_Restrictions</cdf:ruleName>
<cdf:description>Files /opt and its subdirectories not have both the other-write and any execute permissions set. Note: directories (d), socket (s), named pipe (p), block special file (b), character special file (c), and symbolic link (l) files are excluded from this requirement.</cdf:description>
<scm:violationMessage>Invalid permissions for {1}, Octal permissions: {2}, Text Permissions: {3};  May not have execute permissions on any files and no write for others.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a.file as "File", a.octal_permissions as " Octal Permissions", a.text_permissions as "Text Permissions"
FROM
jac_data.unix_file_perms_v2 a
WHERE
a.file like '/opt/%'
and a.text_permissions not like 'd%'
and a.text_permissions not like 's%'
and a.text_permissions not like 'b%'
and a.text_permissions not like 'c%'
and a.text_permissions not like 'l%'
and a.text_permissions like '________w%'
and ( a.text_permissions like '%x%'
or a.text_permissions like '%s%'
or a.text_permissions like '%t' )
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation on the basis of the requirement: Files /opt and its subdirectories not have both the other-write and any execute permissions set.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="92">
<cdf:TechSpecsEntriesRef id="124,126,222,221"/>
<cdf:requires idref="GroupsV2"></cdf:requires>
<cdf:requires idref="UsersV3"></cdf:requires>
<cdf:requires idref="LoginDefsV1"></cdf:requires>
<cdf:requires idref="FilePermsV2-perms"></cdf:requires>
<cdf:title>Protecting Resources-OSRs/OSR \TMP Directory Restrictions</cdf:title>
<cdf:ruleName>OSR_TMP_Directory_Restrictions</cdf:ruleName>
<cdf:description>UNIX OSR /tmp, /var/tmp directories - Settings for this directories must be rwxrwxrwt(1777). More stringent value can be set. Must be owned by privileged Owner and Group.</cdf:description>
<scm:violationMessage>{1} {2}, Owner: {3}, Group: {4}, Permissions: {5}, Settings for this directory must be rwxrwxrwt(1777) and Must be owned by privileged Owner and Group</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>SELECT
distinct a.cli_id,
case when d.cli_id is not null
then
case when a.text_permissions not like '_________t%'
then 'OSR Invalid Permissions and Invalid Owner or Group:'
else 'OSR Invalid Owner or Group:'
end
else 'OSR Invalid Permissions:'
end, a.file as "File", a.owner as "User", a."GROUP" as "Group", a.text_permissions as "Permissions"
FROM
jac_data.unix_file_perms_v2 a
left join jac_data.unix_groups_v2 b on a.cli_id = b.cli_id and a."GROUP" = b.group_name
left join jac_data.unix_users_v3 c on a.cli_id = c.cli_id and a.owner = c.username
left join jac_data.linux_login_defs_v1 d on a.cli_id = d.cli_id and (
(d.sys_uid_max is not null and c.uid &gt; d.sys_uid_max)
or
(d.sys_uid_max is null and d.uid_min is not null and c.uid &gt;= d.uid_min)
)
left join jac_data.linux_login_defs_v1 dd on a.cli_id = dd.cli_id and (
(dd.sys_gid_max is not null and b.gid &gt; dd.sys_gid_max)
or
(dd.sys_gid_max is null and dd.gid_min is not null and b.gid &gt;= dd.gid_min)
or b.gid = 100
)
WHERE
a.text_permissions is not null
and a.text_permissions like 'd%'
and (a.file = '/tmp' or a.file = '/var/tmp')
and (lower(a.text_permissions) not like '_________t%'
or
(dd.cli_id is not null and a."GROUP" not in ($(OSR Excluded Groups)))
or
(d.cli_id is not null
and a.owner not in ($(OSR Excluded Users))
and a.owner not in (
select u.username
from jac_data.unix_users_v3 u
left join jac_data.unix_groups_v2 g on u.cli_id = g.cli_id	and u.gid = g.gid
left join jac_data.unix_group_members_v2 gm on u.cli_id = gm.cli_id	and u.gid = gm.gid
where g.group_name in ($(OSR Excluded Groups))))
)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="01777" disable="false">
<cdf:description>
Remediation on the basis of the requirement: UNIX OSR /tmp directory - Settings for this directory must be rwxrwxrwt(1777)
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="93">
<cdf:TechSpecsEntriesRef id="162"/>
<cdf:requires idref="FilePermsV2-dir_perms">
</cdf:requires>
<cdf:title>Protecting Resources-OSRs/OSR \TMP Files Restrictions</cdf:title>
<cdf:ruleName>OSR_TMP_Files_Restrictions</cdf:ruleName>
<cdf:description>Files in /tmp and its subdirectories may not have both the other-write and any execute permissions set. Note: directories (d), socket (s), named pipe (p), block special file (b), character special file (c), and symbolic link (l) files are excluded from this requirement.</cdf:description>
<scm:violationMessage>Invalid permissions for {1}, Octal permissions: {2}, Text Permissions: {3};  May not have execute permissions on any files and no write for others.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a.file as "File", a.octal_permissions as " Octal Permissions", a.text_permissions as "Text Permissions"
FROM
jac_data.unix_file_perms_v2 a
WHERE
a.file like '/tmp/%'
and a.text_permissions not like 'd%'
and a.text_permissions not like 's%'
and a.text_permissions not like 'b%'
and a.text_permissions not like 'c%'
and a.text_permissions not like 'l%'
and a.text_permissions like '________w%'
and (a.text_permissions like '%x%'
or a.text_permissions like '%s%')
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation on the basis of the requirement: Files in /tmp and its subdirectories may not have both the other-write and any execute permissions set.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="95">
<cdf:TechSpecsEntriesRef id="160"/>
<cdf:requires idref="FilePermsV2-dir_perms">
</cdf:requires>
<cdf:title>Protecting Resources-OSRs/OSR \VAR Files Restrictions</cdf:title>
<cdf:ruleName>OSR_VAR_Files_Restrictions</cdf:ruleName>
<cdf:description>Files in the /var directory and its subdirectories may not have both the other-write and any execute permissions set. Note: directories (d), socket (s), named pipe (p), block special file (b), character special file (c), and symbolic link (l) files are excluded from this requirement.</cdf:description>
<scm:violationMessage>Invalid permissions for {1}, Octal permissions: {2}, Text Permissions: {3};  May not have execute permissions on any files and no write for others.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a.file as "File", a.octal_permissions as " Octal Permissions", a.text_permissions as "Text Permissions"
FROM
jac_data.unix_file_perms_v2 a
WHERE
a.file like '/var/%'
and a.text_permissions not like 'd%'
and a.text_permissions not like 's%'
and a.text_permissions not like 'b%'
and a.text_permissions not like 'c%'
and a.text_permissions not like 'l%'
and a.text_permissions like '________w%'
and (a.text_permissions like '%x%'
or a.text_permissions like '%s%'
or a.text_permissions like '%t' )
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation on the basis of the requirement: Files in the /var directory and its subdirectories may not have both the other-write and any execute permissions set.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="96">
<cdf:TechSpecsEntriesRef id="118,222,221"/>
<cdf:requires idref="FilePermsV2-varlogsub">
</cdf:requires>
<cdf:requires idref="GroupsV2"></cdf:requires>
<cdf:requires idref="UsersV3"></cdf:requires>
<cdf:requires idref="LoginDefsV1"></cdf:requires>
<cdf:title>Protecting Resources-OSRs/OSR \VAR\LOG Subdirectory Restrictions</cdf:title>
<cdf:ruleName>OSR_VAR_LOG_Subdirectory_Restrictions</cdf:ruleName>
<cdf:description>Settings for other on this directory must be r-x or more restrictive. Subdirectories of /var/log may be world writable if and only if the permissions are 1777. More stringent value can be set. /var/log must be owned by privileged Owner and Group.</cdf:description>
<scm:violationMessage>{1} {2}, Owner: {3}, Group: {4}, Permissions: {5}, Settings for other must be r-x or more stringent. Must be owned by privileged Owner and Group</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>SELECT distinct a.cli_id,
case when b.cli_id is  NULL OR c.cli_id IS null
then
case when a.text_permissions not like '________-_%'
then 'OSR Invalid Permissions and Invalid Owner or Group:'
else 'OSR Invalid Owner or Group:'
end
else 'OSR Invalid Permissions:'
end, a.file, a.owner, a."GROUP", a.text_permissions
FROM (SELECT *
FROM jac_data.unix_file_perms_v2 a
WHERE a.file like '/var/log/%' OR a.file like '/var/log' ) a
--privileged user
LEFT JOIN (SELECT DISTINCT a.CLI_ID , a.USERNAME
FROM jac_data.unix_users_v3 a
LEFT JOIN jac_data.linux_login_defs_v1 d ON a.CLI_ID = d.CLI_ID
WHERE
(d.sys_uid_max is not null and a.UID &lt;= d.sys_uid_max)
OR
(d.sys_uid_max is null and d.uid_min is not null and a.uid &lt; d.uid_min)
OR
a.USERNAME IN ($(OSR Excluded Users))
OR
-- user in privileged group
a.USERNAME IN (SELECT a.USER_NAME
FROM jac_data.unix_group_members_v2 a
LEFT JOIN jac_data.unix_groups_v2 g on a.cli_id = g.cli_id	and a.gid = g.gid
LEFT JOIN jac_data.linux_login_defs_v1 d ON a.CLI_ID = d.CLI_ID
WHERE
(a.GID &lt;&gt; 100
AND
((d.SYS_GID_MAX IS NOT NULL AND a.GID &lt;= d.SYS_GID_MAX)
OR
(d.SYS_GID_MAX IS NULL AND d.GID_MIN IS NOT NULL AND a.GID &lt; d.GID_MIN)))
OR g.GROUP_NAME IN ($(OSR Excluded Groups)))) b ON a.CLI_ID = b.cli_id AND a.OWNER = b.username
-- privileged group
LEFT JOIN (SELECT DISTINCT g.CLI_ID, g.GROUP_NAME
FROM
jac_data.unix_groups_v2 g
LEFT JOIN jac_data.linux_login_defs_v1 d ON g.CLI_ID = d.CLI_ID
WHERE
(g.GID &lt;&gt; 100
AND
((d.SYS_GID_MAX IS NOT NULL AND g.GID &lt;= d.SYS_GID_MAX)
OR
(d.SYS_GID_MAX IS NULL AND d.GID_MIN IS NOT NULL AND g.GID &lt; d.GID_MIN)))
OR g.GROUP_NAME IN ($(OSR Excluded Groups))) c ON a.CLI_ID = c.cli_id AND a."GROUP" = c.group_name
WHERE
a.text_permissions IS NOT NULL
AND
(
(lower(a.text_permissions) like '________w%'
AND (
-- check all files recursivly and /var/log directory itself
(a.FILE = '/var/log' OR (a.FILE like '/var/log/%' AND lower(a.text_permissions) like '-%'))
OR
-- check all subdirectories with 1777 exception
(a.FILE like '/var/log/%' AND lower(a.text_permissions) like 'd%' AND lower(a.text_permissions) not like '_________t%')
))
OR
(b.cli_id IS NULL OR c.cli_id IS NULL)
)</scm:sql>
</cdf:check>
<cdf:remediation parameters="rx" disable="false">
<cdf:description>
Remediation on the basis of the requirement: Settings for other on this directory must be r-x or more restrictive.
Subdirectories of /var/log may be world writable if and only if the permissions are 1777
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="98">
<cdf:TechSpecsEntriesRef id="150,152,223,222,221"/>
<cdf:requires idref="RcdV2">
</cdf:requires>
<cdf:requires idref="LoginDefsV1">
</cdf:requires>
<cdf:requires idref="GroupsV2">
</cdf:requires>
<cdf:requires idref="UsersV3">
</cdf:requires>
<cdf:requires idref="PlatformInfoV2">
</cdf:requires>
<cdf:title>Protecting Resources-OSRs/RC Command Group Permissions</cdf:title>
<cdf:ruleName>RC_Command_Group_Permissions</cdf:ruleName>
<cdf:description>rc0.d, rc1.d, rc2.d, rc3.d, rc4.d, rc5.d, rc6.d, rcS.d directories under /etc/init.d/ directory -or- rc0.d, rc1.d, rc2.d, rc3.d, rc4.d, rc5.d, rc6.d, rcS.d directories under  /etc/rc.d/ directory. Each active entry's file/command/script executed, and all existing directories in its path must have settings for "group"  of r-x or more stringent, if owned by groups considered to be default groups for general users. (users)</cdf:description>
<scm:violationMessage>{1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>SELECT DISTINCT z.CLI_ID, RTRIM(INVALID_SETTING )
FROM
(
SELECT
distinct a.cli_id, RTRIM('Invalid /etc/rc.d Command ACL for command: ' || a.file_path  || ', Permissions: ' || a.permission || ', Permissions for GROUP must be set to r-x or more stringent if owned by group "users".' ) as INVALID_SETTING
FROM
jac_data.unix_wwep_rc_file_perms_v2 a
WHERE
a.permission like  '-____w%'
and lower(a."GROUP") in ($(General Users))
UNION
SELECT
distinct x.cli_id, RTRIM('Invalid Group for /etc/rc.d command: ' || x.file_path || ', Group: ' || bb.group_name || ', GID: ' || rtrim(char(bb.gid)) || ', It must belong to a Group that has SecurityorSystemadministrationauthority.') as INVALID_SETTING
FROM
jac_data.unix_wwep_rc_file_perms_v2 x
left join jac_data.unix_groups_v2 bb on x.cli_id = bb.cli_id and x."GROUP" = bb.group_name
left join jac_data.sec_platform_infoV2 f on bb.cli_id = f.cli_id
and bb.gid &gt; 99 and (
(bb.gid &gt; 199 and lower(f.version) like '%debian% 5%')
or
(bb.gid &gt; 499 and (
lower(f.version) like '%red hat%release 5%' or
lower(f.version) like '%red hat%release 6%' or
lower(f.version) like '%centos%release 5%' or
lower(f.version) like '%centos%release 6%'))
or
(bb.gid &gt; 499 and (
lower(f.version) like 'suse linux enterprise server 10%' or
lower(f.version) like 'suse linux enterprise server 11%' or
lower(f.version) like 'suse linux enterprise server 12%'))
or
(bb.gid &gt; 999 and (
lower(f.version) like '%red hat%release 7%' or
lower(f.version) like '%centos%release 7%'))
or
(bb.gid &gt; 999 and (
lower(f.version) like '%debian% 6%' or
lower(f.version) like '%debian% 7%' or
lower(f.version) like '%debian% 8%' or
lower(f.version) like '%ubuntu%'))
or bb.gid = 100
)
left join jac_data.linux_login_defs_v1 e on x.cli_id = e.cli_id and (
(e.sys_gid_max is not null and bb.gid &gt; e.sys_gid_max)
or
(e.sys_gid_max is null and e.gid_min is not null and bb.gid &gt;= e.gid_min)
)
WHERE
(f.cli_id is not null or e.cli_id is not null) and x."GROUP" not in ($(OSR Excluded Groups))

UNION
SELECT
distinct ee.cli_id,  RTRIM('Invalid Owner for /etc/rc.d command: ' || ee.file_path || ', Owner: ' || ee.owner || ', UID: ' || rtrim(char(cc.uid)) || ', It must belong to Owner that has SecurityorSystemadministrationauthority.') as INVALID_SETTING
FROM
jac_data.unix_wwep_rc_file_perms_v2 ee
left join jac_data.unix_users_v3 cc on ee.cli_id = cc.cli_id and ee.owner = cc.username
left join jac_data.linux_login_defs_v1 dd on ee.cli_id = dd.cli_id and (
(dd.sys_uid_max is not null and cc.uid &gt; dd.sys_uid_max)
or
(dd.sys_uid_max is null and dd.uid_min is not null and  cc.uid &gt;= dd.uid_min)
)
WHERE
dd.cli_id is not null
and ee.owner not in ($(OSR Excluded Users))
and ee.owner not in (
select u.username
from jac_data.unix_users_v3 u
left join jac_data.unix_groups_v2 g on u.cli_id = g.cli_id	and u.gid = g.gid
left join jac_data.unix_group_members_v2 gm on u.cli_id = gm.cli_id	and u.gid = gm.gid
where g.group_name in ($(OSR Excluded Groups)))

UNION
SELECT
distinct b.cli_id,  RTRIM('Invalid /etc/rc.d Command ACL for command directory: ' ||  b.dir_path || ', Permissions: ' || b.permission || ', Permissions for GROUP must be set to r-x or more stringent if owned by group "users".') as INVALID_SETTING
FROM
jac_data.unix_wwep_rc_dir_v2 b
WHERE
b.permission like  'd____w%'
and lower(b."GROUP") in ($(General Users))
) AS INVALID_CONFIG
INNER JOIN jac_data.unix_wwep_rc_file_perms_v2 z
ON INVALID_CONFIG.CLI_ID=z.CLI_ID
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
For all active entries in directories /etc/init.d /etc/rc.d /etc/init.d/rc0.d /etc/init.d/rc1.d /etc/init.d/rc2.d /etc/init.d/rc3.d /etc/init.d/rc4.d /etc/init.d/rc5.d /etc/init.d/rc6.d /etc/init.d/rcS.d /etc/rc.d/rc0.d /etc/rc.d/rc1.d /etc/rc.d/rc2.d /etc/rc.d/rc3.d  /etc/rc.d/rc4.d /etc/rc.d/rc5.d /etc/rc.d/rc6.d /etc/rc.d/rcS.d must have privileged owner and group according to operating system. And group must have r-x or more stringent permissions, if owned by groups considered to be default group(users)</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="99">
<cdf:TechSpecsEntriesRef id="149,151"/>
<cdf:requires idref="RcdV2">
</cdf:requires>
<cdf:title>Protecting Resources-OSRs/RC Command WW Permissions</cdf:title>
<cdf:ruleName>RC_Command_WW_Permissions</cdf:ruleName>
<cdf:description>rc0.d, rc1.d, rc2.d, rc3.d, rc4.d, rc5.d, rc6.d, rcS.d directories under /etc/init.d/ directory -or- rc0.d, rc1.d, rc2.d, rc3.d, rc4.d, rc5.d, rc6.d, rcS.d directories under  /etc/rc.d/ directory. Each file which is executed as a result of links placed in these directories and all existing directories in its path must have settings for "other"  of r-x or more stringent. Actual files in this directories must meet the same requirement.</cdf:description>
<scm:violationMessage>{1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT z.CLI_ID, RTRIM(INVALID_SETTING )
FROM
(
SELECT
distinct a.cli_id, RTRIM('Invalid /etc/rc.d Command ACL for command: ' || a.file_path  || ', Permissions: ' || a.permission || ', Permissions for OTHER must be set to r-x or more stringent.' ) as INVALID_SETTING
FROM
jac_data.unix_wwep_rc_file_perms_v2 a
WHERE
a.permission like  '________w%'
and a.permission not like 'd%'
and a.permission not like 'l%'
and a.permission not like 's%'
and a.permission not like 'p%'
and a.permission not like 'b%'
and a.permission not like 'c%'
UNION
SELECT
distinct b.cli_id,  RTRIM('Invalid /etc/rc.d Command ACL for command directory: ' ||  b.dir_path || ', Permissions: ' || b.permission || '. Permissions for OTHER must be set to r-x or more stringent.') as INVALID_SETTING
FROM
jac_data.unix_wwep_rc_dir_v2 b
WHERE
b.permission like  '________w%'
and dir_path not like '/tmp'
and dir_path not like '/tmp/'
) AS INVALID_CONFIG
INNER JOIN jac_data.unix_wwep_rc_file_perms_v2 z
ON INVALID_CONFIG.CLI_ID=z.CLI_ID
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
All files from below directories must have settings for "other"  of r-x or more stringent.
/etc/init.d/rc0.d, /etc/init.d/rc1.d,
/etc/init.d/rc2.d, /etc/init.d/rc3.d,
/etc/init.d/rc4.d, /etc/init.d/rc5.d,
/etc/init.d/rc6.d, /etc/init.d/rcS.d
-or-
/etc/rc.d/rc0.d, /etc/rc.d/rc1.d,
/etc/rc.d/rc2.d, /etc/rc.d/rc3.d,
/etc/rc.d/rc4.d, /etc/rc.d/rc5.d,
/etc/rc.d/rc6.d, /etc/rc.d/rcS.d
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="102">
<cdf:TechSpecsEntriesRef id="125"/>
<cdf:requires idref="FilePermsV2-perms">
</cdf:requires>
<cdf:title>Protecting Resources-OSRs/SNMPD.CONF Restrictions</cdf:title>
<cdf:ruleName>SNMPD_CONF_Restrictions</cdf:ruleName>
<cdf:description>/etc/snmpd/snmpd.conf file - Permissions must be 0640 or more restrictive if the file exists</cdf:description>
<scm:violationMessage>Invalid OSR ACL for {1}, Owner: {2}, Group: {3}, Permissions: {4}, Settings for other on this directory must be 640 or more stringent</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a.file as "File", a.owner as "User", a."GROUP" as "Group", a.text_permissions as "Permissions"
FROM
jac_data.unix_file_perms_v2 a
WHERE
( a.file = '/etc/snmpd/snmpd.conf'
or a.file = '/etc/snmp/snmpd.conf'
or a.file = '/etc/snmpd.conf')
and a.text_permissions not like '___-_-----%'
</scm:sql>
</cdf:check>
<cdf:remediation parameters="0640" disable="false">
<cdf:description>
Remediation on the basis of the requirement: /etc/snmpd/snmpd.conf file - Permissions must be 0640 or more restrictive if the file exists
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="104">
<cdf:TechSpecsEntriesRef id="115"/>
<cdf:requires idref="FilePermsV2-perms">
</cdf:requires>
<cdf:title>Protecting Resources-OSRs/\ETC\SECURITY\OPASSWD Restrictions</cdf:title>
<cdf:ruleName>ETC_SECURITY_OPASSWD_Restrictions</cdf:ruleName>
<cdf:description>Prevent reuse of last four passwords - requires /etc/security/opasswd to exist.  Permissions should be 0600 and owner should be root.</cdf:description>
<scm:violationMessage>/etc/security/opasswd does not exist or has incorrect permissions: {1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct d.cli_id, '/etc/security/opasswd does not exist or has incorrect permissions: ' || d.text_permissions as "Permissions"
FROM
jac_data.unix_file_perms_v2 d
WHERE
d.file = '/etc/security/opasswd'
and ( d.text_permissions not like '___-------%'
or d.owner &lt;&gt; 'root'
or d.text_permissions is null )
</scm:sql>
</cdf:check>
<cdf:remediation parameters="0600" disable="false">
<cdf:description>
Remediation on the basis of the requirement: Prevent reuse of last four passwords - requires /etc/security/opasswd to exist.  Permissions should be 0600 and owner should be root.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="106">
<cdf:TechSpecsEntriesRef id="164,170"/>
<cdf:requires idref="UmaskExtV1"></cdf:requires>
<cdf:requires idref="FilePermsV2-perms"></cdf:requires>
<cdf:requires idref="PlatformInfoV2"></cdf:requires>
<cdf:requires idref="UsersV3"></cdf:requires>
<cdf:title>Protecting Resources-User Resources/Default UMASK Restriction</cdf:title>
<cdf:ruleName>Default_UMASK_Restriction</cdf:ruleName>
<cdf:description>/etc/skel/.cshrc, /etc/skel/.login, /etc/skel/.profile, /etc/skel/.bashrc, /etc/skel/.bash_profile, /etc/skel/.bash_login, /etc/skel/.tcshrc.
Encodes: "umask 077" as the UMASK setting. Note:  There is no requirement these files exist; but if they do, they must conform to the requirement.
</cdf:description>
<scm:violationMessage>{1} More stringent value can be set.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT a.CLI_ID,
CASE WHEN d.UMASK IS NOT NULL THEN 'Umask value is not valid: ' || d.UMASK || '. File ' || a."FILE" || ' Should be set $(Default Umask).'
ELSE CASE WHEN a.FILE_EXIST = 1 THEN 'Umask setting is missing. File ' || a."FILE" || ' File must encode umask $(Default Umask).' ELSE 'Missing file ' || a."FILE" || ' File must exist and encode umask $(Default Umask).' END END
FROM
JAC_DATA.UNIX_FILE_PERMS_V2 a
INNER JOIN JAC_DATA.SEC_PLATFORM_INFOV2 bb ON
a.CLI_ID = bb.CLI_ID
LEFT JOIN(
SELECT
DISTINCT i.CLI_ID,
i.SHELL
FROM
JAC_DATA.UNIX_USERS_V3 i
) cc (CLI_ID, SHELL) ON
a.CLI_ID = cc.CLI_ID
AND(
(
-- tech spec nothing says about bashrc and profile.local this files existance
-- violation will came up even if files does not exist
a."FILE" = '/etc/bashrc'
AND(
LOWER( bb.version ) LIKE '%red%hat%'
OR LOWER( bb.version ) LIKE '%centos%'
)
)
OR(
a."FILE" = '/etc/profile.local'
AND LOWER( bb.version ) LIKE 'suse%'
)
OR(
(
cc.SHELL LIKE '%/tcsh'
OR cc.SHELL LIKE '%/csh'
)
-- this files checked only if tcsh or csh is used by one of the user and file exist
AND a."FILE" IN(
'/etc/skel/.tcshrc',
'/etc/skel/.cshrc',
'/etc/skel/.login'
)
AND a.FILE_EXIST = 1
)
OR(
(
cc.SHELL LIKE '%/sh'
OR cc.SHELL LIKE '%/ksh'
OR cc.SHELL LIKE '%/bash'
)
-- this files checked only if sh ksh bash is used by one of the user and file exist
AND a."FILE" IN(
'/etc/skel/.bash_login',
'/etc/skel/.bash_profile',
'/etc/skel/.bashrc',
'/etc/skel/.profile'
)
AND a.FILE_EXIST = 1
)
)
LEFT JOIN JAC_DATA.LINUX_UMASK_EXT_V1 d ON
a.CLI_ID = d.CLI_ID
AND a."FILE" = d."PATH"
LEFT JOIN (
SELECT b.umask,
-- getting first digit
CASE WHEN b.umask_length = 4 THEN (SUBSTR(b.UMASK, 1, 1)) ELSE '0' END,
-- getting second digit
CASE WHEN b.umask_length IN (4,3) THEN (SUBSTR(b.UMASK, (b.umask_length - 2), 1)) ELSE '0' END,
-- getting third digit
CASE WHEN b.umask_length IN (4,3,2) THEN (SUBSTR(b.UMASK, (b.umask_length - 1), 1)) ELSE '0' END,
-- getting fourth digit
CASE WHEN b.umask_length IN (4,3,2,1) THEN (SUBSTR(b.UMASK, b.umask_length, 1)) ELSE '0' END
FROM (SELECT (TRIM(CHAR(UMASK))), LENGTH(TRIM(CHAR(UMASK))) FROM JAC_DATA.LINUX_UMASK_EXT_V1) b (UMASK, umask_length)
) b (umask, first_d, second_d, third_d, fourth_d) ON d.UMASK = b.UMASK
LEFT JOIN (
-- split umask value specified by policy parameter in 4 numeric values.
SELECT b.custom_umask,
-- getting first digit
CASE WHEN b.umask_length = 4 THEN (SUBSTR(b.custom_umask, 1, 1)) ELSE '0' END,
-- getting second digit
CASE WHEN b.umask_length IN (4,3) THEN (SUBSTR(b.custom_umask, (b.umask_length - 2), 1)) ELSE '0' END,
-- getting third digit
CASE WHEN b.umask_length IN (4,3,2) THEN (SUBSTR(b.custom_umask, (b.umask_length - 1), 1)) ELSE '0' END,
-- getting fourth digit
CASE WHEN b.umask_length IN (4,3,2,1) THEN (SUBSTR(b.custom_umask, b.umask_length, 1)) ELSE '0' END
FROM (VALUES ('$(Default Umask)', LENGTH('$(Default Umask)'))) b (custom_umask, umask_length)
) c (custom_umask, first_d, second_d, third_d, fourth_d) ON 1 = 1
WHERE
-- restrict result by this files for better perfomance.
a."FILE" IN(
'/etc/bashrc',
'/etc/profile.local',
'/etc/skel/.cshrc',
'/etc/skel/.login',
'/etc/skel/.profile',
'/etc/skel/.bashrc',
'/etc/skel/.bash_profile',
'/etc/skel/.bash_login',
'/etc/skel/.tcshrc'
)
AND cc.cli_id IS NOT NULL
AND (
d.CLI_ID IS NULL
OR
(d.CLI_ID IS NOT NULL
AND (
(c.second_d = '0' AND b.second_d NOT IN ('0','1','2','3','4','5','6','7')) OR
(c.second_d = '1' AND b.second_d NOT IN ('1','3','5','7')) OR
(c.second_d = '2' AND b.second_d NOT IN ('2','3','6','7')) OR
(c.second_d = '3' AND b.second_d NOT IN ('3','7')) OR
(c.second_d = '4' AND b.second_d NOT IN ('4','5','6','7')) OR
(c.second_d = '5' AND b.second_d NOT IN ('5','7')) OR
(c.second_d = '6' AND b.second_d NOT IN ('6','7')) OR
(c.second_d = '7' AND b.second_d NOT IN ('7')) OR
(c.third_d = '0' AND b.third_d NOT IN ('0','1','2','3','4','5','6','7')) OR
(c.third_d = '1' AND b.third_d NOT IN ('1','3','5','7')) OR
(c.third_d = '2' AND b.third_d NOT IN ('2','3','6','7')) OR
(c.third_d = '3' AND b.third_d NOT IN ('3','7')) OR
(c.third_d = '4' AND b.third_d NOT IN ('4','5','6','7')) OR
(c.third_d = '5' AND b.third_d NOT IN ('5','7')) OR
(c.third_d = '6' AND b.third_d NOT IN ('6','7')) OR
(c.third_d = '7' AND b.third_d NOT IN ('7')) OR
(c.fourth_d = '0' AND b.fourth_d NOT IN ('0','1','2','3','4','5','6','7')) OR
(c.fourth_d = '1' AND b.fourth_d NOT IN ('1','3','5','7')) OR
(c.fourth_d = '2' AND b.fourth_d NOT IN ('2','3','6','7')) OR
(c.fourth_d = '3' AND b.fourth_d NOT IN ('3','7')) OR
(c.fourth_d = '4' AND b.fourth_d NOT IN ('4','5','6','7')) OR
(c.fourth_d = '5' AND b.fourth_d NOT IN ('5','7')) OR
(c.fourth_d = '6' AND b.fourth_d NOT IN ('6','7')) OR
(c.fourth_d = '7' AND b.fourth_d NOT IN ('7'))
)
)
)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="$(Default Umask)" disable="false">
<cdf:description>
Remediation on the basis of the requirement: Default UMASK must be x77
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="107">
<cdf:TechSpecsEntriesRef id="170"/>
<cdf:requires idref="UsersV3">
</cdf:requires>
<cdf:requires idref="HomeFsV2">
</cdf:requires>
<cdf:title>Protecting Resources-User Resources/Home Directory Restrictions</cdf:title>
<cdf:ruleName>Home_Directory_Restrictions</cdf:ruleName>
<cdf:description>General users home directory: (= Linux UIDs with a GID &gt; 98 according to privileged UID revalidation requirement). Default Permissions at time of creation: 700  (Default setting which may be changed later = procedural requirement which cant be checked here). Must be owned by userid. Home directories for system ids created as part of an rpm installation / configuration: Directory ownership may be associated to a different system id; permissions may be set as required by the OS component.</cdf:description>
<scm:violationMessage>Home directory for account {1} has incorrect owner of {2}, Directory: {3}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a."USER", a.owner, a.file
FROM
jac_data.unix_home_fs_v2 a
WHERE
a."USER" != a.owner
and a."USER" not in (
SELECT
u.username
FROM
jac_data.unix_users_v3 u
WHERE
u.gid &lt; 99
and u.cli_id = a.cli_id
)
and a.owner not in ('ntp','nobody', 'nfsnobody', 'root', 'games', 'pegasus')
and a.file not like '/usr/games'
and a.file not like '/home/pegasus'
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="true">
<cdf:description>
Remediation marked as NOT TODO.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="108">
<cdf:TechSpecsEntriesRef id="165"/>
<cdf:requires idref="LoginDefsV1">
</cdf:requires>
<cdf:title>Protecting Resources-User Resources/Login.defs umask restriction</cdf:title>
<cdf:ruleName>Login_defs_umask_restriction</cdf:ruleName>
<cdf:description>/etc/login.defs must include this line:
UMASK 077
More stringent value can be set.</cdf:description>
<scm:violationMessage>{1} More stringent value can be set.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT distinct a.cli_id,
CASE WHEN a.UMASK IS NULL THEN 'File /etc/login.defs has missing umask setting. File must encode umask $(Default Umask).'
ELSE 'File /etc/login.defs include invalid umask setting ' || RTRIM(CHAR(a.UMASK)) || '. Should be set $(Default Umask).' END
--a.CLI_ID, a.UMASK, b.umask, b.first_d, b.second_d, b.third_d, b.fourth_d,c.custom_umask, c.first_d, c.second_d, c.third_d, c.fourth_d
FROM	jac_data.linux_login_defs_v1 a
LEFT JOIN (
SELECT b.umask,
-- getting first digit
CASE WHEN b.umask_length = 4 THEN (SUBSTR(b.UMASK, 1, 1)) ELSE '0' END,
-- getting second digit
CASE WHEN b.umask_length IN (4,3) THEN (SUBSTR(b.UMASK, (b.umask_length - 2), 1)) ELSE '0' END,
-- getting third digit
CASE WHEN b.umask_length IN (4,3,2) THEN (SUBSTR(b.UMASK, (b.umask_length - 1), 1)) ELSE '0' END,
-- getting fourth digit
CASE WHEN b.umask_length IN (4,3,2,1) THEN (SUBSTR(b.UMASK, b.umask_length, 1)) ELSE '0' END
FROM (SELECT (TRIM(CHAR(UMASK))), LENGTH(TRIM(CHAR(UMASK))) FROM jac_data.linux_login_defs_v1) b (UMASK, umask_length)
) b (umask, first_d, second_d, third_d, fourth_d) ON 1=1
LEFT JOIN (
-- split umask value specified by policy parameter in 4 numeric values.
SELECT b.custom_umask,
-- getting first digit
CASE WHEN b.umask_length = 4 THEN (SUBSTR(b.custom_umask, 1, 1)) ELSE '0' END,
-- getting second digit
CASE WHEN b.umask_length IN (4,3) THEN (SUBSTR(b.custom_umask, (b.umask_length - 2), 1)) ELSE '0' END,
-- getting third digit
CASE WHEN b.umask_length IN (4,3,2) THEN (SUBSTR(b.custom_umask, (b.umask_length - 1), 1)) ELSE '0' END,
-- getting fourth digit
CASE WHEN b.umask_length IN (4,3,2,1) THEN (SUBSTR(b.custom_umask, b.umask_length, 1)) ELSE '0' END
FROM (VALUES ('$(Default Umask)', LENGTH('$(Default Umask)'))) b (custom_umask, umask_length)
) c (custom_umask, first_d, second_d, third_d, fourth_d) ON 1 = 1
WHERE
a.UMASK IS NULL
OR
(
(c.second_d = '0' AND b.second_d NOT IN ('0','1','2','3','4','5','6','7')) OR
(c.second_d = '1' AND b.second_d NOT IN ('1','3','5','7')) OR
(c.second_d = '2' AND b.second_d NOT IN ('2','3','6','7')) OR
(c.second_d = '3' AND b.second_d NOT IN ('3','7')) OR
(c.second_d = '4' AND b.second_d NOT IN ('4','5','6','7')) OR
(c.second_d = '5' AND b.second_d NOT IN ('5','7')) OR
(c.second_d = '6' AND b.second_d NOT IN ('6','7')) OR
(c.second_d = '7' AND b.second_d NOT IN ('7')) OR
(c.third_d = '0' AND b.third_d NOT IN ('0','1','2','3','4','5','6','7')) OR
(c.third_d = '1' AND b.third_d NOT IN ('1','3','5','7')) OR
(c.third_d = '2' AND b.third_d NOT IN ('2','3','6','7')) OR
(c.third_d = '3' AND b.third_d NOT IN ('3','7')) OR
(c.third_d = '4' AND b.third_d NOT IN ('4','5','6','7')) OR
(c.third_d = '5' AND b.third_d NOT IN ('5','7')) OR
(c.third_d = '6' AND b.third_d NOT IN ('6','7')) OR
(c.third_d = '7' AND b.third_d NOT IN ('7')) OR
(c.fourth_d = '0' AND b.fourth_d NOT IN ('0','1','2','3','4','5','6','7')) OR
(c.fourth_d = '1' AND b.fourth_d NOT IN ('1','3','5','7')) OR
(c.fourth_d = '2' AND b.fourth_d NOT IN ('2','3','6','7')) OR
(c.fourth_d = '3' AND b.fourth_d NOT IN ('3','7')) OR
(c.fourth_d = '4' AND b.fourth_d NOT IN ('4','5','6','7')) OR
(c.fourth_d = '5' AND b.fourth_d NOT IN ('5','7')) OR
(c.fourth_d = '6' AND b.fourth_d NOT IN ('6','7')) OR
(c.fourth_d = '7' AND b.fourth_d NOT IN ('7'))
)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="077" disable="false">
<cdf:description>
Remediation on the basis of the requirement: Default Umask Invalid or missing. Umask should be 077
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="109">
<cdf:TechSpecsEntriesRef id="169,170"/>
<cdf:requires idref="FileSearchv1">
</cdf:requires>
<cdf:requires idref="ShellsV1">
</cdf:requires>
<cdf:title>Protecting Resources-User Resources/\etc\csh.login File Restriction</cdf:title>
<cdf:ruleName>etc_csh_login_File_Restriction</cdf:ruleName>
<cdf:description>File must exist, and must trigger an invocation of
source /etc/profile.d/IBMsinit.csh</cdf:description>
<scm:violationMessage>{1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT distinct  a.cli_id,
case when b.cli_id is null then 'File /etc/csh.login must exist.' else
RTRIM('File does not  trigger an invocation of line source /etc/profile.d/IBMsinit.csh' ) end
FROM
jac_data.unix_file_search_v1 a
-- report violation only if csh is installed
inner join jac_data.unix_shells_v1 shells on  a.cli_id=shells.cli_id
left join jac_data.unix_file_search_v1 b on  a.cli_id=b.cli_id and b.filename in ('/etc/csh.login','/etc/csh.login.local')
where
(
(b.cli_id is null and b.line is null)
or
(b.cli_id is not null
and
a.cli_id not in (
SELECT	z.cli_id
FROM	jac_data.unix_file_search_v1 z
WHERE
lower(z.line) like '%source%/etc/profile.d/ibmsinit.csh'
)
)
) and shells.shell like '%/csh'
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
Remediation on the basis of the requirement: /etc/csh.login file must exist, and must trigger an invocation of
source /etc/profile.d/IBMsinit.csh
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="110">
<cdf:TechSpecsEntriesRef id="168,170"/>
<cdf:requires idref="FileSearchv1">
</cdf:requires>
<cdf:title>Protecting Resources-User Resources/\etc\profile File Restriction</cdf:title>
<cdf:ruleName>etc_profile_File_Restriction</cdf:ruleName>
<cdf:description>File must exist, and must trigger an invocation of
.  /etc/profile.d/IBMsinit.sh</cdf:description>
<scm:violationMessage>{1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT distinct a.cli_id,
case when b.cli_id is null then 'File /etc/profile must exist.' else
'File does not  trigger an invocation of line . /etc/profile.d/IBMsinit.sh'  end
FROM
jac_data.unix_file_search_v1 a
left join jac_data.unix_file_search_v1 b on  a.cli_id=b.cli_id and b.filename in ('/etc/profile', '/etc/profile.local')
where
(b.cli_id is null and b.line is null)
or
(b.cli_id is not null
and
a.cli_id not in (
SELECT	z.cli_id
FROM	jac_data.unix_file_search_v1 z
WHERE
lower(z.line) like '%. /etc/profile.d/ibmsinit.sh'
)
)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="$(Default Umask)" disable="false">
<cdf:description>
Remediation on the basis of the requirement: /etc/profile file must exist, and must trigger an invocation of
.  /etc/profile.d/IBMsinit.sh
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="111">
<cdf:TechSpecsEntriesRef id="166,167"/>
<cdf:requires idref="FilePermsV2-\etc\profile">
</cdf:requires>
<cdf:requires idref="ShellsV1"></cdf:requires>
<cdf:title>Protecting Resources-User Resources/\etc\profile.d\File Existence</cdf:title>
<cdf:ruleName>etc_profile_d_File_Existence</cdf:ruleName>
<cdf:description>Files /etc/profile.d/IBMsinit.csh, /etc/profile.d/IBMsinit.sh  must exist.
Note: /etc/profile.d/IBMsinit.csh must exist only if "csh" is installed</cdf:description>
<scm:violationMessage>File {1} must exist.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>SELECT
distinct a.cli_id, a.file
FROM
jac_data.unix_file_perms_v2 a
inner join jac_data.unix_shells_v1 s on  a.cli_id=s.cli_id
and lower(a.file) in ('/etc/profile.d/ibmsinit.csh', '/etc/profile.d/ibmsinit.sh')
WHERE
a.file_exist = 0
and
(
lower(a.file) = '/etc/profile.d/ibmsinit.sh'
or (lower(a.file) = '/etc/profile.d/ibmsinit.csh'
and s.shell like '%/csh'))</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>File /etc/profile.d/IBMsinit.sh must exist and file /etc/profile.d/IBMsinit.csh must exist only if "csh" is installed
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="112">
<cdf:TechSpecsEntriesRef id="171,244"/>
<cdf:requires idref="motd"></cdf:requires>
<cdf:requires idref="LoginPromptV1"></cdf:requires>
<cdf:title>Business Use Notice/Business Use Notice Required</cdf:title>
<cdf:ruleName>Business_Use_Notice_Required</cdf:ruleName>
<cdf:description>Business Use Notice is required: /etc/motd or /etc/issue must exist and contain correct Business Use Notice. IBMs internal systems must only be used for conducting IBMs business or for purposes authorized by IBM management.</cdf:description>
<scm:violationMessage>Missing or Incorrect Business Use Notice. It should be set in /etc/motd or /etc/issue</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct a.cli_id, a."EXISTS" as "MOTD Exists"
FROM
jac_data.unix_motd a
WHERE
a."EXISTS" = 'NO'
or lower(a.message) not like $(Business Use Notice Text)
and a.cli_id not in (
SELECT b.cli_id
FROM jac_data.unix_loginprompt_v1 b
WHERE
b.local_login_text like $(Business Use Notice Text)
)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="IBMs internal systems must only be used for conducting IBMs business or for purposes authorized by IBM management." disable="false">
<cdf:description>
Remediation on the basis of the requirement: Business Use Notice is required.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="120">
<cdf:requires idref="PlatformInfoV2">
</cdf:requires>
<cdf:title>Summary Information/LINUX_Platform Scanned</cdf:title>
<cdf:ruleName>LINUX_Platform_Scanned</cdf:ruleName>
<cdf:description>Summary information for Operating System or for Application System.
Object of Policy : LINUX</cdf:description>
<scm:violationMessage>Platform Scanned : LINUX : {1}</scm:violationMessage>
<scm:priority>informational</scm:priority>
<cdf:check>
<scm:sql>
SELECT
a.cli_id, a.version
FROM
jac_data.sec_platform_infoV2 a
</scm:sql>
</cdf:check>
<cdf:remediation parameters="Summary information for Operating System or for Application System. Object of Policy : LINUX" disable="false">
<cdf:description>
Informational Rule, Remediation Not Required.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="121">
<cdf:requires idref="PlatformInfoV2">
</cdf:requires>
<cdf:title>Summary Information/List of Clients Scanned with Incorrect Platform</cdf:title>
<cdf:ruleName>List_of_Clients_Scanned_with_Incorrect_Platform</cdf:ruleName>
<cdf:description>List of Clients Snapshot was run against that were the incorrect platform for this Linux policy.</cdf:description>
<scm:violationMessage>Incorrect Client Platform: {2}, should be Linux</scm:violationMessage>
<scm:priority>informational</scm:priority>
<cdf:check>
<scm:sql>
SELECT
a.cli_id, a.OS, a.version
FROM
jac_data.sec_platform_infoV2 a
WHERE
lower(a.OS) not like '%linux%'
</scm:sql>
</cdf:check>
<cdf:remediation parameters="List of Clients Snapshot was run against that were the incorrect platform for this Linux policy." disable="false">
<cdf:description>
Remediation on the basis of the requirement: List of Clients Snapshot was run against that were the incorrect platform for this Linux policy.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="122">
<cdf:requires idref="PlatformInfoV2">
</cdf:requires>
<cdf:title>Summary Information/OS Level Information</cdf:title>
<cdf:ruleName>OS_Level_Information</cdf:ruleName>
<cdf:description>List client OS Level information</cdf:description>
<scm:violationMessage>OS Name: {1}, OS Version: {2}, OS Arch: {3}</scm:violationMessage>
<scm:priority>informational</scm:priority>
<cdf:check>
<scm:sql>
SELECT
a.cli_id, a.os, a.version, a.arch
FROM
jac_data.sec_platform_infoV2 a
</scm:sql>
</cdf:check>
<cdf:remediation parameters="List client OS Level information" disable="false">
<cdf:description>
Informational Rule, Remediation Not Required.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="123">
<cdf:requires idref="PlatformInfoV2">
</cdf:requires>
<cdf:title>Summary Information/Policy Information</cdf:title>
<cdf:ruleName>Policy_Information</cdf:ruleName>
<cdf:description>Policy Information: Policy Version, Last Modified</cdf:description>
<scm:violationMessage>Policy Version: {2}, Last Modified: {3}.</scm:violationMessage>
<scm:priority>informational</scm:priority>
<cdf:check>
<scm:sql>
SELECT
a.cli_id, a.version, $(Policy Version), $(Date of Policy Modification)
FROM
jac_data.sec_platform_infoV2 a
</scm:sql>
</cdf:check>
<cdf:remediation parameters="Policy Information: Policy Version $(Policy Version), Last Modified $(Date of Policy Modification)" disable="false">
<cdf:description>
Informational Rule, Remediation Not Required.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="125">
<cdf:TechSpecsEntriesRef id="8,9"/>
<cdf:requires idref="PamV1"></cdf:requires>
<cdf:requires idref="PlatformInfoV2"></cdf:requires>
<cdf:title>Password Requirements/Debian Password History</cdf:title>
<cdf:ruleName>Debian_Password_History</cdf:ruleName>
<cdf:description>Prevent reuse of last eight passwords on Debian: "password sufficient $PAM remember=7 use_authtok sha512 shadow" in /etc/pam.d/common-password if the file exists. If not, this statement must appear in /etc/pam.d/login, /etc/pam.d/passwd, /etc/pam.d/sshd and /etc/pam.d/su. $PAM for Debian 4 should be "pam_unix_passwd.so", for Debian 5 and later should be "pam_unix.so".</cdf:description>
<scm:violationMessage>Incorrect Password History Setting. For more information see checks description.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>SELECT
distinct a.cli_id, '$(Password History 2)'
FROM
jac_data.unix_pam_v1 a
inner join jac_data.sec_platform_infov2 p on a.cli_id=p.cli_id
and (lower(p.version) like '%debian%' or lower(p.version) like '%ubuntu%')
WHERE
a.cli_id  not in (
SELECT
distinct x.cli_id
FROM
jac_data.unix_pam_v1 x
WHERE
a.cli_id = x.cli_id
and ( lower(x.service) = '/etc/pam.d/common-password'
or exists (
SELECT
'/etc/pam.d/' || y.module_path
FROM
jac_data.unix_pam_v1 y
where
y.is_include = 1
and y.service = '/etc/pam.d/common-password'
and x.cli_id = y.cli_id
and x.service = '/etc/pam.d/' || y.module_path
)
)
and x.is_password = 1
and x.is_sufficient = 1
and ((lower(p.version) like '%debian% 4%' and lower(x.module_path) like '%pam_unix_passwd.so')
or (lower(p.version) not like '%debian% 4%' and lower(x.module_path) like '%pam_unix.so'))
and (lower(x.module_arguments) like  '%remember=$(Password History 2)' or lower(x.module_arguments) like '%remember=$(Password History 2) %')
and lower(x.module_arguments) like '%use_authtok%'
and lower(x.module_arguments) like '%sha512%'
and lower(x.module_arguments) like '%shadow%'
)
and  ( a.cli_id  not in (
SELECT
distinct y.cli_id
FROM
jac_data.unix_pam_v1 y
WHERE
a.cli_id = y.cli_id
and ( lower(y.service) = '/etc/pam.d/passwd'
or exists (
SELECT
'/etc/pam.d/' || yy.module_path
FROM
jac_data.unix_pam_v1 yy
where
yy.is_include = 1
and yy.service = '/etc/pam.d/passwd'
and y.cli_id = yy.cli_id
and y.service = '/etc/pam.d/' || yy.module_path
)
)
and y.is_password = 1
and y.is_sufficient = 1
and ((lower(p.version) like '%debian% 4%' and lower(y.module_path) like '%pam_unix_passwd.so')
or (lower(p.version) not like '%debian% 4%' and lower(y.module_path) like '%pam_unix.so'))
and (lower(y.module_arguments) like  '%remember=$(Password History 2)' or lower(y.module_arguments) like '%remember=$(Password History 2) %')
and lower(y.module_arguments) like '%use_authtok%'
and lower(y.module_arguments) like '%sha512%'
and lower(y.module_arguments) like '%shadow%'
)
or a.cli_id  not in (
SELECT
distinct z.cli_id
FROM
jac_data.unix_pam_v1 z
WHERE
a.cli_id = z.cli_id
and ( lower(z.service) = '/etc/pam.d/login'
or exists (
SELECT
'/etc/pam.d/' || y.module_path
FROM
jac_data.unix_pam_v1 y
where
y.is_include = 1
and y.service = '/etc/pam.d/login'
and z.cli_id = y.cli_id
and z.service = '/etc/pam.d/' || y.module_path
)
)
and z.is_password = 1
and z.is_sufficient = 1
and ((lower(p.version) like '%debian% 4%' and lower(z.module_path) like '%pam_unix_passwd.so')
or (lower(p.version) not like '%debian% 4%' and lower(z.module_path) like '%pam_unix.so'))
and (lower(z.module_arguments) like  '%remember=$(Password History 2)' or lower(z.module_arguments) like '%remember=$(Password History 2) %')
and lower(z.module_arguments) like '%use_authtok%'
and lower(z.module_arguments) like '%sha512%'
and lower(z.module_arguments) like '%shadow%'
)
or a.cli_id not in (
SELECT
distinct d.cli_id
FROM
jac_data.unix_pam_v1 d
WHERE
a.cli_id = d.cli_id
and ( lower(d.service) = '/etc/pam.d/sshd'
or exists (
SELECT
'/etc/pam.d/' || y.module_path
FROM
jac_data.unix_pam_v1 y
where
y.is_include = 1
and y.service = '/etc/pam.d/sshd'
and d.cli_id = y.cli_id
and d.service = '/etc/pam.d/' || y.module_path
)
)
and d.is_password = 1
and d.is_sufficient = 1
and ((lower(p.version) like '%debian% 4%' and lower(d.module_path) like '%pam_unix_passwd.so')
or (lower(p.version) not like '%debian% 4%' and lower(d.module_path) like '%pam_unix.so'))
and (lower(d.module_arguments) like  '%remember=$(Password History 2)' or lower(d.module_arguments) like '%remember=$(Password History 2) %')
and lower(d.module_arguments) like '%use_authtok%'
and lower(d.module_arguments) like '%sha512%'
and lower(d.module_arguments) like '%shadow%'
)
or a.cli_id not in (
SELECT
distinct e.cli_id
FROM
jac_data.unix_pam_v1 e
WHERE
a.cli_id = e.cli_id
and ( lower(e.service) = '/etc/pam.d/su'
or exists (
SELECT
'/etc/pam.d/' || y.module_path
FROM
jac_data.unix_pam_v1 y
where
y.is_include = 1
and y.service = '/etc/pam.d/su'
and e.cli_id = y.cli_id
and e.service = '/etc/pam.d/' || y.module_path
)
)
and e.is_password = 1
and e.is_sufficient = 1
and ((lower(p.version) like '%debian% 4%' and lower(e.module_path) like '%pam_unix_passwd.so')
or (lower(p.version) not like '%debian% 4%' and lower(e.module_path) like '%pam_unix.so'))
and (lower(e.module_arguments) like  '%remember=$(Password History 2)' or lower(e.module_arguments) like '%remember=$(Password History 2) %')
and lower(e.module_arguments) like '%use_authtok%'
and lower(e.module_arguments) like '%sha512%'
and lower(e.module_arguments) like '%shadow%'
)
)</scm:sql>
</cdf:check>
<cdf:remediation parameters="$(Password History 2)" disable="false">
<cdf:description>
Password history settings added in /etc/pam.d/common-password file if exists else in /etc/pam.d/login, /etc/pam.d/passwd, /etc/pam.d/sshd and /etc/pam.d/su files.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="126">
<cdf:TechSpecsEntriesRef id="174,175,176"/>
<cdf:requires idref="FileSearchv1"></cdf:requires>
<cdf:requires idref="PamV1"></cdf:requires>
<cdf:requires idref="PlatformInfoV2"></cdf:requires>
<cdf:title>Encryption/Password Encryption Required</cdf:title>
<cdf:ruleName>Password_Encryption_Required</cdf:ruleName>
<cdf:description>Debian: /etc/pam.d/common-password.
Red Hat: /etc/pam.d/passwd or /etc/pam.d/system-auth.
Additionally on Red Hat 6 and later: /etc/pam.d/password-auth.
Must have "password sufficient  pam_unix.so" stanza with "sha512 shadow" options.
Any file in /etc/pam.d containing "password sufficient pam_unix.so" stanza must carry the "sha512 shadow" options.
SLES: /etc/default/passwd must have both "CRYPT_FILES=sha512" and "CRYPT=sha512" settings. Note: It is acceptable to replace "sha512" with "sha256"</cdf:description>
<scm:violationMessage>{1}. {2}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT
distinct q.cli_id, 'Incorrect or missing pam_unix.so module stanza', 'For more information see coverage matrix document'
FROM
jac_data.unix_pam_v1 q
WHERE
q.cli_id not in(
SELECT
distinct a.cli_id
FROM
jac_data.unix_pam_v1 a
inner join jac_data.sec_platform_infov2 p on a.cli_id = p.cli_id

left join jac_data.unix_pam_v1 b on a.cli_id = b.cli_id
and a.file_number = b.file_number
and a.row_number = b.row_number
and lower(a.service) = '/etc/pam.d/common-password'

left join jac_data.unix_pam_v1 c on a.cli_id = c.cli_id
and a.file_number = c.file_number
and a.row_number = c.row_number
and (lower(a.service) = '/etc/pam.d/passwd' or lower(a.service) = '/etc/pam.d/system-auth')

WHERE
a.is_password = 1
and a.is_sufficient = 1
and lower(a.module_path) like '%pam_unix.so'
and lower(a.module_arguments) like '%shadow%'
and lower(a.module_arguments) like '%sha512%'
and (
(b.service is not null and (lower(p.version) like '%debian%' or lower(p.version) like '%ubuntu%'))
or
(c.service is not null and (lower(p.version) like '%red hat%' or lower(p.version) like '%centos%')
and ((lower(p.version) not like '%red%hat% 6%' and lower(p.version) not like '%centos% 6%'
and lower(p.version) not like '%red%hat% 7%' and lower(p.version) not like '%centos% 7%')

or ((lower(p.version) like '%red%hat% 6%' or lower(p.version)  like '%centos% 6%'
or lower(p.version)  like '%red%hat% 7%' or lower(p.version)  like '%centos% 7%')

and a.cli_id in(
select e.cli_id
from jac_data.unix_pam_v1 e
where
lower(e.service) = '/etc/pam.d/password-auth'
and e.is_password = 1
and e.is_sufficient = 1
and lower(e.module_path) like '%pam_unix.so'
and lower(e.module_arguments) like '%shadow%'
and lower(e.module_arguments) like '%sha512%'
)))
)
)
)
UNION
SELECT
distinct b.cli_id, b.service, 'Any file in /etc/pam.d containing "password sufficient pam_unix.so" stanza must carry the "sha512 shadow" options.'
FROM
jac_data.unix_pam_v1 b
inner join jac_data.sec_platform_infov2 p on b.cli_id = p.cli_id
WHERE
b.is_password = 1
and b.is_sufficient = 1
and lower(b.module_path) like '%pam_unix.so'
and not (
lower(b.module_arguments) is not null
and lower(b.module_arguments) like '%shadow%'
and lower(b.module_arguments) like '%sha512%'
)

UNION
SELECT
distinct c.cli_id, c.filename, 'Must have both "CRYPT_FILES=sha512" and "CRYPT=sha512" settings. Note: sha512 can be replaced with sha256'
FROM
jac_data.unix_file_search_v1 c
inner join jac_data.sec_platform_infov2 p on c.cli_id = p.cli_id
left join jac_data.unix_file_search_v1 l on c.cli_id = l.cli_id and c.filename = l.filename
and (lower(l.line) like 'crypt_files=%' or lower(l.line) like 'crypt_files %=%')
left join jac_data.unix_file_search_v1 m on c.cli_id = m.cli_id and c.filename = m.filename
and (lower(m.line) like 'crypt=%' or lower(m.line) like 'crypt %=%')
WHERE
lower(p.version) like 'suse linux enterprise server%'
and c.filename = '/etc/default/passwd'
and (
(l.line is null or m.line is null)
or
(lower(l.line) not like '%sha512%' and lower(l.line) not like '%sha256%')
or
(lower(m.line) not like '%sha512%' and lower(m.line) not like '%sha256%')
)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="false">
<cdf:description>
For remediation required staanza added in OS respective files
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="128">
<cdf:TechSpecsEntriesRef id="7"/>
<cdf:requires idref="FileSearchv1"></cdf:requires>
<cdf:requires idref="PlatformInfoV2"></cdf:requires>
<cdf:requires idref="PamV1"></cdf:requires>
<cdf:title>Password Requirements/SLES Password History</cdf:title>
<cdf:ruleName>SLES_Password_History</cdf:ruleName>
<cdf:description>/etc/pam.d/common-password must include one of these two settings:
Option 1 -  Any SLES:
password $CONTROL pam_pwcheck.so remember=8 use_authtok nullok
Option 2  SLES 10 and earlier:
password sufficient pam_unix_passwd.so remember=7 use_authtok sha512 shadow
Option 3 for SLES 11 and later:
password $CONTROL pam_pwhistory.so remember=8
Note: $CONTROL must be one of "required", or "requisite".
For SLES 10, Option 1 or 2 must appear in /etc/pam.d/login, /etc/pam.d/passwd, /etc/pam.d/sshd and /etc/pam.d/su if /etc/pam.d/common-password does NOT exist</cdf:description>
<scm:violationMessage>Incorrect Password History setting on {1}. {2} For more informations see coverage matrix document.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>select
distinct a.cli_id, b.version, 'If /etc/pam.d/common-password exist, for any SLES version it can be set through pam_pwcheck.so pam module. On SLES 10 and earlier it can also be set through pam_unix_passwd.so pam module. On SLES 11 and later it can also be set through pam_pwhistory.so pam module'
from
jac_data.unix_pam_v1 a
inner join jac_data.sec_platform_infov2 b on a.cli_id = b.cli_id and lower(b.version) like 'suse%'
where
a.cli_id not in (
select
distinct u.cli_id
from
jac_data.unix_pam_v1 u
inner join jac_data.unix_pam_v1 s on u.cli_id = s.cli_id and u.file_number = s.file_number and u.row_number = s.row_number and u.service = '/etc/pam.d/common-password'
inner join jac_data.sec_platform_infov2 p on u.cli_id = p.cli_id and lower(p.version) like 'suse%'
--Option 1
left join jac_data.unix_pam_v1 ss on u.cli_id = ss.cli_id and u.file_number = ss.file_number and u.row_number = ss.row_number
and u.is_password = 1
and (u.is_required = 1 or u.IS_REQUISITE = 1)
and lower(u.module_path) like '%pam_pwcheck.so%'
and lower(u.module_arguments) like '%remember=$(Password History)%'
and lower(u.module_arguments) like '%use_authtok%'
and lower(u.module_arguments) like '%nullok%'
--Option 2 only for SLES 10 and earlier
left join jac_data.unix_pam_v1 sss on u.cli_id = sss.cli_id and u.file_number = sss.file_number and u.row_number = sss.row_number
and u.is_password = 1
and u.is_sufficient = 1
and lower(u.module_path) like '%pam_unix_passwd.so%'
and lower(u.module_arguments) like '%remember=$(Password History 2)%'
and lower(u.module_arguments) like '%use_authtok%'
and lower(u.module_arguments) like '%shadow%'
and lower(u.module_arguments) like '%sha512%'
-- Option 3 for SLES 11 and later
left join jac_data.unix_pam_v1 sles11 on u.cli_id = sles11.cli_id and u.file_number = sles11.file_number and u.row_number = sles11.row_number
and u.is_password = 1
and (u.is_required = 1 or u.IS_REQUISITE = 1)
and lower(u.module_path) like '%pam_pwhistory.so%'
and lower(u.module_arguments) like '%remember=$(Password History)%'
where
ss.cli_id is not null
or
(sss.cli_id is not null and lower(p.version) like 'suse% 10%')
OR
(sles11.cli_id is not null and (lower(p.version) like 'suse% 11%' OR lower(p.version) like 'suse% 12%'))
)
UNION
select
distinct a.cli_id, b.version, 'If /etc/pam.d/common-password does not exist on SLES 10, pam_pwcheck.so or pam_unix_passwd.so pam modules must be used for every file in the list /etc/pam.d/login,/etc/pam.d/passwd,/etc/pam.d/sshd,/etc/pam.d/su'
from
jac_data.unix_pam_v1 a
inner join jac_data.sec_platform_infov2 b on a.cli_id = b.cli_id and lower(b.version) like 'suse% 10%'
left join jac_data.unix_file_search_v1 c on a.cli_id = c.cli_id
where
-- /etc/pam.d/common-password does not exist
c.filename = '/etc/pam.d/common-password' and c.line is null
and
a.cli_id not in (
select
distinct u.cli_id
from
jac_data.unix_pam_v1 u
inner join jac_data.unix_pam_v1 s on u.cli_id = s.cli_id and u.file_number = s.file_number and u.row_number = s.row_number
and u.service in ('/etc/pam.d/login','/etc/pam.d/passwd','/etc/pam.d/sshd','/etc/pam.d/su')
inner join jac_data.sec_platform_infov2 p on u.cli_id = p.cli_id and lower(p.version) like 'suse% 10%'
--Option 1
left join jac_data.unix_pam_v1 ss on u.cli_id = ss.cli_id and u.file_number = ss.file_number and u.row_number = ss.row_number
and u.is_password = 1
and (u.is_required = 1 or u.IS_REQUISITE = 1)
and lower(u.module_path) like '%pam_pwcheck.so%'
and lower(u.module_arguments) like '%remember=$(Password History)%'
and lower(u.module_arguments) like '%use_authtok%'
and lower(u.module_arguments) like '%nullok%'
--Option 2
left join jac_data.unix_pam_v1 sss on u.cli_id = sss.cli_id and u.file_number = sss.file_number and u.row_number = sss.row_number
and u.is_password = 1
and u.is_sufficient = 1
and lower(u.module_path) like '%pam_unix_passwd.so%'
and lower(u.module_arguments) like '%remember=$(Password History 2)%'
and lower(u.module_arguments) like '%use_authtok%'
and lower(u.module_arguments) like '%shadow%'
and lower(u.module_arguments) like '%sha512%'
where
ss.cli_id is not null or sss.cli_id is not null
group by u.cli_id
-- 4 means that every pam file listed below must have one of options
having count(distinct u.service) = 4
)</scm:sql>
</cdf:check>
<cdf:remediation parameters="$(Password History)" disable="false">
<cdf:description> For remediation required stanza aaded in /etc/pam.d/common-password file as per the version of SLES.		</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="129">
<cdf:TechSpecsEntriesRef id="220"/>
<cdf:requires idref="PlatformInfoV2"></cdf:requires>
<cdf:requires idref="PamV1"></cdf:requires>
<cdf:title>Logging/Restrictions of pam_tally and pam_tally2</cdf:title>
<cdf:ruleName>Restrictions_of_pam_tally_and_pam_tally2</cdf:ruleName>
<cdf:description>For all distributions other than Red Hat, the desired module if present may be used.
RH V5 must use pam_tally.so
RH V6 and later must use pam_tally2.so</cdf:description>
<scm:violationMessage>{3} use the wrong {2} module. Require use of pam_tally.so on RH 5, and pam_tally2.so on RH 6 and later.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>SELECT
distinct u.cli_id, pp.version, u.module_path, u.service
FROM
jac_data.unix_pam_v1 u
inner join jac_data.sec_platform_infov2 pp on u.cli_id = pp.cli_id
WHERE
((lower(pp.version) like '%red%hat% 5%' or lower(pp.version) like '%centos% 5%')
and lower(u.module_path) like '%pam_tally2.so%')
or
((lower(pp.version) like '%red%hat% 6%' or lower(pp.version) like '%centos% 6%'
or lower(pp.version) like '%red%hat% 7%' or lower(pp.version) like '%centos% 7%')
and lower(u.module_path) like '%pam_tally.so%')</scm:sql>
</cdf:check>
<cdf:remediation disable="false">
<cdf:description>For remediation pam_tally.so and pam_tally2.so is searched inside all files of directory /etc/pam.d and remediated according to RHEL version. </cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="130">
<cdf:TechSpecsEntriesRef id="113,221,222"/>
<cdf:requires idref="UsersV3"></cdf:requires>
<cdf:requires idref="LoginDefsV1"></cdf:requires>
<cdf:requires idref="GroupsV2"></cdf:requires>
<cdf:requires idref="FilePermsV2-osr-usr"></cdf:requires>
<cdf:title>Protecting Resources-OSRs/OSR \USR Restrictions</cdf:title>
<cdf:ruleName>OSR_USR_Restrictions</cdf:ruleName>
<cdf:description>UNIX OSR directory - Settings for other on this directory "/usr" must be r-x or more stringent. Must be owned by privileged Owner and Group. This requirement applied recursively.</cdf:description>
<scm:violationMessage>{1} {2}, Owner: {3}, Group: {4}, Permissions: {5}, Settings for other must be r-x or more stringent. Must be owned by privileged Owner and Group</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>SELECT
distinct a.cli_id,
case when d.cli_id is not null
then
case when a.text_permissions not like '________-_%'
then 'OSR Invalid Permissions and Invalid Owner or Group:'
else 'OSR Invalid Owner or Group:'
end
else 'OSR Invalid Permissions:'
end, a.file as "File", a.owner as "User", a."GROUP" as "Group", a.text_permissions as "Permissions"
FROM
jac_data.unix_file_perms_v2 a
left join jac_data.unix_groups_v2 b on a.cli_id = b.cli_id and a."GROUP" = b.group_name
left join jac_data.unix_users_v3 c on a.cli_id = c.cli_id and a.owner = c.username
left join jac_data.linux_login_defs_v1 d on a.cli_id = d.cli_id and (
(d.sys_uid_max is not null and c.uid &gt; d.sys_uid_max)
or
(d.sys_uid_max is null and d.uid_min is not null and c.uid &gt;= d.uid_min)
)
left join jac_data.linux_login_defs_v1 dd on a.cli_id = dd.cli_id and (
(dd.sys_gid_max is not null and b.gid &gt; dd.sys_gid_max)
or
(dd.sys_gid_max is null and dd.gid_min is not null and b.gid &gt;= dd.gid_min)
or b.gid = 100
)
WHERE
a.text_permissions is not null
and a.text_permissions not like 'l%'
and a.text_permissions not like 's%'
and a.text_permissions not like 'p%'
and a.text_permissions not like 'b%'
and a.text_permissions not like 'c%'
and ( a.file like '/usr' or a.file like '/usr/%')
and (
a.text_permissions not like '________-_%'
or
(dd.cli_id is not null and a."GROUP" not in ($(OSR Excluded Groups)))
or
(d.cli_id is not null
and a.owner not in ($(OSR Excluded Users))
and a.owner not in (
select u.username
from jac_data.unix_users_v3 u
left join jac_data.unix_groups_v2 g on u.cli_id = g.cli_id	and u.gid = g.gid
left join jac_data.unix_group_members_v2 gm on u.cli_id = gm.cli_id	and u.gid = gm.gid
where g.group_name in ($(OSR Excluded Groups))))
)</scm:sql>
</cdf:check>
<cdf:remediation disable="false">
<cdf:description> Recursively check permission settings for other on "/usr" directory which must be r-x or more stringent. Also recursively check all directories and files for privileged Owner and Group and change them accordingly.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="131">
<cdf:TechSpecsEntriesRef id="114,221,222"/>
<cdf:requires idref="FilePermsV2-osr-etc"></cdf:requires>
<cdf:requires idref="GroupsV2"></cdf:requires>
<cdf:requires idref="LoginDefsV1"></cdf:requires>
<cdf:requires idref="UsersV3"></cdf:requires>
<cdf:title>Protecting Resources-OSRs/OSR \ETC Restrictions</cdf:title>
<cdf:ruleName>OSR_ETC_Restrictions</cdf:ruleName>
<cdf:description>UNIX OSR directory - Settings for other on this directory "/etc" must be r-x or more stringent. Must be owned by privileged Owner and Group. This requirement applied recursively.</cdf:description>
<scm:violationMessage>{1} {2}, Owner: {3}, Group: {4}, Permissions: {5}, Settings for other must be r-x or more stringent. Must be owned by privileged Owner and Group</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>SELECT
distinct a.cli_id,
case when d.cli_id is not null
then
case when a.text_permissions not like '________-_%'
then 'OSR Invalid Permissions and Invalid Owner or Group:'
else 'OSR Invalid Owner or Group:'
end
else 'OSR Invalid Permissions:'
end, a.file as "File", a.owner as "User", a."GROUP" as "Group", a.text_permissions as "Permissions"
FROM
jac_data.unix_file_perms_v2 a
left join jac_data.unix_groups_v2 b on a.cli_id = b.cli_id and a."GROUP" = b.group_name
left join jac_data.unix_users_v3 c on a.cli_id = c.cli_id and a.owner = c.username
left join jac_data.linux_login_defs_v1 d on a.cli_id = d.cli_id and (
(d.sys_uid_max is not null and c.uid &gt; d.sys_uid_max)
or
(d.sys_uid_max is null and d.uid_min is not null and c.uid &gt;= d.uid_min)
)
left join jac_data.linux_login_defs_v1 dd on a.cli_id = dd.cli_id and (
(dd.sys_gid_max is not null and b.gid &gt; dd.sys_gid_max)
or
(dd.sys_gid_max is null and dd.gid_min is not null and b.gid &gt;= dd.gid_min)
or b.gid = 100
)
WHERE
a.text_permissions is not null
and a.text_permissions not like 'l%'
and a.text_permissions not like 's%'
and a.text_permissions not like 'p%'
and a.text_permissions not like 'b%'
and a.text_permissions not like 'c%'
and ( a.file like '/etc' or a.file like '/etc/%')
and (
a.text_permissions not like '________-_%'
or
(dd.cli_id is not null and a."GROUP" not in ($(OSR Excluded Groups)))
or
(d.cli_id is not null
and a.owner not in ($(OSR Excluded Users))
and a.owner not in (
select u.username
from jac_data.unix_users_v3 u
left join jac_data.unix_groups_v2 g on u.cli_id = g.cli_id	and u.gid = g.gid
left join jac_data.unix_group_members_v2 gm on u.cli_id = gm.cli_id	and u.gid = gm.gid
where g.group_name in ($(OSR Excluded Groups))))
)</scm:sql>
</cdf:check>
<cdf:remediation disable="false">
<cdf:description>
Recursively check permission settings for other on "/etc" directory which must be r-x or more stringent. Also recursively check all directories and files for privileged Owner and Group and change them accordingly.
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="132">
<cdf:TechSpecsEntriesRef id="226,225"/>
<cdf:requires idref="GDPRV1">
</cdf:requires>
<cdf:title>Password Requirements/\etc\profile IBMsinit sh</cdf:title>
<cdf:ruleName>etc_profile_ibmsinit_sh</cdf:ruleName>
<cdf:description>/etc/profile. For systems containing PI: File must trigger an invocation of
. /etc/profile.d/IBMsinit.sh
and does not set/reset the time out control after that invocation.
Note: Some systems will have /etc/profile invoke /etc/profile.local; if that is the case, it is permissible for the 'call' of /etc/profile.d/IBMsinit.sh to be done from /etc/profile.local.</cdf:description>
<scm:violationMessage>GDPR: {1} {2}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT a.CLI_ID, a.PROFILE, a.MESSAGE
FROM JAC_DATA.GDPR_PROFILE_V1 a
WHERE
a.PROFILE = '/etc/profile'
OR a.PROFILE = '/etc/profile.local'
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="true">
<cdf:description>
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="133">
<cdf:TechSpecsEntriesRef id="227,225"/>
<cdf:requires idref="GDPRV1">
</cdf:requires>
<cdf:title>Password Requirements/\etc\csh.login IBMsinit csh</cdf:title>
<cdf:ruleName>etc_cshlogin_ibmsinit_csh</cdf:ruleName>
<cdf:description>/etc/csh.login. For systems containing PI:
If csh is installed, file must trigger an invocation of
source /etc/profile.d/IBMsinit.csh
and does not set/reset the time out control after that invocation.
Note: Some systems will have /etc/csh.login invoke /etc/csh.login.local; if that is the case, it is permissible for the 'call' of /etc/profile.d/IBMsinit.csh to be done from /etc/csh.login.local.
Note: existence and permissions of file established in earlier rule.
Note: The 'standard' package for installing csh is the package tcsh; however, any variant of csh installed will trigger this requirement.</cdf:description>
<scm:violationMessage>GDPR: {1} {2}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT a.CLI_ID, a.PROFILE, a.MESSAGE
FROM JAC_DATA.GDPR_PROFILE_V1 a
WHERE
a.PROFILE = '/etc/csh.login'
OR a.PROFILE = '/etc/csh.login.local'
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="true">
<cdf:description>
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="134">
<cdf:TechSpecsEntriesRef id="228,225"/>
<cdf:requires idref="GDPRV1">
</cdf:requires>
<cdf:title>Password Requirements/Automatic Logoff IBMsinit sh TMOUT</cdf:title>
<cdf:ruleName>auto_logoff_ibmsinit_sh</cdf:ruleName>
<cdf:description>/etc/profile.d/IBMsinit.sh. For systems containing PI, set systems to terminate a session after 6 hours of inactivity:
File must  contain at least:
TMOUT=21600
export TMOUT
Note: A shorter time frame may be specified.
Note: Verification of the existence and permissions of the file is specified in an earlier rule.</cdf:description>
<scm:violationMessage>GDPR: {1} {2}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT a.CLI_ID, a.PROFILE, CASE
WHEN a.LOGOFF_TIMOUT IS NULL
THEN 'For systems containing PI, set systems to terminate a session after 6 hours of inactivity. File must  contain "TMOUT=21600" followed by "export TMOUT". A shorter time frame may be specified.'
ELSE 'System set to terminate after ' || trim(char(a.LOGOFF_TIMOUT)) || ' seconds, it shoud be 21600 or shorter time frame.' END
FROM JAC_DATA.GDPR_AUTO_LOGOFF_SHELL_V1 a
WHERE
a.PROFILE = '/etc/profile.d/IBMsinit.sh'
AND
(a.LOGOFF_TIMOUT IS NULL OR LOGOFF_TIMOUT &gt; 21600)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="true">
<cdf:description>
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="135">
<cdf:TechSpecsEntriesRef id="229,225"/>
<cdf:requires idref="GDPRV1">
</cdf:requires>
<cdf:title>Password Requirements/Automatic Logoff IBMsinit csh autologout</cdf:title>
<cdf:ruleName>auto_logoff_ibmsinit_csh</cdf:ruleName>
<cdf:description>/etc/profile.d/IBMsinit.csh. For systems containing PI, set systems to terminate a session after 6 hours of inactivity:
If csh is installed, file must contain at least:
set autologout=360
Note: A shorter time frame may be specified.
Note: The 'standard' package for installing csh is the package tcsh; however, any variant of csh installed will trigger this requirement.
Note: Verification of the existence and permissions of the file is specified in an earlier rule.</cdf:description>
<scm:violationMessage>GDPR: {1} {2}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT a.CLI_ID, a.PROFILE, CASE
WHEN a.LOGOFF_TIMOUT IS NULL
THEN 'For systems containing PI, set systems to terminate a session after 6 hours of inactivity. File must  contain "set autologout=360". A shorter time frame may be specified.'
ELSE 'System set to terminate after ' || trim(char(a.LOGOFF_TIMOUT)) || ' minutes, it shoud be 360 or shorter time frame.' END
FROM JAC_DATA.GDPR_AUTO_LOGOFF_SHELL_V1 a
WHERE
a.PROFILE = '/etc/profile.d/IBMsinit.csh'
AND
(a.LOGOFF_TIMOUT IS NULL OR LOGOFF_TIMOUT &gt; 360)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="true">
<cdf:description>
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="136">
<cdf:TechSpecsEntriesRef id="230,225"/>
<cdf:requires idref="GDPRV1">
</cdf:requires>
<cdf:title>Password Requirements/Automatic Logoff IBMsinit skeleton files</cdf:title>
<cdf:ruleName>auto_logoff_skeleton_files</cdf:ruleName>
<cdf:description>For systems containing PI, set systems to terminate a session after a defined period of inactivity:  Ensure time out value is not overridden or is correctly established inside skeleton files: /etc/skel/.cshrc, /etc/skel/.login, /etc/skel/.profile, /etc/skel/.bashrc,
/etc/skel/.bash_profile, /etc/skel/.bash_login, /etc/skel/.tcshrc,</cdf:description>
<scm:violationMessage>GDPR: {1} {2}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT a.CLI_ID, a.PROFILE, CASE
WHEN a.PROFILE IN ('/etc/skel/.cshrc','/etc/skel/.login','/etc/skel/.tcshrc')
THEN 'System set to terminate after ' || trim(char(a.LOGOFF_TIMOUT)) || ' minutes of inactivity in sekeleton file. Either does not override the time out for the user, or encodes the appropriate time. It shoud be 360 or shorter time frame.'
WHEN a.PROFILE IN ('/etc/skel/.profile','/etc/skel/.bashrc','/etc/skel/.bash_profile', '/etc/skel/.bash_login')
THEN 'System set to terminate after ' || trim(char(a.LOGOFF_TIMOUT)) || ' seconds of inactivity in sekeleton file. Either does not override the time out for the user, or encodes the appropriate time. It shoud be 21600 or shorter time frame.' END
FROM JAC_DATA.GDPR_AUTO_LOGOFF_SHELL_V1 a
WHERE
(a.PROFILE IN ('/etc/skel/.cshrc','/etc/skel/.login','/etc/skel/.tcshrc')
AND a.LOGOFF_TIMOUT &gt; 360)
OR
(a.PROFILE IN ('/etc/skel/.profile','/etc/skel/.bashrc','/etc/skel/.bash_profile', '/etc/skel/.bash_login')
AND a.LOGOFF_TIMOUT &gt; 21600)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="true">
<cdf:description>
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="137">
<cdf:TechSpecsEntriesRef id="232,225"/>
<cdf:requires idref="ShellsV1">
</cdf:requires>
<cdf:title>Password Requirements/Automatic Logoff support shells</cdf:title>
<cdf:ruleName>auto_logoff_support_shells</cdf:ruleName>
<cdf:description>For systems containing PI: /etc/shells should not contains other shells then from the following list: /bin/sh
/bin/bash
/sbin/nologin
/usr/bin/sh
/usr/bin/bash
/usr/sbin/nologin
/bin/tcsh
/bin/csh
/bin/ksh
/bin/rksh
/bin/false
/bin/ksh93
/usr/bin/ksh
/usr/bin/rksh
/usr/bin/ksh93</cdf:description>
<scm:violationMessage>GDPR: {1} {2}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT a.CLI_ID, a.SHELL, 'Ensure that /etc/shells only allows users to select shells which support time out.'
FROM JAC_DATA.UNIX_SHELLS_V1 a
WHERE
a.SHELL NOT IN (
'/bin/sh',
'/bin/bash',
'/sbin/nologin',
'/usr/bin/sh',
'/usr/bin/bash',
'/usr/sbin/nologin',
'/bin/tcsh',
'/bin/csh',
'/bin/kcsh',
'/bin/rkcsh',
'/bin/false',
'/bin/ksh93',
'/usr/bin/ksh',
'/usr/bin/rksh',
'/usr/bin/ksh93')
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="true">
<cdf:description>
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="138">
<cdf:TechSpecsEntriesRef id="233"/>
<cdf:requires idref="RSyslogV1">
</cdf:requires>
<cdf:title>Logging/Logging auth in external system</cdf:title>
<cdf:ruleName>logging_auth_external</cdf:ruleName>
<cdf:description>On systems that process PI, set syslog to send 'auth' data to remote server via /etc/rsyslog.conf file:
auth.$1 @@$2

Where $1 is 'info' or 'debug' and $2 is the IP address of remote syslog server.  @@ may be replaced by @.</cdf:description>
<scm:violationMessage>GDPR: {1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT a.CLI_ID, 'Set rsyslog to send "auth" data to remote server via /etc/rsyslog.conf file'
FROM JAC_DATA.UNIX_RSYSLOG_V1 a
WHERE
a.CLI_ID NOT IN (
SELECT CLI_ID FROM JAC_DATA.UNIX_RSYSLOG_V1
WHERE
FACILITY = 'auth'
AND (PRIORITY = 'info' OR PRIORITY = 'debug')
AND DESTINATION LIKE '@%'
)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="true">
<cdf:description>
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="139">
<cdf:TechSpecsEntriesRef id="234"/>
<cdf:requires idref="RSyslogV1">
</cdf:requires>
<cdf:title>Logging/Logging authpriv in external system</cdf:title>
<cdf:ruleName>logging_authpriv_external</cdf:ruleName>
<cdf:description>On systems that process PI, set syslog to send 'authpriv' data to remote server via /etc/rsyslog.conf file:
authpriv.$1 @@$2

Where $1 is 'info' or 'debug' and $2 is the IP address of remote syslog server.  @@ may be replaced by @.</cdf:description>
<scm:violationMessage>GDPR: {1} </scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT a.CLI_ID, 'Set rsyslog to send "authpriv" data to remote server via /etc/rsyslog.conf file'
FROM JAC_DATA.UNIX_RSYSLOG_V1 a
WHERE
a.CLI_ID NOT IN (
SELECT CLI_ID FROM JAC_DATA.UNIX_RSYSLOG_V1
WHERE
FACILITY = 'authpriv'
AND (PRIORITY = 'info' OR PRIORITY = 'debug')
AND DESTINATION LIKE '@%'
)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="true">
<cdf:description>
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="140">
<cdf:TechSpecsEntriesRef id="235"/>
<cdf:requires idref="PlatformInfoV2"></cdf:requires>
<cdf:requires idref="ChronydV1"></cdf:requires>
<cdf:requires idref="NtpdV1"></cdf:requires>
<cdf:title>Logging/Synchronized system clocks</cdf:title>
<cdf:ruleName>synchronized_system_clocks</cdf:ruleName>
<cdf:description>Synchronized system clocks, ensure it is active.</cdf:description>
<scm:violationMessage>{1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT a.CLI_ID, 'ntpd or chronyd must be running.'
FROM JAC_DATA.SEC_PLATFORM_INFOV2 a
LEFT JOIN JAC_DATA.UNIX_CHRONYD_V1 b ON a.CLI_ID = b.CLI_ID  AND b.PID IS NOT NULL
LEFT JOIN JAC_DATA.UNIX_NTPD_V1 c ON a.CLI_ID = c.CLI_ID  AND c.PID IS NOT NULL
WHERE b.CLI_ID IS NULL AND c.CLI_ID IS NULL
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="true">
<cdf:description>
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="141">
<cdf:TechSpecsEntriesRef id="236,237"/>
<cdf:requires idref="PlatformInfoV2"></cdf:requires>
<cdf:requires idref="ChronydV1"></cdf:requires>
<cdf:requires idref="NtpdV1"></cdf:requires>
<cdf:title>Logging/Minimum configuration for chronyd</cdf:title>
<cdf:ruleName>minimum_configuration_for_chronyd</cdf:ruleName>
<cdf:description>If chronyd is active, ensure at least one server is configured for access.  Ensure task is not running with excessive privilege, use the special id chrony.</cdf:description>
<scm:violationMessage>{1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT  a.CLI_ID, CASE WHEN bb.CLI_ID IS NULL THEN 'At least one pool or server must be specified for '|| b.CONFIG_FILE
ELSE 'Chronyd is running as ' || b.USERNAME || '. Must be running as ' || $(Chrony user) || '.' end
FROM JAC_DATA.SEC_PLATFORM_INFOV2 a
LEFT JOIN JAC_DATA.UNIX_CHRONYD_V1 b ON a.CLI_ID = b.CLI_ID AND b.PID IS NOT NULL
LEFT JOIN JAC_DATA.UNIX_CHRONYD_CONFIGURATION_V1 bb ON b.CLI_ID = bb.CLI_ID AND b.CONFIG_FILE = bb.CONFIG_FILE
AND (bb.LINE LIKE 'server %' OR bb.LINE LIKE 'pool %')
WHERE
b.CLI_ID IS NOT NULL
AND (b.USERNAME != $(Chrony user) OR bb.CLI_ID IS NULL)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="true">
<cdf:description>
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="142">
<cdf:TechSpecsEntriesRef id="238"/>
<cdf:requires idref="PlatformInfoV2"></cdf:requires>
<cdf:requires idref="ChronydV1"></cdf:requires>
<cdf:requires idref="NtpdV1"></cdf:requires>
<cdf:title>Logging/Ntpd has secure defaults.</cdf:title>
<cdf:ruleName>ntpd_has_secure_defaults</cdf:ruleName>
<cdf:description>if ntpd is active, ensure task restrict defaults are set to secure values.</cdf:description>
<scm:violationMessage>{1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT a.CLI_ID, 'Key defaults for both ip4 and ip6 must be set to: nomodify notrap nopeer noquery. Configuration file ' || b.CONFIG_FILE
FROM JAC_DATA.SEC_PLATFORM_INFOV2 a
LEFT JOIN JAC_DATA.UNIX_NTPD_V1 b ON a.CLI_ID = b.CLI_ID AND b.PID IS NOT NULL
LEFT JOIN JAC_DATA.UNIX_NTPD_CONFIGURATION_V1 u ON b.CLI_ID = u.CLI_ID AND b.CONFIG_FILE = u.CONFIG_FILE AND
u.LINE LIKE 'restrict %'
AND u.LINE NOT LIKE '% -6 %'
AND u.LINE LIKE '% default %'
AND u.LINE LIKE '%nomodify%'
AND u.LINE LIKE '%notrap%'
AND u.LINE LIKE '%nopeer%'
AND u.LINE LIKE '%noquery%'
LEFT JOIN JAC_DATA.UNIX_NTPD_CONFIGURATION_V1 uu ON b.CLI_ID = uu.CLI_ID AND b.CONFIG_FILE = uu.CONFIG_FILE AND
uu.LINE LIKE 'restrict %'
AND uu.LINE LIKE '% -6 %'
AND uu.LINE LIKE '% default %'
AND uu.LINE LIKE '%nomodify%'
AND uu.LINE LIKE '%notrap%'
AND uu.LINE LIKE '%nopeer%'
AND uu.LINE LIKE '%noquery%'
WHERE
b.CLI_ID IS NOT NULL AND (u.CLI_ID IS NULL OR uu.CLI_ID IS null)
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="true">
<cdf:description>
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="143">
<cdf:TechSpecsEntriesRef id="239"/>
<cdf:requires idref="PlatformInfoV2"></cdf:requires>
<cdf:requires idref="ChronydV1"></cdf:requires>
<cdf:requires idref="NtpdV1"></cdf:requires>
<cdf:title>Logging/Minimum configuration for ntpd</cdf:title>
<cdf:ruleName>minimum_configuration_for_ntpd</cdf:ruleName>
<cdf:description>If ntpd is active, ensure at least one server is configured for access.</cdf:description>
<scm:violationMessage>{1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT a.CLI_ID, 'At least one pool or server must be specified for ' || b.CONFIG_FILE
FROM JAC_DATA.SEC_PLATFORM_INFOV2 a
LEFT JOIN JAC_DATA.UNIX_NTPD_V1 b ON a.CLI_ID = b.CLI_ID AND b.PID IS NOT NULL
LEFT JOIN JAC_DATA.UNIX_NTPD_CONFIGURATION_V1 bb ON b.CLI_ID = bb.CLI_ID AND b.CONFIG_FILE = bb.CONFIG_FILE
AND (bb.LINE LIKE 'server %' OR bb.LINE LIKE 'pool %')
WHERE
b.CLI_ID IS NOT NULL
AND  bb.CLI_ID IS NULL
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="true">
<cdf:description>
</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="144">
<cdf:TechSpecsEntriesRef id="245"/>
<cdf:requires idref="UsersV3">
</cdf:requires>
<cdf:title>Password Requirements/Password passwd specification</cdf:title>
<cdf:ruleName>Password_passwd_specification</cdf:ruleName>
<cdf:description>In /etc/passwd, password (second field) cannot be assigned the null value (::) as this would allow the id to be accessed without entering a password or using the 'empty' (null) password if nullok is ever specified.  Never allow this mechanism, as all id's have read access to /etc/passwd and can search for this condition.</cdf:description>
<scm:violationMessage>Account: {1} have "empty" (null) password. In /etc/passwd, password (second field) cannot be assigned the null value.</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT a.CLI_ID, a.USERNAME
FROM JAC_DATA.UNIX_USERS_V3 a
WHERE a.IS_PASSWD_EMPTY = 1
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="true">
<cdf:description>
</cdf:description>
</cdf:remediation>
</cdf:Rule>

<cdf:Rule id="145">
<cdf:requires idref="UsersV3">
</cdf:requires>
<cdf:title>Summary Information/Audit options</cdf:title>
<cdf:ruleName>HCL_audit_Options</cdf:ruleName>
<cdf:description>Audit option used</cdf:description>
<scm:violationMessage>##AUDIT_OPTIONS##</scm:violationMessage>
<scm:priority>informational</scm:priority>
<cdf:check>
<scm:sql>
SELECT 1 FROM SYSIBM.SYSDUMMY1
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="true">
<cdf:description>Not supported - no remediation</cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="146">
<cdf:TechSpecsEntriesRef id="240,242"/>
<cdf:requires idref="SELinuxV1">
</cdf:requires>
<cdf:requires idref="AppArmorV1">
</cdf:requires>
<cdf:title>System Settings/SELinux AppArmor install requirement</cdf:title>
<cdf:ruleName>SELinux_AppArmor_install</cdf:ruleName>
<cdf:description>Ensure SELinux or AppArmor is installed and enabled</cdf:description>
<scm:violationMessage>{1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT a.cli_id, 'SELinux or AppArmor should be installed and enabled'
FROM JAC_DATA.SEC_PLATFORM_INFOV2 a
LEFT JOIN JAC_DATA.SELINUX_STATUS_V1 b ON a.CLI_ID = b.CLI_ID AND b.STATUS = 'enabled'
LEFT JOIN JAC_DATA.APPARMOR_STATUS_V1 c ON a.CLI_ID = c.CLI_ID AND c.STATUS = 'loaded'
WHERE
b.CLI_ID IS NULL AND c.CLI_ID IS NULL
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="true">
<cdf:description></cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="147">
<cdf:TechSpecsEntriesRef id="241"/>
<cdf:requires idref="SELinuxV1">
</cdf:requires>
<cdf:title>System Settings/SELinux current mode requirement</cdf:title>
<cdf:ruleName>SELinux_current_mode</cdf:ruleName>
<cdf:description>Where SELinux is enabled, require 'enforcing' or 'permissive' mode</cdf:description>
<scm:violationMessage>{1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT a.CLI_ID, 'SELinux enabled with forbidden mode: ' || a.CURRENT_MODE
FROM JAC_DATA.SELINUX_STATUS_V1 a
WHERE
a.STATUS = 'enabled'
AND a.CURRENT_MODE NOT IN ($(SELinux allowed modes))
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="true">
<cdf:description></cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:Rule id="148">
<cdf:TechSpecsEntriesRef id="243"/>
<cdf:requires idref="AppArmorV1">
</cdf:requires>
<cdf:title>System Settings/AppArmor profile mode requirement</cdf:title>
<cdf:ruleName>AppArmor_profile_mode</cdf:ruleName>
<cdf:description>If AppArmor is installed and loaded, then apparmor_status should shows profiles in complain mode or more strict</cdf:description>
<scm:violationMessage>{1}</scm:violationMessage>
<scm:priority>normal</scm:priority>
<cdf:check>
<scm:sql>
SELECT DISTINCT a.CLI_ID, 'AppArmor profile: ' || b."OBJECT" || ' loaded with forbidden mode: ' || b.MODE
FROM JAC_DATA.APPARMOR_STATUS_V1 a
LEFT JOIN JAC_DATA.APPARMOR_OBJECTS_V1 b ON a.CLI_ID = b.CLI_ID
WHERE
a.STATUS = 'loaded'
AND b."TYPE" = 'profiles' AND b.MODE NOT IN ($(AppArmor allowed profiles modes))
</scm:sql>
</cdf:check>
<cdf:remediation parameters="" disable="true">
<cdf:description></cdf:description>
</cdf:remediation>
</cdf:Rule>
<cdf:TechSpecsEntriesList>
<cdf:TechSpecsEntries id="1">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.1.1</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>PASS_MAX_DAYS</cdf:SystemValue_Parameter>
<cdf:Description>Default maximum password age.  Ensures that the setting is correctly applied to new id's</cdf:Description>
<cdf:RecommendedValue>/etc/login.defs must include this line:
PASS_MAX_DAYS       90</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="2">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.1.2</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>PASS_MAX_DAYS</cdf:SystemValue_Parameter>
<cdf:Description>Per-userid password age setting, in days, via field 5 of each record, in /etc/shadow
Note:  This row is not required on userids without a password, and on userids that meet the exceptions to password rules criteria below.
Note: This setting in /etc/shadow is not required on userids without a password, nor is it required on userids that meet the requirements in "Exemptions to password rules</cdf:Description>
<cdf:RecommendedValue>Field 5 of /etc/shadow must be 90.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="3">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.2.0</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>PASS_MIN_LEN, password complexity</cdf:SystemValue_Parameter>
<cdf:Description>Require a minimum of fifteen characters in length. If the password or passphrase cannot be at least fifteen characters, it must be the longest technically possible.
Ensure mix of character types in password and reject passwords which include the userID name</cdf:Description>
<cdf:RecommendedValue>One of these three options must be implemented:
* Parameters of "minlen=15 dcredit=-1 ucredit=0 lcredit=-1 ocredit=0 "   in $PAMFILES in  "password $CONTROL pam_pwquality.so ..." stanza
* Parameters of "minlen=15 dcredit=-1 ucredit=0 lcredit=-1 ocredit=0 reject_username" in $PAMFILES to the "password $CONTROL pam_cracklib.so ..." stanza
* "password $CONTROL pam_pwquality.so ..." stanza exists in /etc/pam.d/system-auth AND /etc/pam.d/password-auth with none of these parameters, AND the parameters of minlen = 15, dcredit= -1, ucredit=0, lcredit=-1, and ocredit=0 are specified in /etc/security/pwquality.conf
Note: $PAMFILES will be 'common-password' for SLES and Debian, for all other distributions will be: /etc/pam.d/system-auth AND /etc/pam.d/password-auth
Note: $CONTROL in the above examples must be one of "required", or "requisit".
Note: Where parameters such as: try_first_pass local_users_only retry=x authtok_type= 'text' type='text' are supported by the modules, they may be added. 'text' may be replaced with desired text. x may be any digit.
Note: Use of full path and/or $ISA to pam modules is optional.
Note: pam_pwquality always does 'reject_username'.  As such, there is no equivalent parameter for that module.
</cdf:RecommendedValue>
<cdf:Comments>Debian support implemented but not tested</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="4">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.3.1</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Minimum Password Age</cdf:SystemValue_Parameter>
<cdf:Description>The default minimum number of days that must elapse between user-initiated password changes</cdf:Description>
<cdf:RecommendedValue>/etc/login.defs must include this line:   PASS_MIN_DAYS 1</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="5">
<cdf:Coverage>Yellow</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.3.2</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Per-userid Minimum Password Age</cdf:SystemValue_Parameter>
<cdf:Description>The Per-userid minimum number of days that must elapse between user-initiated password changes</cdf:Description>
<cdf:RecommendedValue>Field 4 of /etc/shadow must be 1 for all userids with a password assigned.  Exception: for shared userIDs where individual accountability is maintained by process controls, it may be 0.</cdf:RecommendedValue>
<cdf:Comments>Exception for shared id's can not be automatically health checked</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="6">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.4.1</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Password History</cdf:SystemValue_Parameter>
<cdf:Description>Prevent reuse of last eight passwords.</cdf:Description>
<cdf:RecommendedValue>RedHat Enterprise Linux/RedHat Application Server (any version):
password sufficient pam_unix.so remember=7 use_authtok sha512 shadow
* This statement must appear in /etc/pam.d/system-auth, if the file exists.
* If /etc/pam.d/system-auth does NOT exist, this statement must appear in /etc/pam.d/login, /etc/pam.d/passwd, /etc/pam.d/sshd and /etc/pam.d/su.

Note: Use of full path and/or $ISA to pam modules is optional.
Note:  For Red Hat Enterprise Linux V6 and later:  If the system-auth file is in use, this control must ADDITIONALLY be applied to the /etc/pam.d/password-auth file.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="7">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.4.2</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Password History</cdf:SystemValue_Parameter>
<cdf:Description>Prevent reuse of last eight passwords.</cdf:Description>
<cdf:RecommendedValue>SLES
/etc/pam.d/common-password must exist and include these one of these two settings
Option 1 -  For any SLES version:
password $CONTROL pam_pwcheck.so remember=8 use_authtok nullok
Option 2  for SLES 10 and earlier
password sufficient pam_unix_passwd.so remember=7 use_authtok sha512 shadow
* For SLES 10, the setting indicated in Option 1 or 2 must appear in /etc/pam.d/common-password, if it exists.  If /etc/pam.d/common-password does NOT exist, the setting from Option 1 or 2 must appear in /etc/pam.d/login, /etc/pam.d/passwd, /etc/pam.d/sshd and /etc/pam.d/su.
Option 3 for SLES 11 and later
password  $CONTROL    pam_pwhistory.so remember=8
Note: $CONTROL in the above examples must be one of "required", or "requisite".
Note: Use of full path and/or $ISA to pam modules is optional.
Note:  Additional parameters such as 'retry=n', may additionally be specified.  n may be any digit.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="8">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.4.3</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Password History</cdf:SystemValue_Parameter>
<cdf:Description>Prevent reuse of last eight passwords.</cdf:Description>
<cdf:RecommendedValue>Debian 4:
password sufficient pam_unix_passwd.so remember=7 use_authtok sha512 shadow
* This statement must appear in /etc/pam.d/common-password, if the file exists.
* If /etc/pam.d/common-password does NOT exist, this statement must appear in /etc/pam.d/login, /etc/pam.d/passwd, /etc/pam.d/sshd and /etc/pam.d/su.

Note: Use of full path and/or $ISA to pam modules is optional.</cdf:RecommendedValue>
<cdf:Comments>Debian support implemented but not tested</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="9">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.4.4</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Password History</cdf:SystemValue_Parameter>
<cdf:Description>Prevent reuse of last eight passwords.</cdf:Description>
<cdf:RecommendedValue>Debian 5 and later.
/etc/pam.d/common-password must exist and include these one of these two settings
password sufficient pam_unix.so remember=7 use_authtok sha512 shadow

* This statement must appear in /etc/pam.d/common-password.
* If /etc/pam.d/system-auth does NOT exist, this statement must appear in /etc/pam.d/login, /etc/pam.d/passwd, /etc/pam.d/sshd and /etc/pam.d/su.

Note: Use of full path and/or $ISA to pam modules is optional.</cdf:RecommendedValue>
<cdf:Comments>Debian support implemented but not tested</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="10">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>Process requirement no requirement to B or S</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.5</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Immediately expire new and manually reset passwords</cdf:SystemValue_Parameter>
<cdf:Description>Force users to change password immediately for a new or reset account unless change was performed by the user or an automated process.</cdf:Description>
<cdf:RecommendedValue>chage -d 0 &lt;userid&gt;  Note: This is a process directive and cannot be health checked.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="11">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.6.0</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>loginretries
</cdf:SystemValue_Parameter>
<cdf:Description>Threshold for consecutive failed login attempts.  Note: Must precede any lines of same module-type with a control-flag of sufficient with the exception of pam_deny.so</cdf:Description>
<cdf:RecommendedValue>Red Hat 5:
auth required pam_tally.so deny=5
account required pam_tally.so
Red Hat 6 or above:
auth required pam_tally2.so deny=5
account required pam_tally2.so
Notes:
* If /etc/pam.d/system-auth exists, this is the control file. Otherwise, it must appear in all /etc/pam.d control files which require login authentication.
* Use of full path and/or $ISA to pam modules is optional.
* For Red Hat Enterprise Linux V6 and later:  If the system-auth file is in use, this control must ADDITIONALLY be applied to the /etc/pam.d/password-auth file.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="12">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.6.1</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>loginretries</cdf:SystemValue_Parameter>
<cdf:Description>Threshold for consecutive failed login attempts.  Note: Must precede any lines of same module-type with a control-flag of sufficient with the exception of pam_deny.so</cdf:Description>
<cdf:RecommendedValue>
For Debian and SLES 10 and later
Where pam_tally.so is in use:
/etc/pam.d/common-auth must exist and include these settings:
auth required pam_tally.so deny=5 onerr=fail per_user no_lock_time
/etc/pam.d/common-account must exist and include these settings:
account required pam_tally.so
If pam_tally2.so is in use:
/etc/pam.d/common-auth must exist and include these settings:
auth required pam_tally2.so deny=5 onerr=fail per_user no_lock_time
/etc/pam.d/common-account must exist and include these settings:
account required pam_tally2.so
Notes:
* Use of full path and/or $ISA to pam modules is optional.
* pam_tally2.so may be used in place of pam_tally.so on any level of Linux which supports pam_tally2.so
</cdf:RecommendedValue>
<cdf:Comments>Debian support implemented but not tested</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="13">
<cdf:Coverage>Yellow</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.7.1</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>ROOT</cdf:SystemValue_Parameter>
<cdf:Description>Password must be assigned</cdf:Description>
<cdf:RecommendedValue>A compliant password must be assigned, must be expiring,and must be included in the inventory of shared IDs where individual accountability is not maintained by technical controls, and handled as all other ID's in that inventory.
-or-
The ID is set so that no password can be used to authenticate by any means and may have the value for maximum password age set to 0 (non-expiring).</cdf:RecommendedValue>
<cdf:Comments>Inventory is not validated automatically, it is for manual checking.</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="14">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.7.2</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>ROOT</cdf:SystemValue_Parameter>
<cdf:Description>Login access must be restricted to the physical console, or to a method that provides accountability to an individual</cdf:Description>
<cdf:RecommendedValue>Login access to account must be restricted to the physical console, or to a method that provides accountability to an individual.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="15">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.7.3</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>System ID's:
bin, daemon, adm, lp, sync, shutdown, halt, mail, uucp, operator, games, gopher, ftp, nobody, dbus, usbmuxd, rpc, avahi-autoipd, vcsa, rtkit, saslauth, postfix, avahi, ntp, apache, radvd, rpcuser, nfsnobody, qemu, haldaemon, nm-openconnect, pulse, gsanslcd, gdm, sshd, tcpdump</cdf:SystemValue_Parameter>
<cdf:Description>Access via Password must be blocked, or the ID treated as shared.</cdf:Description>
<cdf:RecommendedValue>Password must not be assigned for these system IDs unless there is a documented business reason.  If a password is assigned to a system ID, the system ID must be included in the inventory of shared IDs where individual accountability is not maintained by technical controls, and handled as all other ID's in that inventory.</cdf:RecommendedValue>
<cdf:Comments>Inventory is not validated automatically, it is for manual checking.</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="16">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.8.1</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Identify and Authenticate Users</cdf:SystemValue_Parameter>
<cdf:Description>Requirement for controlling shared userids</cdf:Description>
<cdf:RecommendedValue>Sharing of passwords (and accessing the account via the su command) is not considered a technical control for maintaining accountability. Instead, a tool that provides individual accountability via a technical control (such as sudo) is required. See the appropriate technical specification (e.g. sudo) for specific implementation and health checking requirements. If the technical controls for IBM userids do not provide full individual accountability, additional process controls approved by IBM management must also be used . Lack of technical controls to ensure individual accountability increases the risk of unauthorized actions going undetected. </cdf:RecommendedValue>
<cdf:Comments>Nothing to health check. See the appropriate technical specification (e.g. sudo) for specific implementation and health checking requirements.</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="17">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.8.2</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>UID</cdf:SystemValue_Parameter>
<cdf:Description>Prevent UID reuse</cdf:Description>
<cdf:RecommendedValue>Each uid must only be used once</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="18">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.8.3</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>GID</cdf:SystemValue_Parameter>
<cdf:Description>Prevent GID reuse</cdf:Description>
<cdf:RecommendedValue>Each gid must only be used once</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="19">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.9.0</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Exemptions to password rules</cdf:SystemValue_Parameter>
<cdf:Description>Non-expiring passwords</cdf:Description>
<cdf:RecommendedValue>Refer to section 5.0 for list of privileged users which can not have a non expiring password.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="20">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.9.1</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Exemptions to password rules</cdf:SystemValue_Parameter>
<cdf:Description>Non-expiring password</cdf:Description>
<cdf:RecommendedValue>Any ID, including root or those indicated in section 5.0, which is set so that no password
can be used to authenticate by any means may have the 'password' set to non-expiring (maxage=0).</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="21">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>Informational requirement no requirement to B or S</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.10.0</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Exemptions to password rules Option A: </cdf:SystemValue_Parameter>
<cdf:Description>User stanzas with the following attributes set are allowed to have non-expiring passwords: </cdf:Description>
<cdf:RecommendedValue>No value to be set</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="22">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.10.1</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/passwd</cdf:SystemValue_Parameter>
<cdf:Description>direct or remote login</cdf:Description>
<cdf:RecommendedValue>Value of login shell attribute in /etc/passwd must be /bin/false or /sbin/nologin</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="23">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.10.2</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/ftpusers, /etc/vsftpd.ftpusers or /etc/vsftpd/ftpusers</cdf:SystemValue_Parameter>
<cdf:Description>Restrict ftp access
Note: Filename is dependent on which ftp server is installed.
Note: Only required if ftp is installed and enabled.</cdf:Description>
<cdf:RecommendedValue>Id must exist in file</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="24">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>Informational requirement no requirement to B or S</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.11.0</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Exemptions to password rules Option B: </cdf:SystemValue_Parameter>
<cdf:Description>Locked userids are allowed to have a non-expiring password:</cdf:Description>
<cdf:RecommendedValue>No value to be set</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="25">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.11.1</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/shadow</cdf:SystemValue_Parameter>
<cdf:Description>Copy of passwd file containing the encrypted passwords</cdf:Description>
<cdf:RecommendedValue>"!!" or "!" followed by an encrypted password string which indicates a locked account</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="26">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>Informational requirement no requirement to B or S</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.12.0</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Exemptions to password rules Option C: </cdf:SystemValue_Parameter>
<cdf:Description>Userids configured to have no password may be treated as if they have a non-expiring password:</cdf:Description>
<cdf:RecommendedValue>No value to be set</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="27">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.12.1</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/shadow</cdf:SystemValue_Parameter>
<cdf:Description>Copy of passwd file containing the encrypted passwords</cdf:Description>
<cdf:RecommendedValue>"x","!", "!!", or "*" specified in the password (2nd) field of the userid.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="28">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>Informational requirement no requirement to B or S</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.13.0</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Exemptions to password rules Option D: </cdf:SystemValue_Parameter>
<cdf:Description>User stanzas with the following attributes set are allowed to have non-expiring passwords: </cdf:Description>
<cdf:RecommendedValue>No value to be set</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="29">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.13.1.0</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Deny access file</cdf:SystemValue_Parameter>
<cdf:Description>Rules file used by PAM (Pluggable Authentication Modules) to control system authentication                                     </cdf:Description>
<cdf:RecommendedValue>For Red Hat:
/etc/pam.d/system-auth and /etc/pam.d/password-auth must exist and include these settings
auth required /lib/security/$ISA/pam_listfile.so item=user sense=deny file=/etc/security/$FILENAME onerr=succeed
Note: This entry must precede any entries of type auth whose control field is set to the value sufficient.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="30">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.13.1.1</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Deny access file</cdf:SystemValue_Parameter>
<cdf:Description>Rules file used by PAM (Pluggable Authentication Modules) to control system authentication                                     </cdf:Description>
<cdf:RecommendedValue>For Debian and SLES:
/etc/pam.d/common-auth must exist and include these settings
auth required /lib/security/$ISA/pam_listfile.so item=user sense=deny file=/etc/security/$FILENAME onerr=succeed
Note: This entry must precede any entries of type auth whose control field is set to the value sufficient.
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="31">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.13.2</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/security/$FILENAME</cdf:SystemValue_Parameter>
<cdf:Description>File containing a list of userids, one per line, that are not allowed to perform an interactive login to the system</cdf:Description>
<cdf:RecommendedValue>Note: The actual filename may vary, but it must be placed in the /etc/security directory and be identical to the filename used in the preceding rule.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="32">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.13.3</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/ftpusers, /etc/vsftpd.ftpusers or /etc/vsftpd/ftpusers</cdf:SystemValue_Parameter>
<cdf:Description>Restrict ftp access
Note: Filename is dependent on which ftp server is installed.
Note: Only required if ftp is installed and enabled.</cdf:Description>
<cdf:RecommendedValue>Id must exist in file</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="33">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.13.4</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>etc/ssh/sshd_config</cdf:SystemValue_Parameter>
<cdf:Description>Prevent ssh login from bypassing pam by setting "UsePAM yes" or enabling the AllowGroups directive and not listing any group of which the user is a member. Note: If your version of openssh-server does not support the UsePAM directive then you must use the AllowGroups directive and the userid must NOT be a member of any groups listed as parameters to this directive.</cdf:Description>
<cdf:RecommendedValue>UsePAM yes</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="34">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.2.1.1</cdf:SectionNumber>
<cdf:SectionHeading>Logging</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Login success or failure</cdf:SystemValue_Parameter>
<cdf:Description>Requirements for systems that use syslog</cdf:Description>
<cdf:RecommendedValue>The following requirements cover RedHat, and SLES.
File:/etc/syslog.conf
*.info;mail.none;authpriv.none;cron.none /var/log/messages
authpriv.* /var/log/secure
The following requirements cover Debian Linux:
auth,authpriv.* /var/log/auth.log
*.*;auth,authpriv.none -/var/log/syslog
*.=info;*.=notice;*.=warning; auth,authpriv.none; cron,daemon.none; mail,news.none -/var/log/messages
Note: The use of the "-" in "-/var/log/...", which indicates that buffered writes are allowed, is optional in any Linux syslog configuration.
Note: More extensive logging is permissible, e.g "cron.none" may be removed from the facility section of the control stanza for /var/log/messages.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="35">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.2.1.2</cdf:SectionNumber>
<cdf:SectionHeading>Logging</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Login success or failure</cdf:SystemValue_Parameter>
<cdf:Description>Requirements for systems that use syslog-ng:</cdf:Description>
<cdf:RecommendedValue>File:/etc/syslog-ng/syslog-ng.conf
filter f_authpriv { facility(auth,authpriv); };
destination authpriv { file("/var/log/secure"); };
log { source(src); filter(f_authpriv); destination(authpriv); };
Note: More extensive logging beyond the minimums listed above is allowed.
Recommendation:  Verify logs are captured after making change.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="36">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.2.1.3</cdf:SectionNumber>
<cdf:SectionHeading>Logging</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Login success or failure</cdf:SystemValue_Parameter>
<cdf:Description>Requirements for systems that use rsyslog, distributions not listed below.</cdf:Description>
<cdf:RecommendedValue>File:/etc/rsyslog.conf
filter f_authpriv { facility(authpriv); };
destination authpriv { file("/var/log/secure;RSYSLOG_TraditionalFileFormat"); };
source src { internal(); };
log { source(src); filter(f_authpriv); destination(authpriv); };
Note: More extensive logging beyond the minimums listed above is allowed.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="37">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.2.1.4</cdf:SectionNumber>
<cdf:SectionHeading>Logging</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Login success or failure</cdf:SystemValue_Parameter>
<cdf:Description>Requirements for systems that use rsyslog, SuSE 11, Red Hat 5 and later:</cdf:Description>
<cdf:RecommendedValue>SLES 11, Red Hat V5 and above:
File:/etc/rsyslog.conf
$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat
*.info;mail.none;authpriv.none;cron.none /var/log/messages
authpriv.* /var/log/secure
or (if you don't want to use global variable $ActionFileDefaultTemplate)
*.info;mail.none;authpriv.none;cron.none /var/log/messages;RSYSLOG_TraditionalFileFormat
authpriv.* /var/log/secure;RSYSLOG_TraditionalFileFormat
Note: The use of the "-" in "-/var/log/...", which indicates that buffered writes are allowed, is optional in any Linux syslog configuration.
Note: More extensive logging is permissible, e.g "cron.none" may be removed from the facility section of the control stanza for /var/log/messages.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="38">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.2.1.5</cdf:SectionNumber>
<cdf:SectionHeading>Logging</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Login success or failure</cdf:SystemValue_Parameter>
<cdf:Description>Requirements for systems that use rsyslog,  Debian</cdf:Description>
<cdf:RecommendedValue>Debian Linux:
File:/etc/rsyslog.conf
$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat
auth,authpriv.* /var/log/auth.log
*.*;auth,authpriv.none -/var/log/syslog
*.=info;*.=notice;*.=warning; auth,authpriv.none; cron,daemon.none; mail,news.none -/var/log/messages
or (if you don't want to use global variable $ActionFileDefaultTemplate)
auth,authpriv.* /var/log/auth.log;RSYSLOG_TraditionalFileFormat
*.*;auth,authpriv.none -/var/log/syslog;RSYSLOG_TraditionalFileFormat
*.=info;*.=notice;*.=warning; auth,authpriv.none; cron,daemon.none; mail,news.none -/var/log/messages;RSYSLOG_TraditionalFileFormat
Note: The use of the "-" in "-/var/log/...", which indicates that buffered writes are allowed, is optional in any Linux syslog configuration.
Note: More extensive logging is permissible, e.g "cron.none" may be removed from the facility section of the control stanza for /var/log/syslog</cdf:RecommendedValue>
<cdf:Comments>Debian support implemented but not tested</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="39">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.2.2</cdf:SectionNumber>
<cdf:SectionHeading>Logging</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var/log/wtmp</cdf:SystemValue_Parameter>
<cdf:Description>Records for all connections must be retained, via  use of /var/log/wtmp</cdf:Description>
<cdf:RecommendedValue>Must exist </cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="40">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.2.3.1</cdf:SectionNumber>
<cdf:SectionHeading>Logging</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var/log/messages</cdf:SystemValue_Parameter>
<cdf:Description>Records for all connections must be retained, via  use of /var/log/messages</cdf:Description>
<cdf:RecommendedValue>Must exist on non-Debian Systems.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="41">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.2.3.2</cdf:SectionNumber>
<cdf:SectionHeading>Logging</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var/log/syslog</cdf:SystemValue_Parameter>
<cdf:Description>Records for all connections must be retained, via  use of /var/log/syslog</cdf:Description>
<cdf:RecommendedValue>Must exist on Debian Systems.</cdf:RecommendedValue>
<cdf:Comments>Debian support implemented but not tested</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="42">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.2.4.1</cdf:SectionNumber>
<cdf:SectionHeading>Logging</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var/log/faillog  </cdf:SystemValue_Parameter>
<cdf:Description>Records for all unsuccessful logon attempts must be retained, via  use of /var/log/faillog
Notes:
Updated by pam_tally;  see loginretries in Section 1.1
Note: May require touch /var/log/faillog if this file does not already exist
If an account is locked when the deny count is reached, it may be reset by the root account with faillog -u &lt;userid&gt; -r </cdf:Description>
<cdf:RecommendedValue>Must exist for all systems not using pam_tally2.so</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="43">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.2.4.2</cdf:SectionNumber>
<cdf:SectionHeading>Logging</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var/log/tallylog</cdf:SystemValue_Parameter>
<cdf:Description>Records for all unsuccessful logon attempts must be retained, via  this file.</cdf:Description>
<cdf:RecommendedValue>Must exist for all systems using pam_tally2.so</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="44">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.2.5</cdf:SectionNumber>
<cdf:SectionHeading>Logging</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var/log/secure
or
/var/log/auth.log</cdf:SystemValue_Parameter>
<cdf:Description>Records for all connections must be retained, via  use of /var/log/secure or /var/log/auth.log
Notes:
/var/log/secure is required on all Linux distributions except Debian
/var/log/auth.log is required on Debian Linux</cdf:Description>
<cdf:RecommendedValue>Must exist</cdf:RecommendedValue>
<cdf:Comments>Debian support implemented but not tested</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="45">
<cdf:Coverage>Orange</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.2.6</cdf:SectionNumber>
<cdf:SectionHeading>Logging</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Log record retention time frame.</cdf:SystemValue_Parameter>
<cdf:Description>Period of time to retain above required system securty log records.</cdf:Description>
<cdf:RecommendedValue>90 days.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="46">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>Informational requirement no requirement to B or S</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.3.0</cdf:SectionNumber>
<cdf:SectionHeading>AntiVirus</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>No requirements in this category</cdf:SystemValue_Parameter>
<cdf:Description>No requirements in this category</cdf:Description>
<cdf:RecommendedValue>No requirements in this category</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="47">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.4.1</cdf:SectionNumber>
<cdf:SectionHeading>System Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/pam.d/other</cdf:SystemValue_Parameter>
<cdf:Description>Enforce a default no access policy</cdf:Description>
<cdf:RecommendedValue>auth required pam_deny.so
account required /lib/security/pam_deny.so
Note: Use of full path and/or $ISA to pam modules is optional.
Note:  For Red Hat Enterprise Linux V6 and later:  If the system-auth file is in use, this control must ADDITIONALLY be applied to the /etc/pam.d/password-auth file.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="48">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.4.2</cdf:SectionNumber>
<cdf:SectionHeading>System Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/ftpusers,  /etc/vsftpd.ftpusers or /etc/vsftp/ftpusers</cdf:SystemValue_Parameter>
<cdf:Description>Restrict root ftp access
Note: Filename is dependent on which ftp server is installed.
Note: Only required if ftp is installed and enabled.</cdf:Description>
<cdf:RecommendedValue>Root Id must exist in file</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="49">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.4.3</cdf:SectionNumber>
<cdf:SectionHeading>System Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/passwd</cdf:SystemValue_Parameter>
<cdf:Description>Protection of password files: Contain userid, uid, gid, and other information</cdf:Description>
<cdf:RecommendedValue>Must not contain passwords</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="50">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>Process requirement no requirement to B or S</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.4.4</cdf:SectionNumber>
<cdf:SectionHeading>System Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/shadow</cdf:SystemValue_Parameter>
<cdf:Description>Protection of password files: Contains userid, encrypted password and other information</cdf:Description>
<cdf:RecommendedValue>FIle contains encrypted passwords</cdf:RecommendedValue>
<cdf:Comments>This Check currently only checks permissions of /etc/shadow</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="51">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>Process requirement no requirement to B or S</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.4.5</cdf:SectionNumber>
<cdf:SectionHeading>System Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Anonymous FTP, Process for Receiving Files form Anonymous Users</cdf:SystemValue_Parameter>
<cdf:Description>Anonymous FTP System Settings - If anonymous write is allowed</cdf:Description>
<cdf:RecommendedValue>Files that have been stored into a writeable directory must be examined (checked for Confidential information, checked for inappropriate materials, etc) before being moved to a readable directory.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="52">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.1.1</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>ftpd daemon options</cdf:SystemValue_Parameter>
<cdf:Description>Anonymous FTP System Settings - If anonymous write is allowed</cdf:Description>
<cdf:RecommendedValue>If any directories are writable, the -u 027 option must be used.
Note: this is a wu-ftpd specific requirement</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="53">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.1.2</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Configuration of the ftp account home directory</cdf:SystemValue_Parameter>
<cdf:Description>Anonymous FTP System Settings - If anonymous FTP is enabled</cdf:Description>
<cdf:RecommendedValue>If it exists and anonymous ftp is enabled, it must be owned by root and grant write access only to the owner</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="54">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.1.3</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Configuration of the bin subdirectory of the ftp account home directory</cdf:SystemValue_Parameter>
<cdf:Description>Anonymous FTP System Settings - If anonymous FTP is enabled</cdf:Description>
<cdf:RecommendedValue>If it exists and anonymous ftp is enabled, it must be owned by root and grant write access only to the owner. Files contained in this directory must have a mode of 0111.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="55">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.1.4</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Configuration of the lib subdirectory of the ftp account home directory</cdf:SystemValue_Parameter>
<cdf:Description>Anonymous FTP System Settings - If anonymous FTP is enabled</cdf:Description>
<cdf:RecommendedValue>If it exists and anonymous ftp is enabled, must be owned by root and grant write access only to the owner. Files contained in this directory must have a mode of 0555.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="56">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.1.5</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Configuration of the etc subdirectory of the ftp account home directory</cdf:SystemValue_Parameter>
<cdf:Description>Anonymous FTP System Settings - If anonymous FTP is enabled</cdf:Description>
<cdf:RecommendedValue>If it exists and anonymous ftp is enabled, must be owned by root and grant write access only to the owner. If the directory contains a passwd file, the password fields (field 2) must be empty</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="57">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.1.6</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Configuration of other files and subdirectories within the ftp account home directory</cdf:SystemValue_Parameter>
<cdf:Description>Anonymous FTP System Settings - If anonymous FTP is enabled</cdf:Description>
<cdf:RecommendedValue>If it exists and anonymous ftp is enabled, must not be owned by a general user account. If write access is granted to the group owner of the file or directory, membership in the group is a security administrative authority. Files and directories must allow only read/execute, write/execute, execute (directories only), or no access for other,</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="58">
<cdf:Coverage>Orange</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.1.7</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Directories enabled for Anonymous FTP access</cdf:SystemValue_Parameter>
<cdf:Description>Anonymous FTP System Settings - If anonymous FTP is enabled</cdf:Description>
<cdf:RecommendedValue>If it exists and anonymous ftp is enabled, READ access via anonymous FTP must not be granted to directories containing classified data.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="59">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.1.8</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Access permissions for directories accessible via Anonymous FTP</cdf:SystemValue_Parameter>
<cdf:Description>Anonymous FTP System Settings - If anonymous FTP is enabled</cdf:Description>
<cdf:RecommendedValue>If it exists and anonymous ftp is enabled, each directory may allow read access or write access to anonymous users, but not both.  See Section 1.4 - Information Protection &amp; Confidentiality for additional requirements for anonymous write enabled directories,</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="60">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.2.1</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>tftp access control</cdf:SystemValue_Parameter>
<cdf:Description>Trivial File Transfer Protocol (TFTP) System Setting</cdf:Description>
<cdf:RecommendedValue>The permitted directory must be specified with the -s parameter to server_args.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="61">
<cdf:Coverage>Orange</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.2.2</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Directories enabled for TFTP access</cdf:SystemValue_Parameter>
<cdf:Description>Trivial File Transfer Protocol (TFTP) System Setting</cdf:Description>
<cdf:RecommendedValue>Access via TFTP may be granted only to directories containing unclassified data, where the storage of Confidential data is prohibited. This restriction also applies to any subdirectories of the directory.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="62">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.3.1</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/exports</cdf:SystemValue_Parameter>
<cdf:Description>Network File System (NFS) System Settings, configuration of exported files, via /etc/exports file</cdf:Description>
<cdf:RecommendedValue>The file must exist, if NFS server is installed and running, and must be owned by root and have 0644 permissions.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="63">
<cdf:Coverage>Orange</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.3.2</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Network File System (NFS), Process for Exporting Confidential Data Without Strong Authentication</cdf:SystemValue_Parameter>
<cdf:Description>Network file system (nfs) settings</cdf:Description>
<cdf:RecommendedValue>Access to data classified Confidential may be granted though NFS on an exception basis under these conditions:
The /etc/exports file must contain a list of hosts and their mount permissions for all directories that may contain Confidential files
A process is established to validate all hosts specified in /etc/exports, at the health checking interval, for all directories that may contain Confidential files. If access to directories that may contain Confidential files is provided to netgroups, the host in the netgroups must be validated at the health checking interval defined for the server.
A process is established to ensure that all hosts specified in /etc/exports, for all directories that may contain Confidential files, share common userids and uid numbers and group and gid number mapping.
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="64">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.4.1</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/hosts.equiv</cdf:SystemValue_Parameter>
<cdf:Description>Berkeley Remote Access Command System Settings, access control via /etc/hosts.equiv file entries not allowed</cdf:Description>
<cdf:RecommendedValue>File /etc/hosts.equiv must not exist or must not contain active entries.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="65">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.4.2</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/pam.d/rlogin,  /etc/pam.d/rsh</cdf:SystemValue_Parameter>
<cdf:Description>Berkeley remote access commands settings</cdf:Description>
<cdf:RecommendedValue>If the file exists and there is a /lib/security/pam_rhosts_auth.so stanza present, the no_hosts_equiv parameter must be present.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="66">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.5</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>rexd daemon</cdf:SystemValue_Parameter>
<cdf:Description>RPC based Remote Execution service (rexd) must be disabled, via entry in inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="67">
<cdf:Coverage>Orange</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.6</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>NNTP authentication and identification</cdf:SystemValue_Parameter>
<cdf:Description>Net News Transfer Protocol (NNTP) System Settings</cdf:Description>
<cdf:RecommendedValue>Must be configured to require authentication and identification of all users if any of the newsgroups on the server are classified Confidential</cdf:RecommendedValue>
<cdf:Comments>IBM Confidential Data checks - Not Programmable</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="68">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.7</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>X-server access control</cdf:SystemValue_Parameter>
<cdf:Description>X-Window System Settings</cdf:Description>
<cdf:RecommendedValue>Must not be disabled via xhost +</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="69">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.8.1</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>CHARGEN</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled on internet servers, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled on all internet servers</cdf:RecommendedValue>
<cdf:Comments>UDP, TCP Port 19</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="70">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.8.2</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>DAYTIME</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled on internet servers, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled on all internet servers</cdf:RecommendedValue>
<cdf:Comments>UDP, TCP Port 13</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="71">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.8.3</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>DISCARD</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled on internet servers, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled on all internet servers</cdf:RecommendedValue>
<cdf:Comments>UDP, TCP Port 9</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="72">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.8.4</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>ECHO</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled on internet servers, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled on all internet servers</cdf:RecommendedValue>
<cdf:Comments>UDP, TCP Port 7</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="73">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.8.5</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>FINGER</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled on internet servers, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled on all internet servers</cdf:RecommendedValue>
<cdf:Comments>TCP Port 79</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="74">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.8.6</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>SYSTAT</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled on internet servers, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled on all internet servers</cdf:RecommendedValue>
<cdf:Comments>UDP, TCP Port 11</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="75">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.8.7</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>WHO</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled on internet servers, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled on all internet servers</cdf:RecommendedValue>
<cdf:Comments>UDP Port 513</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="76">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.8.8</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>NETSTAT</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled on internet servers, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled on all internet servers</cdf:RecommendedValue>
<cdf:Comments>UDP, TCP Port 15</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="77">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.1</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>ECHO</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled if not required to support an application, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled if not required to support an application</cdf:RecommendedValue>
<cdf:Comments>UDP, TCP Port 7</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="78">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.2</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>CHARGEN</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled if not required to support an application, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled if not required to support an application</cdf:RecommendedValue>
<cdf:Comments>UDP, TCP Port 19</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="79">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.3</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>RSTATD</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled if not required to support an application, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled if not required to support an application</cdf:RecommendedValue>
<cdf:Comments>RPC Process</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="80">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.4</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>TFTP</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled if not required to support an application, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled if not required to support an application</cdf:RecommendedValue>
<cdf:Comments>UDP Port 69</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="81">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.5</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>RWALLD</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled if not required to support an application, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled if not required to support an application</cdf:RecommendedValue>
<cdf:Comments>RPC Process</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="82">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.6</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>RUSERSD</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled if not required to support an application, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled if not required to support an application</cdf:RecommendedValue>
<cdf:Comments>RPC Process</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="83">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.7</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>DISCARD</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled if not required to support an application, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled if not required to support an application</cdf:RecommendedValue>
<cdf:Comments>UDP, TCP Port 9</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="84">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.8</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>DAYTIME</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled if not required to support an application, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled if not required to support an application</cdf:RecommendedValue>
<cdf:Comments>UDP, TCP Port 13</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="85">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.9</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>BOOTPS</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled if not required to support an application, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled if not required to support an application</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="86">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.10</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>FINGER</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled if not required to support an application, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled if not required to support an application</cdf:RecommendedValue>
<cdf:Comments>TCP Port 79</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="87">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.11</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>SPRAYD</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled if not required to support an application, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled if not required to support an application</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="88">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.12</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>PCNFSD</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled if not required to support an application, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled if not required to support an application</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="89">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.13</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>NETSTAT</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled if not required to support an application, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled if not required to support an application</cdf:RecommendedValue>
<cdf:Comments>UDP, TCP Port 15</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="90">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.14</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>RWHO</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled if not required to support an application, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled if not required to support an application</cdf:RecommendedValue>
<cdf:Comments>UDP Port 513</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="91">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.15</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>CMSD</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled if not required to support an application, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled if not required to support an application</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="92">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.16</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>DTSPCD</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled if not required to support an application, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled if not required to support an application</cdf:RecommendedValue>
<cdf:Comments>TCP Port 6112</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="93">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.17</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>TTDBSERVER</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled if not required to support an application, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled if not required to support an application</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="94">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.18</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>SNMP Service</cdf:SystemValue_Parameter>
<cdf:Description>SNMP Service must not use a community name of public for read or write, on non-loopback interface entries</cdf:Description>
<cdf:RecommendedValue>Community name of 'public' is not permitted if the SNMP service is active</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="95">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.19</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>SNMP Service</cdf:SystemValue_Parameter>
<cdf:Description>SNMP Service must not use a community name of private for read or write, </cdf:Description>
<cdf:RecommendedValue>Community name of 'private' is not permitted if the SNMP service is active</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="96">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.20</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/sysctl.conf</cdf:SystemValue_Parameter>
<cdf:Description>Enable tcp syncookies to prevent syn flooding</cdf:Description>
<cdf:RecommendedValue>net.ipv4.tcp_syncookies =1</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="97">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.21</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/sysctl.conf</cdf:SystemValue_Parameter>
<cdf:Description>Turn off ICMP broadcasts</cdf:Description>
<cdf:RecommendedValue>net.ipv4.icmp_echo_ignore_broadcasts = 1
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="98">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.22</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/sysctl.conf</cdf:SystemValue_Parameter>
<cdf:Description>Disable ICMP Redirect Acceptance</cdf:Description>
<cdf:RecommendedValue>net.ipv4.conf.all.accept_redirects = 0</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="99">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.23</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>telnet</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled if not required to support an application, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled if not required to support an application</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="100">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.9.24</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>ftp</cdf:SystemValue_Parameter>
<cdf:Description>Denial of Service Prevention System Settings, must be disabled if not required to support an application, via inetd or xinetd</cdf:Description>
<cdf:RecommendedValue>Must be disabled if not required to support an application</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="101">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.10.1</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>yppasswd daemon</cdf:SystemValue_Parameter>
<cdf:Description>Network information services (nis) settings, including nis+ in nis compatibility mode</cdf:Description>
<cdf:RecommendedValue>Must be disabled.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="102">
<cdf:Coverage>Yellow</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.10.2</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>NIS maps</cdf:SystemValue_Parameter>
<cdf:Description>Network information services (nis) settings, including nis+ in nis compatibility mode</cdf:Description>
<cdf:RecommendedValue>Must not be used to store Confidential data, including user passwords or other authentication credentials, in any form. If the NIS passwd maps are used, all encrypted passwords must be removed from the source file before the maps are generated.</cdf:RecommendedValue>
<cdf:Comments>This check reports a violation if NIS is enabled. Validation of NIS MAPS must be manually performed. </cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="103">
<cdf:Coverage>Yellow</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.11</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>NIS+ maps</cdf:SystemValue_Parameter>
<cdf:Description>Network information services plus (nis+) settings</cdf:Description>
<cdf:RecommendedValue>If Confidential data, including user passwords or other authentication credentials in any form, access may not be granted to the other or unauthenticated permissions class.</cdf:RecommendedValue>
<cdf:Comments>This check reports a violation if NIS is enabled. Validation of NIS MAPS must be manually performed. </cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="104">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>Informational requirement no requirement to B or S</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.12.0</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Note</cdf:SystemValue_Parameter>
<cdf:Description>Services on secure internal networks</cdf:Description>
<cdf:RecommendedValue>1.5.12.1- 1.5.12.5 list services that are allowed to be active on secure, internal networks.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="105">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.12.2</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>rlogin</cdf:SystemValue_Parameter>
<cdf:Description>Services on secure internal networks</cdf:Description>
<cdf:RecommendedValue>Allowed to be active on secure internal networks</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="106">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.12.3</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>rsh</cdf:SystemValue_Parameter>
<cdf:Description>Services on secure internal networks</cdf:Description>
<cdf:RecommendedValue>Allowed to be active on secure internal networks</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="107">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.5.12.4</cdf:SectionNumber>
<cdf:SectionHeading>Network Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>sendmail bd</cdf:SystemValue_Parameter>
<cdf:Description>Services on secure internal networks</cdf:Description>
<cdf:RecommendedValue>Allowed to be active on secure internal networks</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="108">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>Informational requirement no requirement to B or S</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.7.0</cdf:SectionNumber>
<cdf:SectionHeading>Identify and Authenticate Users</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>No requirements in this category</cdf:SystemValue_Parameter>
<cdf:Description>No requirements in this category</cdf:Description>
<cdf:RecommendedValue>No requirements in this category</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="109">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>Informational requirement no requirement to B or S</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.1.1</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Note</cdf:SystemValue_Parameter>
<cdf:Description>none</cdf:Description>
<cdf:RecommendedValue>Linux OSRs are defined as the following directories and all subdirectories (except as noted) and files that are listed below.
Note1: socket (s), named pipe (p), block special file (b), character special file (c), and symbolic link (l) files are excluded from this requirement
Note2: Directories which are hard links or 'bounded mounts' to /proc, and any subdirectories of that directory, are exempt from OSR requirements. </cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="110">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.2.1</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>~root/.rhosts</cdf:SystemValue_Parameter>
<cdf:Description>root .rhosts file</cdf:Description>
<cdf:RecommendedValue>If the file exists: Read access only by root; write access only by root</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="111">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.2.2</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>~root/.netrc</cdf:SystemValue_Parameter>
<cdf:Description>root .netrc file</cdf:Description>
<cdf:RecommendedValue>If the file exists: Read access only by root; write access only by root</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="112">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.3.1</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/</cdf:SystemValue_Parameter>
<cdf:Description>OSR directory</cdf:Description>
<cdf:RecommendedValue>Settings for other on this directory must be r-x or more restrictive.  Note: This particular requirement is not recursive. See entries below for subdirectories that do have recursive requirements for setting for other.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="113">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.3.2</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/usr</cdf:SystemValue_Parameter>
<cdf:Description>OSR directory</cdf:Description>
<cdf:RecommendedValue>Settings for other on this directory must be r-x or more restrictive.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="114">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.3.3</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc</cdf:SystemValue_Parameter>
<cdf:Description>OSR directory</cdf:Description>
<cdf:RecommendedValue>Settings for other on this directory must be r-x or more restrictive.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="115">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.4.1</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/security/opasswd</cdf:SystemValue_Parameter>
<cdf:Description>OSR file</cdf:Description>
<cdf:RecommendedValue>The file must exist, and File permissions must be set:
* rw- --- --- (or more restrictive)</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="116">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.4.2</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/shadow</cdf:SystemValue_Parameter>
<cdf:Description>OSR file</cdf:Description>
<cdf:RecommendedValue>File permissions must be set:
* rw- --- --- (or more restrictive)</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="117">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.5.1</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var</cdf:SystemValue_Parameter>
<cdf:Description>OSR directory</cdf:Description>
<cdf:RecommendedValue>Settings for other on this directory must be r-x or more restrictive.
Note: This particular requirement is not recursive. See entries below for subdirectories that do have recursive requirements for setting for other.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="118">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.5.2</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var/log</cdf:SystemValue_Parameter>
<cdf:Description>OSR directory</cdf:Description>
<cdf:RecommendedValue>Settings for other on this directory must be r-x or more restrictive.
Note: subdirectories of /var/log may be world writable if and only if the permissions are 1777.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="119">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.6.1</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var/log/faillog</cdf:SystemValue_Parameter>
<cdf:Description>OSR file</cdf:Description>
<cdf:RecommendedValue>File permissions must be set for all systems not using pam_tally2.so:
rw- --- --- (or more restrictive)
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="120">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.6.2</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var/log/tallylog</cdf:SystemValue_Parameter>
<cdf:Description>OSR file</cdf:Description>
<cdf:RecommendedValue>File permissions must be set for all systems using pam_tally2.so
rw- --- --- (or more restrictive)
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="121">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.7.1</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Non-Debian: /var/log/messages
Debian: /var/log/syslog</cdf:SystemValue_Parameter>
<cdf:Description>OSR file</cdf:Description>
<cdf:RecommendedValue>File permissions must be set:
rwx r-x r-x (or more restrictive)
</cdf:RecommendedValue>
<cdf:Comments>Debian support implemented but not tested</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="122">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.7.2</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var/log/wtmp</cdf:SystemValue_Parameter>
<cdf:Description>OSR file</cdf:Description>
<cdf:RecommendedValue>File permissions must be set:
rwx r-x r-x (or more restrictive)
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="123">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.8</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var/log/secure
or
/var/log/auth.log
</cdf:SystemValue_Parameter>
<cdf:Description>OSR file</cdf:Description>
<cdf:RecommendedValue>File permissions must be set:
* rwx r-x --- (or more restrictive)
Notes:
* /var/log/secure is required on all Linux distributions except Debian
* /var/log/auth.log is required on Debian Linux</cdf:RecommendedValue>
<cdf:Comments>Debian support implemented but not tested</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="124">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.9</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/tmp</cdf:SystemValue_Parameter>
<cdf:Description>OSR directory</cdf:Description>
<cdf:RecommendedValue>Settings for this directory must be rwxrwxrwt(1777).
Note: This particular requirement is not recursive.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="125">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.10</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>snmpd.conf
Note: possible locations are the /etc, /etc/snmp, or /etc/snmpd subdirectory</cdf:SystemValue_Parameter>
<cdf:Description>OSR file</cdf:Description>
<cdf:RecommendedValue>Permissions must be 0640 or more restrictive if the file exists</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="126">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.11</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var/tmp</cdf:SystemValue_Parameter>
<cdf:Description>OSR file</cdf:Description>
<cdf:RecommendedValue>Settings for this directory must be rwxrwxrwt(1777).
Note: This particular requirement is not recursive.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="127">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.12.1.1</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var/log/faillog</cdf:SystemValue_Parameter>
<cdf:Description>OSR log file.  Group read/write access allowed if conditions are met</cdf:Description>
<cdf:RecommendedValue>For all systems not using pam_tally2.so:
Read/write access is allowed for group if the following condition is satisfied:
The associated group is identified as having a privileged GID number per section 5.0.2
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="128">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.12.1.2</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var/log/tallylog</cdf:SystemValue_Parameter>
<cdf:Description>OSR log file.  Read/write access allowed if conditions are met</cdf:Description>
<cdf:RecommendedValue>For all systems using pam_tally2.so:
Read/write access is allowed for group if the following condition is satisfied:
The associated group is identified as having a privileged GID number per section 5.0.2
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="129">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.12.2</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Non-Debian: /var/log/messages
Debian: /var/log/syslog</cdf:SystemValue_Parameter>
<cdf:Description>OSR log file.  Read/write access allowed if conditions are met</cdf:Description>
<cdf:RecommendedValue>For all systems not using pam_tally2.so:
Read/write access is allowed for group if the following condition is satisfied:
The associated group is identified as having a privileged GID number per section 5.0.2
</cdf:RecommendedValue>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="130">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.12.3</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var/log/wtmp</cdf:SystemValue_Parameter>
<cdf:Description>OSR log file.  Read/write access allowed if conditions are met</cdf:Description>
<cdf:RecommendedValue>Read/write access is allowed for group if the following condition is satisfied:
The associated group is identified as having a privileged GID number per section 5.0.2
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="131">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.12.4</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var/log/secure</cdf:SystemValue_Parameter>
<cdf:Description>OSR log file.  Group read/write access allowed if conditions are met
Note:
/var/log/secure is required on all Linux distributions except Debian</cdf:Description>
<cdf:RecommendedValue>Read/write access is allowed for group if the following condition is satisfied:
The associated group is identified as having a privileged GID number per section 5.0.2
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="132">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.12.5</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var/log/auth.log</cdf:SystemValue_Parameter>
<cdf:Description>OSR log file.  Group read/write access allowed if conditions are met
Note:
/var/log/auth.log is required on Debian Linux</cdf:Description>
<cdf:RecommendedValue>Read/write access is allowed for group if the following condition is satisfied:
The associated group is identified as having a privileged GID number per section 5.0.2
</cdf:RecommendedValue>
<cdf:Comments>Debian support implemented but not tested</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="133">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.12.6</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/profile.d/IBMsinit.sh</cdf:SystemValue_Parameter>
<cdf:Description>Executable which establishes initial environment variables for a general user.</cdf:Description>
<cdf:RecommendedValue>Must have settings for "other"  of r-x.
Must have settings for "group"  of r-x, but write access is allowed for the group if the associated group is identified as having a privileged GID number per section 5.0.2
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="134">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.12.7</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/profile.d/IBMsinit.csh</cdf:SystemValue_Parameter>
<cdf:Description>Executable which establishes initial environment variables for a general user.</cdf:Description>
<cdf:RecommendedValue>Must have settings for "other"  of r-x.
Must have settings for "group"  of r-x, but write access is allowed for the group if the associated group is identified as having a privileged GID number per section 5.0.2
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="135">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>Informational requirement no requirement to B or S</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.13.0</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Note:</cdf:SystemValue_Parameter>
<cdf:Description>List of in-scope system facilities
Files executed via entries in /etc/inittab
Files executed via entries in /var/spool/cron/root
Files executed via entries in /etc/crontab
Files executed via entries in /var/spool/cron/tabs/root
Files executed via entries in files located in/etc/cron.d/
Files executed via entries in /etc/xinetd.conf
Files executed via files or links contained in the /etc/init.d/ directory structure
Files executed via files or links contained in the /etc/init.d/rc0.d, etc/init.d/rc1.d, /etc/init.d/rc2.d,
/etc/init.d/rc3.d, /etc/init.d/rc4.d, /etc/init.d/rc5.d, /etc/init.d/rc6.d,
/etc/init.d/rcS.d  directories -or-:
/etc/rc.d/rc0.d, /etc/rc.d/rc1.d, /etc/rc.d/rc2.d, /etc/rc.d/rc3.d,
/etc/rc.d/rc4.d, /etc/rc.d/rc5.d, /etc/rc.d/rc6.d, /etc/rc.d/rcS.d  directories.  Note: where /etc/rc.d or /etc/init.d are symlinks, the symlink does not need to be verified independently.</cdf:Description>
<cdf:RecommendedValue>Active entries and files/scripts/commands must meet all the requirements below in section 1.8.13.x to 1.8.21.x
Exceptions:
Files/commands executed that are OSR's and meet applicable OSR requirements are compliant and do not have to meet the requirements below.
Shell bult-in commands executed do not have to meet the requirements below.
Files/commands/scripts executed are not required to exist as long as all the existing directories in it's path meet all the requirements below.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="136">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>Informational requirement no requirement to B or S</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.13.1.1</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Groups considered to be default groups for general users</cdf:SystemValue_Parameter>
<cdf:Description>Default group name to which new userids are added, which grants no special privileges</cdf:Description>
<cdf:RecommendedValue>users</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="137">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.13.2</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/inittab</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for system facility entries executing with privilege authority.</cdf:Description>
<cdf:RecommendedValue>Each active entry must specify full path of the file/command/script to be executed.</cdf:RecommendedValue>
<cdf:Comments>Not supported for Ubuntu</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="138">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.13.3</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/inittab</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for system facility entries executing with privilege authority.</cdf:Description>
<cdf:RecommendedValue>Each active entry's file/command/script to be executed, and all existing directories in its path, must have settings for "other"  of r-x or more stringent.</cdf:RecommendedValue>
<cdf:Comments>Not supported for Ubuntu</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="139">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.13.4</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/inittab</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for system facility entries executing with privilege authority.</cdf:Description>
<cdf:RecommendedValue>Each active entry's file/command/script executed, and all existing directories in its path must have settings for "group"  of r-x or more stringent, if owned by groups considered to be default groups for general users..</cdf:RecommendedValue>
<cdf:Comments>Not supported for Ubuntu</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="140">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.14.1</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var/spool/cron/root</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for system facility entries executing with privilege authority.</cdf:Description>
<cdf:RecommendedValue>Each active entry must specify full path of the file/command/script to be executed.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="141">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.14.2</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var/spool/cron/root</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for system facility entries executing with privilege authority.</cdf:Description>
<cdf:RecommendedValue>Each active entry's file/command/script to be executed, and all existing directories in its path, must have settings for "other"  of r-x or more stringent.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="142">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.14.3</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var/spool/cron/root</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for system facility entries executing with privilege authority.</cdf:Description>
<cdf:RecommendedValue>Each active entry's file/command/script executed, and all existing directories in its path must have settings for "group"  of r-x or more stringent, if owned by groups considered to be default groups for general users..</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="143">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.15.1</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/crontab</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for system facility entries executing with privilege authority.</cdf:Description>
<cdf:RecommendedValue>Each active entry must specify full path of the file/command/script to be executed.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="144">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.15.2</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/crontab</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for system facility entries executing with privilege authority.</cdf:Description>
<cdf:RecommendedValue>Each active entry's file/command/script to be executed, and all existing directories in its path, must have settings for "other"  of r-x or more stringent.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="145">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.15.3</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/crontab</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for system facility entries executing with privilege authority.</cdf:Description>
<cdf:RecommendedValue>Each active entry's file/command/script executed, and all existing directories in its path must have settings for "group"  of r-x or more stringent, if owned by groups considered to be default groups for general users..</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="146">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.17.1</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/xinetd.conf</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for system facility entries executing with privilege authority.</cdf:Description>
<cdf:RecommendedValue>Each active entry must specify full path of the file/command/script to be executed.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="147">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.17.2</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/xinetd.conf</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for system facility entries executing with privilege authority.</cdf:Description>
<cdf:RecommendedValue>Each active entry's file/command/script to be executed, and all existing directories in its path, must have settings for "other"  of r-x or more stringent.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="148">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.17.3</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/xinetd.conf</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for system facility entries executing with privilege authority.</cdf:Description>
<cdf:RecommendedValue>Each active entry's file/command/script executed, and all existing directories in its path must have settings for "group"  of r-x or more stringent, if owned by groups considered to be default groups for general users..</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="149">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.18.2</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/init.d/rc0.d, /etc/init.d/rc1.d,
/etc/init.d/rc2.d, /etc/init.d/rc3.d,
/etc/init.d/rc4.d, /etc/init.d/rc5.d,
/etc/init.d/rc6.d, /etc/init.d/rcS.d directories
-or-
/etc/rc.d/rc0.d, /etc/rc.d/rc1.d,
/etc/rc.d/rc2.d, /etc/rc.d/rc3.d,
/etc/rc.d/rc4.d, /etc/rc.d/rc5.d,
/etc/rc.d/rc6.d, /etc/rc.d/rcS.d  directories</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for system facility entries executing with privilege authority.</cdf:Description>
<cdf:RecommendedValue>Each file which is executed as a result of links placed in this directory and all existing directories in its path must have settings for "other"  of r-x or more stringent.   Actual files in this directory must meet the same requirement. </cdf:RecommendedValue>
<cdf:Comments>Links are not checkecd</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="150">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.18.3</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/init.d/rc0.d, /etc/init.d/rc1.d,
/etc/init.d/rc2.d, /etc/init.d/rc3.d,
/etc/init.d/rc4.d, /etc/init.d/rc5.d,
/etc/init.d/rc6.d, /etc/init.d/rcS.d directories
-or-
/etc/rc.d/rc0.d, /etc/rc.d/rc1.d,
/etc/rc.d/rc2.d, /etc/rc.d/rc3.d,
/etc/rc.d/rc4.d, /etc/rc.d/rc5.d,
/etc/rc.d/rc6.d, /etc/rc.d/rcS.d  directories</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for system facility entries executing with privilege authority.</cdf:Description>
<cdf:RecommendedValue>Each file which is executed as a result of links placed in this directory and all existing directories in its path must have settings for "group"  of r-x or more stringent, if owned by groups considered to be default groups for general users.   Actual files in this directory must meet the same requirement. </cdf:RecommendedValue>
<cdf:Comments>Links are not checkecd</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="151">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.19.2</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/init.d/ -or /etc/rc.d/ directory structure</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for system facility entries executing with privilege authority.</cdf:Description>
<cdf:RecommendedValue>Each file which is executed as a result of links placed in this directory and all existing directories in its path must have settings for "other"  of r-x or more stringent.   Actual files in this directory must meet the same requirement. </cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="152">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.19.3</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/init.d/ -or /etc/rc.d/ directory structure</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for system facility entries executing with privilege authority.</cdf:Description>
<cdf:RecommendedValue>Each file which is executed as a result of links placed in this directory and all existing directories in its path must have settings for "group"  of r-x or more stringent, if owned by groups considered to be default groups for general users.   Actual files in this directory must meet the same requirement. </cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="153">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.20.1</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/cron.d/ directory structure.</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for system facility entries executing with privilege authority.</cdf:Description>
<cdf:RecommendedValue>Each active entry must specify full path of the file/command/script to be executed.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="154">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.20.2</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/cron.d/ directory structure.</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for system facility entries executing with privilege authority.</cdf:Description>
<cdf:RecommendedValue>Each active entry's file/command/script to be executed, and all existing directories in its path, must have settings for "other"  of r-x or more stringent.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="155">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.20.3</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/cron.d/ directory structure.</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for system facility entries executing with privilege authority.</cdf:Description>
<cdf:RecommendedValue>Each active entry's file/command/script executed, and all existing directories in its path must have settings for "group"  of r-x or more stringent, if owned by groups considered to be default groups for general users..</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="156">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.21.1</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var/spool/cron/tabs/root</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for system facility entries executing with privilege authority.</cdf:Description>
<cdf:RecommendedValue>Each active entry must specify full path of the file/command/script to be executed.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="157">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.21.2</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var/spool/cron/tabs/root</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for system facility entries executing with privilege authority.</cdf:Description>
<cdf:RecommendedValue>Each active entry's file/command/script to be executed, and all existing directories in its path, must have settings for "other"  of r-x or more stringent.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="158">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.21.3</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources -OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var/spool/cron/tabs/root</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for system facility entries executing with privilege authority.</cdf:Description>
<cdf:RecommendedValue>Each active entry's file/command/script executed, and all existing directories in its path must have settings for "group"  of r-x or more stringent, if owned by groups considered to be default groups for general users..</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="159">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.22.1</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSRs</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/opt directory and its sub-directories</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for executable files in specific non-OSR directories (e.g., user and non-OS software files in those directories)</cdf:Description>
<cdf:RecommendedValue>Files in the location listed may not have both the other-write and any execute permissions set.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="160">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.22.2</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSRs</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/var directory and its sub-directories</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for executable files in specific non-OSR directories (e.g., user and non-OS software files in those directories)</cdf:Description>
<cdf:RecommendedValue>Files in the location listed may not have both the other-write and any execute permissions set.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="161">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.22.3</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSRs</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/usr/local directory and its sub-directories</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for executable files in specific non-OSR directories (e.g., user and non-OS software files in those directories)</cdf:Description>
<cdf:RecommendedValue>Files in the location listed may not have both the other-write and any execute permissions set.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="162">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.22.4</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSRs</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/tmp directory and its sub-directories</cdf:SystemValue_Parameter>
<cdf:Description>Protection requirements for executable files in specific non-OSR directories (e.g., user and non-OS software files in those directories)</cdf:Description>
<cdf:RecommendedValue>Files in the location listed may not have both the other-write and any execute permissions set.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="163">
<cdf:Coverage>Orange</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.9.1.1</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - User Resources</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>$HOME</cdf:SystemValue_Parameter>
<cdf:Description>New user home directories, at time of creation, only allow access to owner.</cdf:Description>
<cdf:RecommendedValue>Default Permissions at time of creation: 700.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="164">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.9.1.2</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - User Resources</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Default UMASK</cdf:SystemValue_Parameter>
<cdf:Description>Default umask value.</cdf:Description>
<cdf:RecommendedValue>umask x77
RedHat: Configured in /etc/bashrc
SLES: Configured in /etc/profile.local
Other distributions listed in the Version/Releases table of this tech spec: not required at this time.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="165">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.9.1.2.1</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - User Resources</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/login.defs</cdf:SystemValue_Parameter>
<cdf:Description>UMASK value used when creating $HOME via useradd command.</cdf:Description>
<cdf:RecommendedValue>Must include this line:
UMASK=077</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="166">
<cdf:Coverage>Yellow</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.9.1.3</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - User Resources</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/profile.d/IBMsinit.sh</cdf:SystemValue_Parameter>
<cdf:Description>Default UMASK value.</cdf:Description>
<cdf:RecommendedValue>File must exist, and contain at least:
if [ $UID -gt 199 ]; then
umask 077
fi
Note:  This guidance for AD.1.9.1.3 and AD.1.9.1.4 is only sufficient for user shells: /bin/csh, /bin/tcsh, /bin/sh, /bin/ksh, and /bin/bash.  If users are permitted other login shells, similar controls must be established.  /bin/false and other 'no login' shells are exempt from this requirement.</cdf:RecommendedValue>
<cdf:Comments>Check currently inspect existence of the file. Other requirements manual process require.</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="167">
<cdf:Coverage>Yellow</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.9.1.4</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - User Resources</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/profile.d/IBMsinit.csh</cdf:SystemValue_Parameter>
<cdf:Description>Default UMASK value.</cdf:Description>
<cdf:RecommendedValue>File must exist, and contain at least:
if [ $UID -gt 199 ]; then
umask 077
fi
Note:  This guidance for AD.1.9.1.3 and AD.1.9.1.4 is only sufficient for user shells: /bin/csh, /bin/tcsh, /bin/sh, /bin/ksh, and /bin/bash.  If users are permitted other login shells, similar controls must be established.  /bin/false and other 'no login' shells are exempt from this requirement.</cdf:RecommendedValue>
<cdf:Comments>Check currently inspect existence of the file. Other requirements manual process require.</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="168">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.9.1.5</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - User Resources</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/profile </cdf:SystemValue_Parameter>
<cdf:Description>Default UMASK value.</cdf:Description>
<cdf:RecommendedValue>File must exist, and must trigger an invocation of
. /etc/profile.d/IBMsinit.sh
and does not set/reset umask after that invocation.
Note:  Some systems will have /etc/profile invoke /etc/profile.local; if that is the case, it is permissible for the 'call' of /etc/profile.d/IBMsinit.sh to be done from /etc/profile.local.</cdf:RecommendedValue>
<cdf:Comments>While most 'newer' distributions will trigger invocation of /etc/profile.d/IBMsinit.sh 'automatically', we can't check it programmatically. Because of this we're trying to find '. /etc/profile.d/IBMsinit.sh' line to be sure that it will be invoked.</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="169">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.9.1.6</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - User Resources</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/csh.login</cdf:SystemValue_Parameter>
<cdf:Description>Default UMASK value.</cdf:Description>
<cdf:RecommendedValue>File must exist if csh is installed, and must trigger an invocation of
source /etc/profile.d/IBMsinit.csh
and does not set/reset umask after that invocation.
Note:  Some systems will have /etc/csh.login invoke /etc/csh.login.local; if that is the case, it is permissible for the 'call' of /etc/profile.d/IBMsinit.csh to be done from /etc/csh.login.local.
Note:  The 'standard' package for installing csh is the package tcsh; however, any variant of csh installed will trigger this requirement.</cdf:RecommendedValue>
<cdf:Comments>While most 'newer' distributions will trigger invocation of /etc/profile.d/IBMsinit.csh 'automatically', we can't check it programmatically. Because of this we're trying to find 'source /etc/profile.d/IBMsinit.csh' line to be sure that it will be invoked.</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="170">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.9.1.7</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - User Resources</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>/etc/skel/.cshrc, /etc/skel/.login, /etc/skel/.profile, /etc/skel/.bashrc,
/etc/skel/.bash_profile,
/etc/skel/.bash_login,
/etc/skel/.tcshrc,
</cdf:SystemValue_Parameter>
<cdf:Description>Default UMASK value is not overridden or is established inside skeleton files set via umask command.  </cdf:Description>
<cdf:RecommendedValue>Either does not override the UMASK for the user, or encodes:
umask 077
as the UMASK setting.
Note:  The requirement is that the skeleton file complies to ensure an ID is created with a secure umask.  It is understood that the user may modify this file once it is copied into their $HOME.
Note:  There is no requirement these files exist; but if they do, they must conform to the requirement.
Note:  This guidance is only sufficient for user shells: /bin/csh, /bin/tcsh, /bin/sh, /bin/ksh, and /bin/bash.  If users are permitted other login shells, similar controls must be established.  /bin/false and other 'no login' shells are exempt from this requirement.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="171">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.2.0.1</cdf:SectionNumber>
<cdf:SectionHeading>Business Use Notice</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Business Use Notice exists </cdf:SystemValue_Parameter>
<cdf:Description>Implementation of a Business Use Notice</cdf:Description>
<cdf:RecommendedValue>Business Use Notice exists
How implemented:
/etc/motd or /etc/issue
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="172">
<cdf:Coverage>Orange</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.2.1.1</cdf:SectionNumber>
<cdf:SectionHeading>Encryption</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Data Transmission</cdf:SystemValue_Parameter>
<cdf:Description>Recommended level of encryption</cdf:Description>
<cdf:RecommendedValue>Multiple - All native encryption ciphers may be used, as long as they meet one of these minimum bit length values: 128-bit (secret/symmetric key), 1024-bit (public/private keys).</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="173">
<cdf:Coverage>Orange</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.2.1.2</cdf:SectionNumber>
<cdf:SectionHeading>Encryption</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>File/Database Storage</cdf:SystemValue_Parameter>
<cdf:Description>Recommended level of encryption</cdf:Description>
<cdf:RecommendedValue>Multiple; gpg and openssl are two examples - All native encryption ciphers may be used, as long as they meet one of these minimum bit length values: 128-bit (secret/symmetric key), 1024-bit (public/private keys).</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="174">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.2.1.3.0</cdf:SectionNumber>
<cdf:SectionHeading>Encryption</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Storage of passwords (Passwords must be protected with 128-bit encryption)</cdf:SystemValue_Parameter>
<cdf:Description>Note: Any file in /etc/pam.d containing "password sufficient ($LIB/security/$ISA)/pam_unix.so" must carry the sha512 shadow options
where $LIB is either 'lib' or 'lib64' depending on if a 32 bit or 64 bit kernel is in use.
</cdf:Description>
<cdf:RecommendedValue>For Red Hat:
Default setting with use of sha512 shadow parameters to pam_unix.so in the password stanza as set in /etc/pam.d/passwd or /etc/pam.d/system-auth is sufficient.
Note:  For Red Hat Enterprise Linux V6 and later:  If the system-auth file is in use, this control must ADDITIONALLY be applied to the /etc/pam.d/password-auth file.
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="175">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.2.1.3.1</cdf:SectionNumber>
<cdf:SectionHeading>Encryption</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Storage of passwords (Passwords must be protected with 128-bit encryption)</cdf:SystemValue_Parameter>
<cdf:Description>Note: Any file in /etc/pam.d containing "password sufficient (lib/security/$ISA)/pam_unix.so" must carry the sha512 shadow options.
</cdf:Description>
<cdf:RecommendedValue>For Debian:
Default setting with use of sha512 shadow parameters to pam_unix.so in the password stanza as set in /etc/pam.d/common-password is sufficient.
Note: Any file in /etc/pam.d containing "password sufficient (lib/security/$ISA)/pam_unix.so" must carry the sha512 shadow options.</cdf:RecommendedValue>
<cdf:Comments>Debian support implemented but not tested</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="176">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.2.1.3.2</cdf:SectionNumber>
<cdf:SectionHeading>Encryption</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Storage of passwords (Passwords must be protected with 128-bit encryption)</cdf:SystemValue_Parameter>
<cdf:Description>Note: Any file in /etc/pam.d containing "password sufficient (lib/security/$ISA)/pam_unix.so" must carry the sha512 shadow options.
</cdf:Description>
<cdf:RecommendedValue>For SLES:
/etc/default/passwd must include the following
CRYPT=sha-512
CRYPT_FILES=sha-512

Note: It is acceptable to replace "sha-512" with "sha-256"</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="177">
<cdf:Coverage>Orange</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.2.1.4</cdf:SectionNumber>
<cdf:SectionHeading>Encryption</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Protection of private keys (Minimum 1024-bit public key)</cdf:SystemValue_Parameter>
<cdf:Description>Protection of private keys</cdf:Description>
<cdf:RecommendedValue>Private key files must be readable and writeable only by the owner.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="178">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>Informational requirement no requirement to B or S</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.3.0.0</cdf:SectionNumber>
<cdf:SectionHeading>Process Exceptions</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>No requirements in this category</cdf:SystemValue_Parameter>
<cdf:Description>No requirements in this category</cdf:Description>
<cdf:RecommendedValue>No requirements in this category</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="179">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.5.0.1</cdf:SectionNumber>
<cdf:SectionHeading>Privileged Authorizations/Userids:</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Persons with access to the 'root' user account
</cdf:SystemValue_Parameter>
<cdf:Description>Privileged Authorizations/Userids:</cdf:Description>
<cdf:RecommendedValue>No value to be set</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="180">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.5.0.2</cdf:SectionNumber>
<cdf:SectionHeading>Privileged Authorizations/Userids:</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Userids in groups with GID &lt;= 99
plus
Userids in groups with GID as indicated:
Debian 5
- GID &gt;= 101 and GID &lt;= 199
RHEL 5 and 6
- GID &gt;= 101 and GID &lt;= 499
SLES 9 and later
- GID &gt;= 101 and GID &lt;= 499
RHEL 7 and later
- GID &gt;= 101 and GID &lt;= 999
Debian 6 and later
- GID &gt;= 101 and GID &lt;= 999</cdf:SystemValue_Parameter>
<cdf:Description>userIDs in this group are considered to have privilege.</cdf:Description>
<cdf:RecommendedValue>No value to be set</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="181">
<cdf:Coverage>Orange</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.10.1.2.1</cdf:SectionNumber>
<cdf:SectionHeading>Logging</cdf:SectionHeading>
<cdf:subSection>To be deleted if not a HIPAA customer. &amp;lt;br /&amp;gt;additional technical controls for HIPAA requirements.&amp;lt;br /&amp;gt;Deviations from the requirements in the HIPAA section must FIRST be reported to
HIPAA Risk Assessments/ATLANTA/Contr/IBM
before following standard risk assessment protocols.</cdf:subSection>
<cdf:SystemValue_Parameter>For IBM managed systems that contain PHI, system log-on/log-off and privileged/non-privileged user system activity logs must be retained.</cdf:SystemValue_Parameter>
<cdf:Description>Logging</cdf:Description>
<cdf:RecommendedValue>270 days</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="182">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.10.1.2.2</cdf:SectionNumber>
<cdf:SectionHeading>Logging</cdf:SectionHeading>
<cdf:subSection>To be deleted if not a HIPAA customer. &amp;lt;br /&amp;gt;additional technical controls for HIPAA requirements.&amp;lt;br /&amp;gt;Deviations from the requirements in the HIPAA section must FIRST be reported to
HIPAA Risk Assessments/ATLANTA/Contr/IBM
before following standard risk assessment protocols.</cdf:subSection>
<cdf:SystemValue_Parameter>Privilege Monitoring Logging</cdf:SystemValue_Parameter>
<cdf:Description>For IBM-managed systems identified as containing PHI, capture system security/audit logs of privileged authority activities as defined by the Privilege Monitoring process</cdf:Description>
<cdf:RecommendedValue>See Section 20.x</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="183">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>Informational requirement no requirement to B or S</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.10.1.4.0</cdf:SectionNumber>
<cdf:SectionHeading>System Settings</cdf:SectionHeading>
<cdf:subSection>To be deleted if not a HIPAA customer. &amp;lt;br /&amp;gt;additional technical controls for HIPAA requirements.&amp;lt;br /&amp;gt;Deviations from the requirements in the HIPAA section must FIRST be reported to
HIPAA Risk Assessments/ATLANTA/Contr/IBM
before following standard risk assessment protocols.</cdf:subSection>
<cdf:SystemValue_Parameter>Electronic Authentication</cdf:SystemValue_Parameter>
<cdf:Description>Implement electronic (authentication) mechanism to confirm that PHI has not been altered or destroyed in an unauthorized manner</cdf:Description>
<cdf:RecommendedValue>Use of a 3rd party product</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="184">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.10.1.4.1</cdf:SectionNumber>
<cdf:SectionHeading>System Settings</cdf:SectionHeading>
<cdf:subSection>To be deleted if not a HIPAA customer. &amp;lt;br /&amp;gt;additional technical controls for HIPAA requirements.&amp;lt;br /&amp;gt;Deviations from the requirements in the HIPAA section must FIRST be reported to
HIPAA Risk Assessments/ATLANTA/Contr/IBM
before following standard risk assessment protocols.</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/profile </cdf:SystemValue_Parameter>
<cdf:Description>For systems containing PHI, where technically feasible set systems to terminate a session after 30 minutes of inactivity
Session temination (1800 seconds = 30 minutes)</cdf:Description>
<cdf:RecommendedValue>File must exist, and must trigger an invocation of
. /etc/profile.d/IBMsinit.sh
and does not set/reset the time out control after that invocation.
Note:  Some systems will have /etc/profile invoke /etc/profile.local; if that is the case, it is permissible for the 'call' of /etc/profile.d/IBMumask.sh to be done from /etc/profile.local.
</cdf:RecommendedValue>
<cdf:Comments>Requires additional policy 'SCM511-GSDISEC2.0A-HIPPA-LINUX' for systems requiring HIPPA</cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="185">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.10.1.4.6</cdf:SectionNumber>
<cdf:SectionHeading>System Settings</cdf:SectionHeading>
<cdf:subSection>To be deleted if not a HIPAA customer. &amp;lt;br /&amp;gt;additional technical controls for HIPAA requirements.&amp;lt;br /&amp;gt;Deviations from the requirements in the HIPAA section must FIRST be reported to
HIPAA Risk Assessments/ATLANTA/Contr/IBM
before following standard risk assessment protocols.</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/csh.login</cdf:SystemValue_Parameter>
<cdf:Description>For systems containing PHI,set systems to terminate a session after 30 minutes of inactivity.</cdf:Description>
<cdf:RecommendedValue>File must exist, and must trigger an invocation of
source /etc/profile.d/IBMsinit.csh
and does not set/reset the time out control after that invocation.
Note:  Some systems will have /etc/csh.login invoke /etc/csh.login.local; if that is the case, it is permissible for the 'call' of /etc/profile.d/IBMumask.csh to be done from /etc/csh.login.local.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="186">
<cdf:Coverage>Orange</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.10.1.4.7</cdf:SectionNumber>
<cdf:SectionHeading>System Settings</cdf:SectionHeading>
<cdf:subSection>To be deleted if not a HIPAA customer. &amp;lt;br /&amp;gt;additional technical controls for HIPAA requirements.&amp;lt;br /&amp;gt;Deviations from the requirements in the HIPAA section must FIRST be reported to
HIPAA Risk Assessments/ATLANTA/Contr/IBM
before following standard risk assessment protocols.</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/profile.d/IBMsinit.sh</cdf:SystemValue_Parameter>
<cdf:Description>For systems containing PHI, set systems to terminate a session after 30 minutes of inactivity.</cdf:Description>
<cdf:RecommendedValue>File must exist, and contain at least:
TMOUT=1800
export TMOUT
Note:  A shorter time frame may be specified.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="187">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.10.1.4.8</cdf:SectionNumber>
<cdf:SectionHeading>System Settings</cdf:SectionHeading>
<cdf:subSection>To be deleted if not a HIPAA customer. &amp;lt;br /&amp;gt;additional technical controls for HIPAA requirements.&amp;lt;br /&amp;gt;Deviations from the requirements in the HIPAA section must FIRST be reported to
HIPAA Risk Assessments/ATLANTA/Contr/IBM
before following standard risk assessment protocols.</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/profile.d/IBMsinit.csh</cdf:SystemValue_Parameter>
<cdf:Description>For systems containing PHI, set systems to terminate a session after 30 minutes of inactivity.</cdf:Description>
<cdf:RecommendedValue>File must exist, and contain at least:
set autologout=30
Note:  A shorter time frame may be specified.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="188">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.10.1.4.9</cdf:SectionNumber>
<cdf:SectionHeading>System Settings</cdf:SectionHeading>
<cdf:subSection>To be deleted if not a HIPAA customer. &amp;lt;br /&amp;gt;additional technical controls for HIPAA requirements.&amp;lt;br /&amp;gt;Deviations from the requirements in the HIPAA section must FIRST be reported to
HIPAA Risk Assessments/ATLANTA/Contr/IBM
before following standard risk assessment protocols.</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/skel/.cshrc, /etc/skel/.login, /etc/skel/.profile, /etc/skel/.bashrc,
/etc/skel/.bash_profile,
/etc/skel/.bash_login,
/etc/skel/.tcshrc,</cdf:SystemValue_Parameter>
<cdf:Description>For systems containing PHI, set systems to terminate a session after 30 minutes of inactivity:  Ensure time out value is not overridden or is correctly established inside skeleton files.</cdf:Description>
<cdf:RecommendedValue>These files need not exist; but if they do:
Either does not override the time out for the user, or encodes the appropriate time out setting above. </cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="189">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.10.1.4.10</cdf:SectionNumber>
<cdf:SectionHeading>System Settings</cdf:SectionHeading>
<cdf:subSection>To be deleted if not a HIPAA customer. &amp;lt;br /&amp;gt;additional technical controls for HIPAA requirements.&amp;lt;br /&amp;gt;Deviations from the requirements in the HIPAA section must FIRST be reported to
HIPAA Risk Assessments/ATLANTA/Contr/IBM
before following standard risk assessment protocols.</cdf:subSection>
<cdf:SystemValue_Parameter>Login shell which supports time out</cdf:SystemValue_Parameter>
<cdf:Description>For systems containing PHI:
When establishing an individual to system ID, a 'login' shell which supports time out must be used.  The guidance for AD.10.1.4.1 and AD.10.1.4.6 to AD.10.1.4.10 are only sufficient for  login shells: /bin/csh, /bin/tcsh, /bin/sh, /bin/ksh, and /bin/bash.   They are also sufficient for /bin/sh where that is a symbolic or hard link to one of the previously listed shells.  If other login shells are permitted, similar controls must be established.  Where this is done, add it to the 'agreed to Value' column.  Neither the bourne nor dash shell support this control, and NEITHER may be used as a login shell.  /bin/false, /sbin/nologin, and other 'no login' shells are exempt from this requirement and are permitted; additional 'no login' shells defined by the account can be added to the 'agreed to Value' column.  The 'special purpose' shells /bin/sync, /sbin/shutdown, /sbin/halt  are exempt from this requirement, but are not to be set as the 'login shell' for individual to system  IDs.</cdf:Description>
<cdf:RecommendedValue>Individual to system IDs must have one of the following set as 'login shell':
/bin/csh, /bin/tcsh, /bin/sh, /bin/ksh, /bin/bash,/bin/sh, /bin/false, /sbin/nologin
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="190">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.10.1.4.2</cdf:SectionNumber>
<cdf:SectionHeading>System Settings</cdf:SectionHeading>
<cdf:subSection>To be deleted if not a HIPAA customer. &amp;lt;br /&amp;gt;additional technical controls for HIPAA requirements.&amp;lt;br /&amp;gt;Deviations from the requirements in the HIPAA section must FIRST be reported to
HIPAA Risk Assessments/ATLANTA/Contr/IBM
before following standard risk assessment protocols.</cdf:subSection>
<cdf:SystemValue_Parameter>Checksum</cdf:SystemValue_Parameter>
<cdf:Description>The 'native' checksum function utilizing at a minimum MD5 and SHA-1 algorithm must be installed.</cdf:Description>
<cdf:RecommendedValue>At least one of the following must be installed:
rpm -q coreutils
rpm -q openssl</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="191">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>Process requirement no requirement to B or S</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.10.1.4.3</cdf:SectionNumber>
<cdf:SectionHeading>System Settings</cdf:SectionHeading>
<cdf:subSection>To be deleted if not a HIPAA customer. &amp;lt;br /&amp;gt;additional technical controls for HIPAA requirements.&amp;lt;br /&amp;gt;Deviations from the requirements in the HIPAA section must FIRST be reported to
HIPAA Risk Assessments/ATLANTA/Contr/IBM
before following standard risk assessment protocols.</cdf:subSection>
<cdf:SystemValue_Parameter>Disk sanitisation</cdf:SystemValue_Parameter>
<cdf:Description>Prior to reuse, for IBM-managed systems identified as containing PHI, utilize a three pass overwrite methodology (character/pattern, a different character/pattern, then a third character/pattern) and verify success of final pass.
OR
Degauss or destroy the media.</cdf:Description>
<cdf:RecommendedValue>Use the system utility "dd" or equivalent to apply a three pass overwrite algorithm; overwrite all addressable locations with a character, a different character, then a third character and verify successful completion of the final pass.
OR
Degauss or destroy the media</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="192">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.1</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>Login success or failure</cdf:SystemValue_Parameter>
<cdf:Description>Not Redhat v5 and above</cdf:Description>
<cdf:RecommendedValue>File, /etc/syslog.conf, must include the following:
*.info;mail.none;authpriv.none;cron.none /var/log/messages
*.info;mail.none @&lt;IP address of TCIM Collector&gt;</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="193">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.2</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>audit.log</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must exist.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="194">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.3.1</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/audit/audit.rules</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain the following if the file exist on the server(where &lt;path to snmpd&gt; and &lt;root home&gt; refer to the proper path):
-a exit,always -F path=/usr -F perm=a
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="195">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.3.2</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/audit/audit.rules</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain the following if the file exist on the server(where &lt;path to snmpd&gt; and &lt;root home&gt; refer to the proper path):
-a exit,always -F path=/etc -F perm=a
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="196">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.3.3</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/audit/audit.rules</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain the following if the file exist on the server(where &lt;path to snmpd&gt; and &lt;root home&gt; refer to the proper path):
-a exit,always -F path=/var/log -F perm=a
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="197">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.3.4</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/audit/audit.rules</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain the following if the file exist on the server(where &lt;path to snmpd&gt; and &lt;root home&gt; refer to the proper path):
-a exit,always -F path=/tmp -F perm=a
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="198">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.3.5</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/audit/audit.rules</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain the following if the file exist on the server(where &lt;path to snmpd&gt; and &lt;root home&gt; refer to the proper path):
-a exit,always -F path=/var/log/faillog -F perm=a
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="199">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.3.6</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/audit/audit.rules</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain the following if the file exist on the server(where &lt;path to snmpd&gt; and &lt;root home&gt; refer to the proper path):
-a exit,always -F path=/var/log/messages -F perm=a
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="200">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.3.7</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/audit/audit.rules</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain the following if the file exist on the server(where &lt;path to snmpd&gt; and &lt;root home&gt; refer to the proper path):
-a exit,always -F path=/var/log/wtmp -F perm=a
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="201">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.3.8</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/audit/audit.rules</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain the following if the file exist on the server(where &lt;path to snmpd&gt; and &lt;root home&gt; refer to the proper path):
-a exit,always -F path=/var/log/secure -F perm=a
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="202">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.3.9</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/audit/audit.rules</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain the following if the file exist on the server(where &lt;path to snmpd&gt; and &lt;root home&gt; refer to the proper path):
-a exit,always -F path=/etc/ssh/sshd_config -F perm=wa</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="203">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.3.10</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/audit/audit.rules</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain the following if the file exist on the server(where &lt;path to snmpd&gt; and &lt;root home&gt; refer to the proper path):
-a exit,always -F path=/etc/default -F perm=wa</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="204">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.3.11</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/audit/audit.rules</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain the following if the file exist on the server(where &lt;path to snmpd&gt; and &lt;root home&gt; refer to the proper path):
-a exit,always -F path=/var/log/audit/audit.log -F perm=a</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="205">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.3.12</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/audit/audit.rules</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain the following if the file exist on the server(where &lt;path to snmpd&gt; and &lt;root home&gt; refer to the proper path):
-a exit,always -F path=/etc/audit/auditd.conf -F perm=wa</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="206">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.3.13</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/audit/audit.rules</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain the following if the file exist on the server(where &lt;path to snmpd&gt; and &lt;root home&gt; refer to the proper path):
-a exit,always -F path=/etc/audit/audit.rules -F perm=wa</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="207">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.3.14</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/audit/audit.rules</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain the following if the file exist on the server(where &lt;path to snmpd&gt; and &lt;root home&gt; refer to the proper path):
-a exit,always -F path=/sbin/auditctl -F perm=a</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="208">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.3.15</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/audit/audit.rules</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain the following if the file exist on the server(where &lt;path to snmpd&gt; and &lt;root home&gt; refer to the proper path):
-a exit,always -F path=/sbin/auditd -F perm=a</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="209">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.3.16</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/audit/audit.rules</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain the following if the file exist on the server(where &lt;path to snmpd&gt; and &lt;root home&gt; refer to the proper path):
-a exit,always -F path=/sbin/ausearch -F perm=a</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="210">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.3.17</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/audit/audit.rules</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain the following if the file exist on the server(where &lt;path to snmpd&gt; and &lt;root home&gt; refer to the proper path):
-a exit,always -F path=/etc/syslog.conf -F perm=wa</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="211">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.3.18</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/audit/audit.rules</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain the following if the file exist on the server(where &lt;path to snmpd&gt; and &lt;root home&gt; refer to the proper path):
-a exit,always -F path=/etc/syslog.conf -F perm=wa</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="212">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.3.19</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/audit/audit.rules</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain the following if the file exist on the server(where &lt;path to snmpd&gt; and &lt;root home&gt; refer to the proper path):
-a exit,always -F path=&lt;path to snmpd &gt;/snmpd.conf -F perm=wa</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="213">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.3.20</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/audit/audit.rules</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain the following if the file exist on the server(where &lt;path to snmpd&gt; and &lt;root home&gt; refer to the proper path):
-a exit,always -F path=&lt;path to snmpd&gt;/snmp/snmpd.conf -F perm=wa</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="214">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.3.21</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/audit/audit.rules</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain the following if the file exist on the server(where &lt;path to snmpd&gt; and &lt;root home&gt; refer to the proper path):
-a exit,always -F path=&lt;path to snmpd&gt;/snmpd/snmpd.conf -F perm=wa</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="215">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.3.22</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/audit/audit.rules</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain the following if the file exist on the server(where &lt;path to snmpd&gt; and &lt;root home&gt; refer to the proper path):
-a exit,always -F path=&lt;root home&gt;/.rhosts -F perm=wa</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="216">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.3.23</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/audit/audit.rules</cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain the following if the file exist on the server(where &lt;path to snmpd&gt; and &lt;root home&gt; refer to the proper path):
-a exit,always -F path&lt;root home&gt;/.netrc -F perm=wa</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="217">
<cdf:Coverage>Red</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.20.1.2.4</cdf:SectionNumber>
<cdf:SectionHeading>Logging </cdf:SectionHeading>
<cdf:subSection> To be deleted if not using Privileged Monitoring Service.&amp;lt;br /&amp;gt;This section details additional requirements for Privilege Monitoring only</cdf:subSection>
<cdf:SystemValue_Parameter>/etc/sudoers </cdf:SystemValue_Parameter>
<cdf:Description>Linux Redhat v5 and above only</cdf:Description>
<cdf:RecommendedValue>Must contain:
TCIM_user_account ALL=(ALL) NOPASSWD: /sbin/ausearch
Note: Replace TCIM_User_account with the account name of the TCIM collection ID</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="218">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>Informational requirement no requirement to B or S</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.5.0.0</cdf:SectionNumber>
<cdf:SectionHeading>Privileged Authorizations/Userids:</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Note</cdf:SystemValue_Parameter>
<cdf:Description>Description of privileged Ids : The rows in section 5 below describe the list of userIDs or groups that have Privileged authority.</cdf:Description>
<cdf:RecommendedValue>No value to be set</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="219">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.2.1</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>password specification within /etc/shadow</cdf:SystemValue_Parameter>
<cdf:Description>In /etc/shadow, password (second field) cannot be assigned the null value (::) as this would allow the id to be accessed without entering a password or using the 'empty' (null) password.</cdf:Description>
<cdf:RecommendedValue>The second field may not be null.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="220">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.2.4.0</cdf:SectionNumber>
<cdf:SectionHeading>Logging</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>use of pam_tally.so Vs pam_tally2.so</cdf:SystemValue_Parameter>
<cdf:Description>Restriction of where which module may be used.</cdf:Description>
<cdf:RecommendedValue>For all distributions other than Red Hat, the desired module if present may be used.
RH V5 must use pam_tally.so
RH V6 and later must use pam_tally2.so</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="221">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.1.2</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>userIDs</cdf:SystemValue_Parameter>
<cdf:Description>Ensuring OSRs are owned by privileged IDs.
Note: SYS_UID_MAX and UID_MIN are settings found in /etc/login.defs.
Note: SLES 10 and 11 use the parameter name SYSTEM_UID_MAX in place of SYS_UID_MAX.</cdf:Description>
<cdf:RecommendedValue>A userid with a UID which is less than or equal to SYS_UID_MAX.
If SYS_UID_MAX is not set, then a userid with a UID which is less than UID_MIN.
Note: It is not valid for an OSR to be owned by a UID which does not have a userid defined to it with in /etc/passwd.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="222">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.1.3</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Groupids</cdf:SystemValue_Parameter>
<cdf:Description>Ensuring OSRs are owned by privileged groups.
Note: SYS_GID_MAX and GID_MIN are settings found in /etc/login.defs.
Note: SLES 10 and 11 use the parameter name SYSTEM_GID_MAX in place of SYS_GID_MAX. </cdf:Description>
<cdf:RecommendedValue>A group with a GID which is less than or equal to SYS_GID_MAX.
If SYS_GID_MAX is not set, then a group with a GID which is less than GID_MIN.
Exception: The group 'users' will have a GID of 100, and is not a group permitted to own an OSR.
Note: It is not valid for an OSR to be owned by a gid which does not have a group defined to it with in /etc/group.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="223">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.8.13.1.2</cdf:SectionNumber>
<cdf:SectionHeading>Protecting Resources - OSR's</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>All active entries.</cdf:SystemValue_Parameter>
<cdf:Description>Ensure OSR's are owned by privileged ID's.</cdf:Description>
<cdf:RecommendedValue>Must be owned an id/group as identified in section 5.0 'The following system ids and group ids must own OSRs', or other id controlled as an id which is subject to being one which has Security &amp; System Administrative Authority.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="224">
<cdf:Coverage>Blue</cdf:Coverage>
<cdf:operation>Informational requirement no requirement to B or S</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.6.0.0</cdf:SectionNumber>
<cdf:SectionHeading>Additional Customer Controls</cdf:SectionHeading>
<cdf:subSection>To be deleted if no Customer specific controls - if Customer specific controls update to add controls accordingly in the same order as Section 1 - 5 above.</cdf:subSection>
<cdf:SystemValue_Parameter>No requirements in this category</cdf:SystemValue_Parameter>
<cdf:Description>No requirements in this category</cdf:Description>
<cdf:RecommendedValue>No requirements in this category</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="225">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.30.0.1.0</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection>To be deleted, if not using GDPR / FFIEC
This section details additional requirements for GDPR / FFIEC only</cdf:subSection>
<cdf:SystemValue_Parameter>OS Automatic Logoff </cdf:SystemValue_Parameter>
<cdf:Description>Automatically log off users from IBM-managed client systems that process PI, after a defined period of inactivity. </cdf:Description>
<cdf:RecommendedValue>For systems containing PI, set systems to terminate a session after  of inactivity. </cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="gdpr" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="226">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.30.0.1.1</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection>To be deleted, if not using GDPR / FFIEC
This section details additional requirements for GDPR / FFIEC only</cdf:subSection>
<cdf:SystemValue_Parameter>OS Automatic Logoff
/etc/profile</cdf:SystemValue_Parameter>
<cdf:Description>Automatically log off users from IBM-managed client systems that process PI, after a defined period of inactivity. </cdf:Description>
<cdf:RecommendedValue>For systems containing PI:
File must trigger an invocation of
. /etc/profile.d/IBMsinit.sh
and does not set/reset the time out control after that invocation.
Note: Some systems will have /etc/profile invoke /etc/profile.local; if that is the case, it is permissible for the 'call' of /etc/profile.d/IBMsinit.sh to be done from /etc/profile.local.
Note: existence and permissions of file established in earlier rule.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="gdpr" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="227">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.30.0.1.2</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection>To be deleted, if not using GDPR / FFIEC
This section details additional requirements for GDPR / FFIEC only</cdf:subSection>
<cdf:SystemValue_Parameter>OS Automatic Logoff
/etc/csh.login</cdf:SystemValue_Parameter>
<cdf:Description>Automatically log off users from IBM-managed client systems that process PI, after a defined period of inactivity. </cdf:Description>
<cdf:RecommendedValue>For systems containing PI:
If csh is installed, file must trigger an invocation of
source /etc/profile.d/IBMsinit.csh
and does not set/reset the time out control after that invocation.
Note: Some systems will have /etc/csh.login invoke /etc/csh.login.local; if that is the case, it is permissible for the 'call' of /etc/profile.d/IBMsinit.csh to be done from /etc/csh.login.local.
Note: existence and permissions of file established in earlier rule.
Note: The 'standard' package for installing csh is the package tcsh; however, any variant of csh installed will trigger this requirement.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="gdpr" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="228">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.30.0.1.3</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection>To be deleted, if not using GDPR / FFIEC
This section details additional requirements for GDPR / FFIEC only</cdf:subSection>
<cdf:SystemValue_Parameter>OS Automatic Logoff
/etc/profile.d/IBMsinit.sh</cdf:SystemValue_Parameter>
<cdf:Description>For systems containing PI, set systems to terminate a session after a defined period of inactivity.
TMOUT is specified in seconds.</cdf:Description>
<cdf:RecommendedValue>For systems containing PI, set systems to terminate a session after 6 hours of inactivity:
File must  contain at least:
TMOUT=21600
export TMOUT
Note: A shorter time frame may be specified.
Note: Verification of the existence and permissions of the file is specified in an earlier rule.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="gdpr" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="229">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.30.0.1.4</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection>To be deleted, if not using GDPR / FFIEC
This section details additional requirements for GDPR / FFIEC only</cdf:subSection>
<cdf:SystemValue_Parameter>OS Automatic Logoff
/etc/profile.d/IBMsinit.csh</cdf:SystemValue_Parameter>
<cdf:Description>For systems containing PI, set systems to terminate a session after a defined period of inactivity.
autologout is specified in minutes.</cdf:Description>
<cdf:RecommendedValue>For systems containing PI, set systems to terminate a session after 6 hours of inactivity:
If csh is installed, file must contain at least:
set autologout=360
Note: A shorter time frame may be specified.
Note: The 'standard' package for installing csh is the package tcsh; however, any variant of csh installed will trigger this requirement.
Note: Verification of the existence and permissions of the file is specified in an earlier rule.
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="gdpr" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="230">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.30.0.1.5</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection>To be deleted, if not using GDPR / FFIEC
This section details additional requirements for GDPR / FFIEC only</cdf:subSection>
<cdf:SystemValue_Parameter>OS Automatic Logoff
skeleton files,
</cdf:SystemValue_Parameter>
<cdf:Description>For systems containing PI, set systems to terminate a session after a defined period of inactivity:  Ensure time out value is not overridden or is correctly established inside skeleton files: /etc/skel/.cshrc, /etc/skel/.login, /etc/skel/.profile, /etc/skel/.bashrc,
/etc/skel/.bash_profile, /etc/skel/.bash_login, /etc/skel/.tcshrc,
</cdf:Description>
<cdf:RecommendedValue>These files need not exist; but if they do:
Either does not override the time out for the user, or encodes the appropriate time out setting above.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="gdpr" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="231">
<cdf:Coverage>Orange</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.30.0.1.6</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection>To be deleted, if not using GDPR / FFIEC
This section details additional requirements for GDPR / FFIEC only</cdf:subSection>
<cdf:SystemValue_Parameter>OS Automatic Logoff
Login shell which supports time out</cdf:SystemValue_Parameter>
<cdf:Description>For systems containing PI:
When establishing an individual to system ID, a 'login' shell which supports time out must be used. The guidance for Section10.1.4.1 and section10.1.4.6 to section10.1.4.10 are only sufficient for login shells listed in AD.10.1.4.11. They are also sufficient for /bin/sh where that is a symbolic or hard link to one of the previously listed shells. If other login shells are permitted, similar controls must be established. Where this is done, add it to the 'agreed to Value' column. Neither the bourne nor dash shell support this control, and NEITHER may be used as a login shell for individual to system IDs. /bin/false, /sbin/nologin, and other 'no login' shells are exempt from this requirement and are permitted; additional 'no login' shells defined by the account can be added to the 'agreed to Value' column. The 'special purpose' shells /bin/sync, /sbin/shutdown, /sbin/halt are exempt from this requirement, but are not to be set as the 'login shell' for individual to system IDs.</cdf:Description>
<cdf:RecommendedValue>For systems containing PI:
Individual to system IDs must have one of the following set as 'login shell':
/bin/csh, /bin/tcsh, /bin/sh, /bin/ksh, /bin/bash,/bin/sh, /bin/false, /sbin/nologin, /usr/bin/sh,/usr/bin/bash,/usr/sbin/nologin, /bin/ksh93,
/usr/bin/ksh,
/usr/bin/rksh,
/usr/bin/ksh93
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="gdpr" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="232">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.30.0.1.7</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection>To be deleted, if not using GDPR / FFIEC
This section details additional requirements for GDPR / FFIEC only</cdf:subSection>
<cdf:SystemValue_Parameter>OS Automatic Logoff
Restrict user selection to login shells which support time out</cdf:SystemValue_Parameter>
<cdf:Description>For systems containing PI:
Ensure that /etc/shells only allows users to select shells which are compliant with the requirements of AD.10.1.4.10.
Note:  Excepting the items listed as optional, the IBM recommended value aligns to the file content 'as delivered' by a standard RH install.</cdf:Description>
<cdf:RecommendedValue>For systems containing PI:
# The file /etc/shells to contain:
/bin/sh
/bin/bash
/sbin/nologin
/usr/bin/sh
/usr/bin/bash
/usr/sbin/nologin
/bin/tcsh
/bin/csh
/bin/ksh
/bin/rksh
# and optionally
/bin/false
/bin/ksh93
/usr/bin/ksh
/usr/bin/rksh
/usr/bin/ksh93</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="gdpr" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="233">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.30.0.2.1</cdf:SectionNumber>
<cdf:SectionHeading>Logging</cdf:SectionHeading>
<cdf:subSection>To be deleted, if not using GDPR / FFIEC
This section details additional requirements for GDPR / FFIEC only</cdf:subSection>
<cdf:SystemValue_Parameter>Logging in external system, auth.</cdf:SystemValue_Parameter>
<cdf:Description>System and event logs from IBM-managed client systems that process PI must be copied to a system outside the control of the system administrator or operator whose activities are being logged.
References:
1. See the rsyslog.conf(5) man page for more information.

Notes:
The double "at" sign (@@) directs rsyslog to use TCP to send log messages to the server, which is a more reliable transport mechanism than the default UDP protocol.</cdf:Description>
<cdf:RecommendedValue>On systems that process PI, set syslog to send 'auth' data to remote server via /etc/rsyslog.conf file:
auth.$1 @@$2

Where $1 is 'info' or 'debug' and $2 is the IP address of remote syslog server.  @@ may be replaced by @.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="gdpr" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="234">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.30.0.2.2</cdf:SectionNumber>
<cdf:SectionHeading>Logging</cdf:SectionHeading>
<cdf:subSection>To be deleted, if not using GDPR / FFIEC
This section details additional requirements for GDPR / FFIEC only</cdf:subSection>
<cdf:SystemValue_Parameter>Logging in external system, authpriv.</cdf:SystemValue_Parameter>
<cdf:Description>System and event logs from IBM-managed client systems that process PI must be copied to a system outside the control of the system administrator or operator whose activities are being logged.
References:
1. See the rsyslog.conf(5) man page for more information.

Notes:
The double "at" sign (@@) directs rsyslog to use TCP to send log messages to the server, which is a more reliable transport mechanism than the default UDP protocol.</cdf:Description>
<cdf:RecommendedValue>On systems that process PI, set syslog to send 'authpriv' data to remote server via /etc/rsyslog.conf file:
authpriv.$1 @@$2

Where $1 is 'info' or 'debug' and $2 is the IP address of remote syslog server.  @@ may be replaced by @.
</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="gdpr" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="235">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.2.7.1</cdf:SectionNumber>
<cdf:SectionHeading>Logging</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Synchronized system clocks, ensure it is active.</cdf:SystemValue_Parameter>
<cdf:Description>Keep system clocks synchronized with a common reference time source to improve log accuracy.  At least one of the time services must be active.</cdf:Description>
<cdf:RecommendedValue>ntpd or chronyd must be running.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="236">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.2.7.2</cdf:SectionNumber>
<cdf:SectionHeading>Logging</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Synchronized system clocks, chronyd has a server.</cdf:SystemValue_Parameter>
<cdf:Description>Keep system clocks synchronized with a common reference time source to improve log accuracy.  If chronyd is active, ensure at least one server is configured for access.</cdf:Description>
<cdf:RecommendedValue>If chronyd is active, ensure it has minimum required configuration: At least one pool or server is specified.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="237">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.2.7.3</cdf:SectionNumber>
<cdf:SectionHeading>Logging</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Synchronized system clocks, chronyd does not have excess privilege</cdf:SystemValue_Parameter>
<cdf:Description>Keep system clocks synchronized with a common reference time source to improve log accuracy.  Ensure task is not running with excessive privilege, use the special id chrony.</cdf:Description>
<cdf:RecommendedValue>If chronyd is active, ensure it has minimum required configuration: Task is running as chrony id.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="238">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.2.7.4</cdf:SectionNumber>
<cdf:SectionHeading>Logging</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Synchronized system clocks, ntpd has secure defaults</cdf:SystemValue_Parameter>
<cdf:Description>Keep system clocks synchronized with a common reference time source to improve log accuracy.  if ntpd is active, ensure task restrict defaults are set to secure values.</cdf:Description>
<cdf:RecommendedValue>If ntpd is active, set key defaults for both ip4 and ip6 to:
nomodify notrap nopeer noquery</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="239">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.2.7.5</cdf:SectionNumber>
<cdf:SectionHeading>Logging</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Synchronized system clocks, ntpd has a server.</cdf:SystemValue_Parameter>
<cdf:Description>Keep system clocks synchronized with a common reference time source to improve log accuracy.  If ntpd is active, ensure at least one server is configured for access.</cdf:Description>
<cdf:RecommendedValue>If ntpd is active, ensure it has minimum required configuration:
At least one pool or server is specified.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="240">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.4.3.1</cdf:SectionNumber>
<cdf:SectionHeading>System Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Ensure SELinux is installed</cdf:SystemValue_Parameter>
<cdf:Description>SELinux provides Mandatory Access Controls.
Without a Mandatory Access Control system installed only the default Discretionary Access Control system will be available.</cdf:Description>
<cdf:RecommendedValue>SELinux is installed, unless AppArmor is installed and enabled.
Note:  AppArmor is not support by RedHat.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="241">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.4.3.2</cdf:SectionNumber>
<cdf:SectionHeading>System Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Ensure the SELinux state is enforcing or permissive.</cdf:SystemValue_Parameter>
<cdf:Description>Ensure the SELinux state is one which ensure logging is captured.

Set SELinux to enable when the system is booted, and currently enabled.

SELinux must be enabled at boot time in to ensure that the controls it provides are in effect at all times.  If it isn't 'enforcing' now, it is important to immediately correct it.

Note:  It will be important to use 'permissive' in new environments and potentially revert to permissive when installing code or making other significant changes to the environment, until it is determined what configuration changes (if any) are needed for an application to run correctly under 'enforcing'.</cdf:Description>
<cdf:RecommendedValue>Where SELinux is enabled, require 'enforcing' or 'permissive' mode:
SELINUX=permissive is set in /etc/selinux/config

And system shows 'Current mode' ( sestatus | grep 'Current mode' )
showing:
Current mode:   permissive

Note:  While teams are encouraged to move to 'enforcing', it is not required at this time.  'enforcing' is also accepted.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="242">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.4.4.1</cdf:SectionNumber>
<cdf:SectionHeading>System Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Ensure AppArmor is installed if preferred over SELinux</cdf:SystemValue_Parameter>
<cdf:Description>AppArmor provides Mandatory Access Controls.
Without a Mandatory Access Control system installed only the default Discretionary Access Control system will be available.</cdf:Description>
<cdf:RecommendedValue>AppArmor is installed and enabled if SELinux is not enabled.
Note:  AppArmor is not support by RedHat.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="243">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.1.4.4.2</cdf:SectionNumber>
<cdf:SectionHeading>System Settings</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>Ensure the AppArmor state is enforcing or complain, if SELinux is not in use.</cdf:SystemValue_Parameter>
<cdf:Description>Ensure the AppArmor state is in a mode which at least captures logging, unless SELinux is in use.

Set AppArmor to enable when the system is booted, and currently enabled.

AppArmor must be enabled at boot time in to ensure that the controls it provides are in effect at all times.  If it isn't 'loaded' now, it is important to immediately correct it.

Note:  It will be important to use 'complain mode' in new environments and potentially revert to 'complain mode' when installing code or making other significant changes to the environment, until it is determined what configuration changes (if any) are needed for an application to run correctly under 'enforce mode'.</cdf:Description>
<cdf:RecommendedValue>If SELinux is not in use, then apparmor_status shows the module loaded, and profiles in complain mode or more strict

Note:  While teams are encouraged to move to 'enforcing', it is not required at this time.  'enforcing' is also accepted.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="244">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>baseline</cdf:operation>
<cdf:Foundation isFoundation="false"/>
<cdf:SectionNumber>AD.40.0.1</cdf:SectionNumber>
<cdf:SectionHeading>Business Use Notice</cdf:SectionHeading>
<cdf:subSection>This section details Business Use Notice requirement for Internal / Shared servers only (ITSS)
To be deleted, if this TechSpec is not applicable for internal / Shared Environment (non-commercial)</cdf:subSection>
<cdf:SystemValue_Parameter>Business Use Notice</cdf:SystemValue_Parameter>
<cdf:Description>Establish conditions for acceptable use for every asset or group of assets.  Make the acceptable use policy readily available to users, and consider asking users to confirm that they have read and understood these terms.  Present this notice to user every time the conditions change.  Include at least the following elements:  a) Which information can securely be processed by or stored on the asset (using the data classes in section 2.0) b) Which information cannot be processed by or stored on the asset (using the data classes in section 2.0) c) If secure processing and storage of the data depends on the appropriate use of any user configurable controls, clearly explain how these controls should be applied for any class of data, and what the default settings are. For example, explain how to apply effective access controls to limit access to confidential data, or when and how to enable encryption.</cdf:Description>
<cdf:RecommendedValue>Business Use Notice exists

How implemented:
/etc/motd or /etc/issue

Text to be displayed :
"This system should be used for conducting IBM's business or for purposes authorized by IBM management. It is mandatory to comply with all the requirements listed in the applicable security policy and only process or store the data classes approved for this asset type. Use is subject to audit at any time by IBM management."</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
<cdf:TechSpecsEntries id="245">
<cdf:Coverage>Green</cdf:Coverage>
<cdf:operation>healthcheck and baseline</cdf:operation>
<cdf:Foundation isFoundation="true"/>
<cdf:SectionNumber>AD.1.1.2.2</cdf:SectionNumber>
<cdf:SectionHeading>Password Requirements</cdf:SectionHeading>
<cdf:subSection></cdf:subSection>
<cdf:SystemValue_Parameter>second field of /etc/passwd</cdf:SystemValue_Parameter>
<cdf:Description>In /etc/passwd, password (second field) cannot be assigned the null value (::) as this would allow the id to be accessed without entering a password or using the 'empty' (null) password if nullok is ever specified.  Never allow this mechanism, as all id's have read access to /etc/passwd and can search for this condition.</cdf:Description>
<cdf:RecommendedValue>The second field /etc/passwd may not be null.</cdf:RecommendedValue>
<cdf:Comments></cdf:Comments>
<cdf:Audit type="default" replacedBy=""/>
</cdf:TechSpecsEntries>
</cdf:TechSpecsEntriesList>
<scm:collector id="ShellsV1" scm:classname="unix.any.ShellsV1" scm:minimumVersion="8">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="PERM"></scm:parameter>
<scm:parameter id="OWNER"></scm:parameter>
<scm:parameter id="GROUP"></scm:parameter>
<scm:parameter id="SCAN_LOCAL">1</scm:parameter>
<scm:parameter id="SCAN_REMOTE">0</scm:parameter>
</scm:collector>
<scm:collector id="FtpUsersV1" scm:classname="unix.any.FtpUsersV1" scm:minimumVersion="3">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="FILE_NAME"></scm:parameter>
</scm:collector>
<scm:collector id="HomeFsV2" scm:classname="unix.any.HomeFsV2" scm:minimumVersion="6">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="IGNORED_SHELLS"></scm:parameter>
<scm:parameter id="PERM"></scm:parameter>
<scm:parameter id="SCAN_REMOTE">0</scm:parameter>
<scm:parameter id="IGNORED_USERS"></scm:parameter>
<scm:parameter id="FILES">.</scm:parameter>
<scm:parameter id="FILES">.netrc</scm:parameter>
<scm:parameter id="FILES">.rhosts</scm:parameter>
<scm:parameter id="OWNER"></scm:parameter>
<scm:parameter id="SCAN_LOCAL">1</scm:parameter>
<scm:parameter id="GROUP"></scm:parameter>
<scm:parameter id="PROCESS_LDAP_INFO"></scm:parameter>
</scm:collector>
<scm:collector id="SyslogngConfV1" scm:classname="unix.any.SyslogngConfV1" scm:minimumVersion="14">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="SYSLOG_PATH"></scm:parameter>
<scm:parameter id="SYSLOG_NG_PATH"></scm:parameter>
</scm:collector>
<scm:collector id="HostsEquivV1" scm:classname="unix.any.HostsEquivV1" scm:minimumVersion="4">
<scm:configFile usage="missing" type="name"></scm:configFile>
</scm:collector>
<scm:collector id="motd" scm:classname="unix.any.motd" scm:minimumVersion="2">
<scm:configFile usage="missing" type="name"></scm:configFile>
</scm:collector>
<scm:collector id="InittabV2" scm:classname="unix.any.wwep.InittabV2" scm:minimumVersion="11">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="INCL_REM_GATHERING"></scm:parameter>
</scm:collector>
<scm:collector id="SecureTtyV1" scm:classname="unix.multi.SecureTtyV1" scm:minimumVersion="3">
<scm:configFile usage="missing" type="name"></scm:configFile>
</scm:collector>
<scm:collector id="UmaskExtV1" scm:classname="linux.any.UmaskExtV1" scm:minimumVersion="10">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="UMASK_FILES">/etc/bashrc</scm:parameter>
<scm:parameter id="UMASK_FILES">/etc/profile.local</scm:parameter>
<scm:parameter id="UMASK_FILES">/etc/skel/.bash_login</scm:parameter>
<scm:parameter id="UMASK_FILES">/etc/skel/.bash_profile</scm:parameter>
<scm:parameter id="UMASK_FILES">/etc/skel/.bashrc</scm:parameter>
<scm:parameter id="UMASK_FILES">/etc/skel/.cshrc</scm:parameter>
<scm:parameter id="UMASK_FILES">/etc/skel/.login</scm:parameter>
<scm:parameter id="UMASK_FILES">/etc/skel/.profile</scm:parameter>
<scm:parameter id="UMASK_FILES">/etc/skel/.tcshrc</scm:parameter>
</scm:collector>
<scm:collector id="PAMDisabledUsersV1" scm:classname="unix.any.PAMDisabledUsersV1" scm:minimumVersion="11">
<scm:configFile usage="missing" type="name"></scm:configFile>
</scm:collector>
<scm:collector id="UsersV3" scm:classname="unix.any.UsersV3" scm:minimumVersion="7">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="CHECK_PWD_USERNAMES"></scm:parameter>
<scm:parameter id="SCAN_REMOTE">1</scm:parameter>
<scm:parameter id="PASSWD_BLACKLIST"></scm:parameter>
<scm:parameter id="PROCESS_LDAP_INFO"></scm:parameter>
<scm:parameter id="PASSWD_BLACKLIST_URL"></scm:parameter>
</scm:collector>
<scm:collector id="AnonFtpFilePermsV1" scm:classname="unix.any.AnonFtpFilePermsV1" scm:minimumVersion="11">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="OWNER"></scm:parameter>
<scm:parameter id="SCAN_REMOTE">0</scm:parameter>
<scm:parameter id="MAX_RETURN"></scm:parameter>
<scm:parameter id="IS_SYSTEM">1</scm:parameter>
<scm:parameter id="MAX_SCAN"></scm:parameter>
<scm:parameter id="SCAN_LOCAL">1</scm:parameter>
<scm:parameter id="GROUP"></scm:parameter>
<scm:parameter id="IS_USER">1</scm:parameter>
<scm:parameter id="EXCLUDE_DIRS"></scm:parameter>
<scm:parameter id="SYSTEM_DIRS"></scm:parameter>
<scm:parameter id="PERM"></scm:parameter>
</scm:collector>
<scm:collector id="SnmpdV1" scm:classname="unix.any.SnmpdV1" scm:minimumVersion="7">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="SNMPD_CONF"></scm:parameter>
</scm:collector>
<scm:collector id="XinetdV1" scm:classname="unix.multi.XinetdV1" scm:minimumVersion="4">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="XINETD_CONF_FILE"></scm:parameter>
<scm:parameter id="PROCESS_INCLUDE_DIR"></scm:parameter>
</scm:collector>
<scm:collector id="RSyslogV1" scm:classname="unix.any.RSyslogV1" scm:minimumVersion="7">
<scm:configFile usage="missing" type="name"></scm:configFile>
</scm:collector>
<scm:collector id="FilePermsV2-dir_perms" scm:classname="unix.any.FilePermsV2" scm:minimumVersion="16">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="SCAN_LINKS">0</scm:parameter>
<scm:parameter id="PERM">-???????w??</scm:parameter>
<scm:parameter id="PERM">-???????wt?</scm:parameter>
<scm:parameter id="PERM">-???????wx?</scm:parameter>
<scm:parameter id="PERM">-?????s?w??</scm:parameter>
<scm:parameter id="PERM">-?????x?w??</scm:parameter>
<scm:parameter id="PERM">-??s????w??</scm:parameter>
<scm:parameter id="PERM">-??x????w??</scm:parameter>
<scm:parameter id="PERM">d???????w??</scm:parameter>
<scm:parameter id="PERM">d???????wt?</scm:parameter>
<scm:parameter id="PERM">d???????wx?</scm:parameter>
<scm:parameter id="PERM">d?????s?w??</scm:parameter>
<scm:parameter id="PERM">d?????x?w??</scm:parameter>
<scm:parameter id="PERM">d??s????w??</scm:parameter>
<scm:parameter id="PERM">d??x????w??</scm:parameter>
<scm:parameter id="PERM">d??????????</scm:parameter>
<scm:parameter id="SCAN_REMOTE">0</scm:parameter>
<scm:parameter id="FILES">/opt/*</scm:parameter>
<scm:parameter id="FILES">/tmp/*</scm:parameter>
<scm:parameter id="FILES">/usr/local/*</scm:parameter>
<scm:parameter id="FILES">/var/*</scm:parameter>
<scm:parameter id="OWNER"></scm:parameter>
<scm:parameter id="SCAN_LOCAL">1</scm:parameter>
<scm:parameter id="GROUP"></scm:parameter>
<scm:parameter id="MAX_SCAN"></scm:parameter>
<scm:parameter id="MAX_RETURN"></scm:parameter>
</scm:collector>
<scm:collector id="FilePermsV2-varlogsub" scm:classname="unix.any.FilePermsV2" scm:minimumVersion="16">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="SCAN_LINKS">0</scm:parameter>
<scm:parameter id="SCAN_REMOTE">0</scm:parameter>
<scm:parameter id="FILES">/var/log</scm:parameter>
<scm:parameter id="FILES">/var/log/*</scm:parameter>
<scm:parameter id="OWNER"></scm:parameter>
<scm:parameter id="SCAN_LOCAL">1</scm:parameter>
<scm:parameter id="GROUP"></scm:parameter>
<scm:parameter id="MAX_RETURN"></scm:parameter>
<scm:parameter id="PERM"></scm:parameter>
<scm:parameter id="MAX_SCAN"></scm:parameter>
</scm:collector>
<scm:collector id="FilePermsV2-perms" scm:classname="unix.any.FilePermsV2" scm:minimumVersion="16">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="SCAN_LINKS">0</scm:parameter>
<scm:parameter id="PERM"></scm:parameter>
<scm:parameter id="SCAN_REMOTE">0</scm:parameter>
<scm:parameter id="OWNER"></scm:parameter>
<scm:parameter id="SCAN_LOCAL">1</scm:parameter>
<scm:parameter id="GROUP"></scm:parameter>
<scm:parameter id="MAX_SCAN"></scm:parameter>
<scm:parameter id="MAX_RETURN"></scm:parameter>
<scm:parameter id="FILES">/etc/bashrc</scm:parameter>
<scm:parameter id="FILES">/etc/profile.local</scm:parameter>
<scm:parameter id="FILES">/etc/skel/.bash_login</scm:parameter>
<scm:parameter id="FILES">/etc/skel/.bash_profile</scm:parameter>
<scm:parameter id="FILES">/etc/skel/.bashrc</scm:parameter>
<scm:parameter id="FILES">/etc/skel/.cshrc</scm:parameter>
<scm:parameter id="FILES">/etc/skel/.login</scm:parameter>
<scm:parameter id="FILES">/etc/skel/.profile</scm:parameter>
<scm:parameter id="FILES">/etc/skel/.tcshrc</scm:parameter>
<scm:parameter id="FILES">/etc/exports</scm:parameter>
<scm:parameter id="FILES">/etc/ftpusers</scm:parameter>
<scm:parameter id="FILES">/etc/security/opasswd</scm:parameter>
<scm:parameter id="FILES">/etc/shadow</scm:parameter>
<scm:parameter id="FILES">/etc/snmp/snmpd.conf</scm:parameter>
<scm:parameter id="FILES">/etc/snmp/snmpd.conf</scm:parameter>
<scm:parameter id="FILES">/etc/snmpd.conf</scm:parameter>
<scm:parameter id="FILES">/etc/snmpd/snmpd.conf</scm:parameter>
<scm:parameter id="FILES">/etc/sysctl.conf</scm:parameter>
<scm:parameter id="FILES">/etc/vsftpd.ftpusers</scm:parameter>
<scm:parameter id="FILES">/proc/sys/net/ipv4/conf/all/accept_redirects</scm:parameter>
<scm:parameter id="FILES">/proc/sys/net/ipv4/icmp_echo_ignore_broadcasts</scm:parameter>
<scm:parameter id="FILES">/proc/sys/net/ipv4/tcp_syncookies</scm:parameter>
<scm:parameter id="FILES">/var/log/faillog</scm:parameter>
<scm:parameter id="FILES">/var/log/messages</scm:parameter>
<scm:parameter id="FILES">/var/log/secure</scm:parameter>
<scm:parameter id="FILES">/var/log/tallylog</scm:parameter>
<scm:parameter id="FILES">/var/log/wtmp</scm:parameter>
<scm:parameter id="FILES">/var/log/auth.log</scm:parameter>
<scm:parameter id="FILES">/var/log/syslog</scm:parameter>
<scm:parameter id="FILES">/</scm:parameter>
<scm:parameter id="FILES">/var</scm:parameter>
<scm:parameter id="FILES">/tmp</scm:parameter>
<scm:parameter id="FILES">/var/tmp</scm:parameter>
</scm:collector>
<scm:collector id="FilePermsV2-\etc\profile" scm:classname="unix.any.FilePermsV2" scm:minimumVersion="16">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="SCAN_LINKS">0</scm:parameter>
<scm:parameter id="PERM"></scm:parameter>
<scm:parameter id="SCAN_REMOTE">0</scm:parameter>
<scm:parameter id="FILES">/etc/profile.d/IBMsinit.csh</scm:parameter>
<scm:parameter id="FILES">/etc/profile.d/IBMsinit.sh</scm:parameter>
<scm:parameter id="OWNER"></scm:parameter>
<scm:parameter id="SCAN_LOCAL">1</scm:parameter>
<scm:parameter id="GROUP"></scm:parameter>
<scm:parameter id="MAX_SCAN"></scm:parameter>
<scm:parameter id="MAX_RETURN"></scm:parameter>
</scm:collector>
<scm:collector id="XserverAclV1" scm:classname="unix.any.XserverAclV1" scm:minimumVersion="7">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="DISPLAY_VALUE"></scm:parameter>
</scm:collector>
<scm:collector id="RcdV2" scm:classname="unix.any.wwep.RcdV2" scm:minimumVersion="14">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="INCL_REM_GATHERING"></scm:parameter>
</scm:collector>
<scm:collector id="NisMapsV1" scm:classname="unix.any.NisMapsV1" scm:minimumVersion="2">
<scm:configFile usage="missing" type="name"></scm:configFile>
</scm:collector>
<scm:collector id="InetdV1" scm:classname="unix.any.InetdV1" scm:minimumVersion="2">
<scm:configFile usage="missing" type="name"></scm:configFile>
</scm:collector>
<scm:collector id="FileSearchv1" scm:classname="unix.any.FileSearchV1" scm:minimumVersion="9">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="COMMENT_DELIM">#</scm:parameter>
<scm:parameter id="SEARCHSTRING">*</scm:parameter>
<scm:parameter id="SEARCH_METHOD"></scm:parameter>
<scm:parameter id="IGNORECASE">1</scm:parameter>
<scm:parameter id="LINE_CONT_DELIM"></scm:parameter>
<scm:parameter id="FILENAME">/etc/csh.login</scm:parameter>
<scm:parameter id="FILENAME">/etc/csh.login.local</scm:parameter>
<scm:parameter id="FILENAME">/etc/issue</scm:parameter>
<scm:parameter id="FILENAME">/etc/nsswitch.conf</scm:parameter>
<scm:parameter id="FILENAME">/etc/profile</scm:parameter>
<scm:parameter id="FILENAME">/etc/profile.local</scm:parameter>
<scm:parameter id="FILENAME">/etc/security/pam_pwcheck.conf</scm:parameter>
<scm:parameter id="FILENAME">/etc/security/pam_pwcheck.conf</scm:parameter>
<scm:parameter id="FILENAME">/etc/security/pam_pwcheck.conf</scm:parameter>
<scm:parameter id="FILENAME">/etc/security/pam_unix2.conf</scm:parameter>
<scm:parameter id="FILENAME">/etc/syslog-ng/syslog-ng.conf</scm:parameter>
<scm:parameter id="FILENAME">/etc/vsftpd.ftpusers</scm:parameter>
<scm:parameter id="FILENAME">/etc/vsftpd/ftpusers</scm:parameter>
<scm:parameter id="FILENAME">/etc/default/passwd</scm:parameter>
<scm:parameter id="FILENAME">/etc/pam.d/common-password</scm:parameter>
<scm:parameter id="FILENAME">/etc/pam.d/system-auth</scm:parameter>
</scm:collector>
<scm:collector id="GroupsV2" scm:classname="unix.any.GroupsV2" scm:minimumVersion="4">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="PROCESS_LDAP_INFO"></scm:parameter>
<scm:parameter id="GROUPS"></scm:parameter>
<scm:parameter id="EXCLUDE"></scm:parameter>
</scm:collector>
<scm:collector id="SysctlV2" scm:classname="linux.any.SysctlV2" scm:minimumVersion="8">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="ATTRIBUTES">net.ipv4.tcp_syncookies</scm:parameter>
<scm:parameter id="ATTRIBUTES">net.ipv4.icmp_echo_ignore_broadcasts</scm:parameter>
<scm:parameter id="ATTRIBUTES">net.ipv4.conf.all.accept_redirects</scm:parameter>
</scm:collector>
<scm:collector id="ShadowV2" scm:classname="unix.multi.ShadowV2" scm:minimumVersion="10">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="CHECK_PWD_USERNAMES"></scm:parameter>
<scm:parameter id="PASSWD_BLACKLIST"></scm:parameter>
<scm:parameter id="PROCESS_LDAP_INFO"></scm:parameter>
<scm:parameter id="PASSWD_BLACKLIST_URL"></scm:parameter>
</scm:collector>
<scm:collector id="LoginDefsV1" scm:classname="linux.any.LoginDefsV1" scm:minimumVersion="4">
<scm:configFile usage="missing" type="name"></scm:configFile>
</scm:collector>
<scm:collector id="InitdV2" scm:classname="unix.any.wwep.InitdV2" scm:minimumVersion="14">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="INCL_REM_GATHERING"></scm:parameter>
</scm:collector>
<scm:collector id="OpenSSHV5" scm:classname="any.any.OpenSSHV5" scm:minimumVersion="5">
<scm:configFile usage="optional" type="name">openssh_config.txt</scm:configFile>
<scm:parameter id="CONFIG_FILE"></scm:parameter>
<scm:parameter id="PRECEDENCE_ORDER"></scm:parameter>
</scm:collector>
<scm:collector id="XInetdV2" scm:classname="unix.any.wwep.XInetdV2" scm:minimumVersion="11">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="INCL_REM_GATHERING"></scm:parameter>
</scm:collector>
<scm:collector id="CrontabV2" scm:classname="unix.any.wwep.CrontabV2" scm:minimumVersion="16">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="INCL_REM_GATHERING"></scm:parameter>
<scm:parameter id="CRON_USER_P"></scm:parameter>
<scm:parameter id="CRON_USER_FILE">root</scm:parameter>
</scm:collector>
<scm:collector id="AnonFtpPasswdV2" scm:classname="unix.any.AnonFtpPasswdV2" scm:minimumVersion="4">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="SCAN_REMOTE"></scm:parameter>
<scm:parameter id="ANONFTP_PASSWD_FILE"></scm:parameter>
</scm:collector>
<scm:collector id="ProcessesV1" scm:classname="unix.any.ProcessesV1" scm:minimumVersion="7">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="SOLARIS_ZONES"></scm:parameter>
<scm:parameter id="CMD_DATA_TRUNC_LEN">1024</scm:parameter>
</scm:collector>
<scm:collector id="PamV1" scm:classname="unix.any.PamV1" scm:minimumVersion="11">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="FILES"></scm:parameter>
<scm:parameter id="EXPAND_INCLUDE_CTRL"></scm:parameter>
</scm:collector>
<scm:collector id="RpcV1" scm:classname="unix.any.RpcV1" scm:minimumVersion="6">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="IPVARIABLE"></scm:parameter>
</scm:collector>
<scm:collector id="NetstatV1" scm:classname="unix.any.NetstatV1" scm:minimumVersion="4">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="RESOLVE_ADDRESSES"></scm:parameter>
<scm:parameter id="PROTOCOL"></scm:parameter>
<scm:parameter id="STATE"></scm:parameter>
</scm:collector>
<scm:collector id="PlatformInfoV2" scm:classname="unix.any.PlatformInfoV2" scm:minimumVersion="9">
<scm:configFile usage="missing" type="name"></scm:configFile>
</scm:collector>
<scm:collector id="LoginPromptV1" scm:classname="unix.any.LoginPromptV1" scm:minimumVersion="5">
<scm:configFile usage="missing" type="name"></scm:configFile>
</scm:collector>
<scm:collector id="FilePermsV2-osr-usr" scm:classname="unix.any.FilePermsV2" scm:minimumVersion="16">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="PERM"></scm:parameter>
<scm:parameter id="OWNER"></scm:parameter>
<scm:parameter id="GROUP"></scm:parameter>
<scm:parameter id="MAX_SCAN">250000</scm:parameter>
<scm:parameter id="MAX_RETURN">250000</scm:parameter>
<scm:parameter id="FILES">/usr</scm:parameter>
<scm:parameter id="FILES">/usr/*</scm:parameter>
<scm:parameter id="SCAN_REMOTE">0</scm:parameter>
<scm:parameter id="SCAN_LOCAL">1</scm:parameter>
<scm:parameter id="SCAN_LINKS">0</scm:parameter>
</scm:collector>
<scm:collector id="FilePermsV2-osr-etc" scm:classname="unix.any.FilePermsV2" scm:minimumVersion="16">
<scm:configFile usage="missing" type="name"></scm:configFile>
<scm:parameter id="PERM"></scm:parameter>
<scm:parameter id="OWNER"></scm:parameter>
<scm:parameter id="GROUP"></scm:parameter>
<scm:parameter id="MAX_SCAN">250000</scm:parameter>
<scm:parameter id="MAX_RETURN">250000</scm:parameter>
<scm:parameter id="SCAN_REMOTE">0</scm:parameter>
<scm:parameter id="SCAN_LOCAL">1</scm:parameter>
<scm:parameter id="SCAN_LINKS">0</scm:parameter>
<scm:parameter id="FILES">/etc</scm:parameter>
<scm:parameter id="FILES">/etc/*</scm:parameter>
</scm:collector>
<scm:collector id="ChronydV1" scm:classname="unix.any.ChronydV1" scm:minimumVersion="1">
<scm:configFile usage="missing" type="name"></scm:configFile>
</scm:collector>
<scm:collector id="NtpdV1" scm:classname="unix.any.NtpdV1" scm:minimumVersion="1">
<scm:configFile usage="missing" type="name"></scm:configFile>
</scm:collector>
<scm:collector id="SELinuxV1" scm:classname="linux.any.SELinuxV1" scm:minimumVersion="1">
<scm:configFile usage="missing" type="name"></scm:configFile>
</scm:collector>
<scm:collector id="AppArmorV1" scm:classname="linux.any.AppArmorV1" scm:minimumVersion="1">
<scm:configFile usage="missing" type="name"></scm:configFile>
</scm:collector>
<scm:collector id="GDPRV1" scm:classname="unix.any.GDPRV1" scm:minimumVersion="1">
<scm:configFile usage="missing" type="name"></scm:configFile>
</scm:collector>
</cdf:Group>
</cdf:Benchmark>
